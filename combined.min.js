try{!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return!0}}).x&&(Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:!1,configurable:!0,value:function(b,e){Object.defineProperty(this,b,{get:e,enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:!1,configurable:!0,value:function(b,e){Object.defineProperty(this,b,{set:e,enumerable:!0,configurable:!0})}}))}catch(defPropException){}var global={};
(function(){global="undefined"==typeof window?process:window;global.Appacitive||(global.Appacitive={runtime:{isNode:"undefined"!=typeof process,isBrowser:"undefined"!=typeof window}});var b=function(a){if(!a||!a.send||"function"!=typeof a.send)throw Error("No applicable httpTransport class found");a.onResponse=this.onResponse;var c=[],d={},e=0,f={},b=0;this.addProcessor=function(a){if(a){a.pre=a.pre||function(){};a.post=a.post||function(){};var c=a.pre;e+=1;d[e]=c;a=a.post;b+=1;f[b]=a}};this.enqueueRequest=
function(a){c.push(a)};this.notify=function(){if(0!==c.length){var e=[],b;for(b in f)f.hasOwnProperty(b)&&e.push(f[b]);for(;0<c.length;){var j=c.shift(),k=[];for(b in d)d.hasOwnProperty(b)&&k.push(d[b](j));a.send(j,e,k)}}};this.onResponse=function(a){console.dir(a)}},e=function(){var a=function(){throw Error("Not Implemented Exception");};this.inOnline=this.send=a;this.onResponse=function(){a()};this.onError=function(){a()}},f=null,f=global.Appacitive.runtime.isBrowser?XMLHttpRequest:require("xmlhttprequest").XMLHttpRequest,
d=function(a,c){if("undefined"!==typeof XDomainRequest)throw Error("Appacitive doesn't support versions of IE6, IE7, IE8, IE9 due to crossdomain calls");if(!a.url)throw Error("Please specify request url");a.method||(a.method="GET");a.headers||(a.headers=[]);var d={};if(c)d=a.data;else try{a.data&&(d=a.data),d=JSON.stringify(d)}catch(e){}if(!a.onSuccess||"function"!=typeof a.onSuccess)a.onSuccess=function(){};if(!a.onError||"function"!=typeof a.onError)a.onError=function(){};var b=new f;b.onreadystatechange=
function(){if(4==this.readyState)if(200<=this.status&&300>this.status||304==this.status){var c=this.responseText;try{var d=this.getResponseHeader("content-type")||this.getResponseHeader("Content-Type");if("application/json"==d.toLowerCase()||"application/javascript"==d.toLowerCase())d=c,global.Appacitive.runtime.isBrowser||"{"!=d[0]&&(d=d.substr(1,d.length-1)),c=JSON.parse(d)}catch(e){}a.onSuccess(c,this)}else a.onError({code:this.status,message:this.statusText},this)};b.open(a.method,a.url,!0);for(var k=
0;k<a.headers.length;k+=1)b.setRequestHeader(a.headers[k].key,a.headers[k].value);global.Appacitive.runtime.isBrowser||b.setRequestHeader("User-Agent","Appacitive-NodeJSSDK");b.send(d);return b},a=function(){var a=new e;a.isOnline=function(){return!0};var c=function(c,e,f,b){b||c.headers.push({key:"content-type",value:"application/json"});new d({method:c.method,url:c.url,headers:c.headers,data:c.data,onSuccess:function(d){try{d=JSON.parse(d)}catch(b){}var h=d;if(e.length!=f.length)throw Error("Callback length and state length mismatch!");
for(var k=0;k<e.length;k+=1)e[k].apply({},[h,f[k]]);a.onResponse(d,c)},onError:function(d){a.onError(c,d)}})};a.send=function(a,d,e){"function"==typeof a.beforeSend&&a.beforeSend(a);c(a,d,e)};a.upload=function(a,d,e){"function"==typeof a.beforeSend&&a.beforeSend(a);c(a,d,e,!0)};return a};global.Appacitive.http=new function(){var c=new a,d=new b(c),e=!1;this.pause=function(){e=!0};this.unpause=function(){e=!1};this.addProcessor=function(a){var c=Error('Must provide a processor object with either a "pre" function or a "post" function.');
if(!a)throw c;if(!a.pre&&!a.post)throw c;d.addProcessor(a)};this.send=function(a){d.enqueueRequest(a);c.isOnline()&&!1==e&&d.notify()};this.flush=function(a){a?d.notify():c.isOnline()&&d.notify()};this.onError=function(a,c){if(a.onError)if(a.context)a.onError.apply(a.context,[c]);else a.onError(c)};c.onError=this.onError;this.onResponse=function(a,c){if(c.onSuccess)if(c.context)c.onSuccess.apply(c.context,[a]);else c.onSuccess(a)};c.onResponse=this.onResponse};global.Appacitive.HttpRequest=function(a){a=
a||{};this.url=a.url||"";this.data=a.data||{};this.headers=a.headers||[];this.method=a.method||"GET";this.onSuccess=a.onSuccess||function(){};this.onError=a.onError||function(){};this.send=function(a){return new d(this,a)}};var c=global;c.Appacitive&&c.Appacitive.http&&(c.Appacitive.http.addProcessor({pre:function(a){return a},post:function(a,d){try{c.Appacitive.Session.isSessionValid(a)?a&&(a.status&&a.status.code&&"8036"==a.status.code||a.code&&"8036"==a.code)?c.Appacitive.Users.logout(function(){},
!0):c.Appacitive.Session.incrementExpiry():(null!=c.Appacitive.Session.get()&&c.Appacitive.Session.resetSession(),c.Appacitive.http.send(d))}catch(e){}}}),c.Appacitive.http.addProcessor({pre:function(){return(new Date).getTime()},post:function(a,c){var d=(new Date).getTime()-c;a._timeTakenInMilliseconds=d}}))})();
(function(b){String.format=function(e,f){if(1>=arguments.length)return e;for(var d=arguments.length-2,a=0;a<=d;a++)e=e.replace(RegExp("\\{"+a+"\\}","gi"),arguments[a+1]);return e};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(e){var f=RegExp("^"+e),d=this;f.test(d)&&(d=d.slice(1,d.length));f=RegExp(e+"$");f.test(d)&&(d=d.slice(0,-1));return d};String.toSearchString=function(e){"undefined"==typeof e&&(e="");for(var f=
"",d=0;d<e.length;d+=1)-1==" .,;#".indexOf(e[d])&&(f+=e[d]);return f=f.toLowerCase()};String.contains=function(e,f){return-1!=e.indexOf(f)};String.startsWith=function(e,f){return 0==e.indexOf(f)};Array.distinct=function(e){var f=[],d=e.length,a,c,b;for(c=0;c<d;c++){a=void 0;for(b=0;b<f.length;b++)if(e[c].toLowerCase()===f[b].toLowerCase()){a=!0;break}a||f.push(e[c])}return f};b.dateFromWcf=function(e,b){var d=/Date\(([^)]+)\)/.exec(e);if(2!=d.length){if(!b)return s;throw Error(s+" is not .net json date.");
}return new Date(parseFloat(d[1]))};b.Appacitive.storage=b.Appacitive.storage||{};b.Appacitive.storage.urlFactory=new function(){b.Appacitive.bag=b.Appacitive.bag||{};this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(){return String.format("{0}/create",this.userServiceUrl)},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getUserUrl:function(e){return String.format("{0}/{1}",
this.userServiceUrl,e)},getUpdateUrl:function(e){return String.format("{0}/{1}",this.userServiceUrl,e)},getDeleteUrl:function(e){return String.format("{0}/{1}",this.userServiceUrl,e)},getGetAllLinkedAccountsUrl:function(e){return String.format("{0}/{1}/linkedaccounts",this.userServiceUrl,e)},getValidateTokenUrl:function(e){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,e)},getInvalidateTokenUrl:function(e){return String.format("{0}/invalidate?userToken={1}",this.userServiceUrl,
e)},getSendResetPasswordEmailUrl:function(){return String.format("{0}/sendresetpasswordemail",this.userServiceUrl)},getUpdatePasswordUrl:function(e){return String.format("{0}/{1}/changepassword",this.userServiceUrl,e)}};this.device={deviceServiceUrl:"device",getCreateUrl:function(){return String.format("{0}/register",this.deviceServiceUrl)},getUpdateUrl:function(e){return String.format("{0}/{1}",this.deviceServiceUrl,e)},getDeleteUrl:function(e){return String.format("{0}/{1}",this.deviceServiceUrl,
e)}};this.article={articleServiceUrl:"article",getSearchAllUrl:function(e,b,d){var a="",a=String.format("{0}/search/{1}/all",this.articleServiceUrl,e),a=d?a+"?psize="+d:a+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(e=0;e<b.length;e+=1)0!=b[e].trim().length&&(a=a+"&"+b[e]);return a},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.articleServiceUrl)},getPropertiesSearchUrl:function(e,b){var d=String.format("{0}/search/{1}/all",this.articleServiceUrl,e);return d+
("?properties="+b)},getGetUrl:function(e,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,e,b)},getMultiGetUrl:function(e,b){return String.format("{0}/{1}/multiGet/{2}",this.articleServiceUrl,e,b)},getCreateUrl:function(e){return String.format("{0}/{1}",this.articleServiceUrl,e)},getUpdateUrl:function(e,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,e,b)},getDeleteUrl:function(e,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,e,b)},getMultiDeleteUrl:function(e){return String.format("{0}/{1}/bulkdelete",
this.articleServiceUrl,e)}};this.connection={connectionServiceUrl:"connection",getGetUrl:function(e,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,e,b)},getMultiGetUrl:function(b,f){return String.format("{0}/{1}/multiGet/{2}",this.connectionServiceUrl,b,f)},getCreateUrl:function(b){return String.format("{0}/{1}",this.connectionServiceUrl,b)},getUpdateUrl:function(b,f){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,b,f)},getDeleteUrl:function(b,f){return String.format("{0}/{1}/{2}",
this.connectionServiceUrl,b,f)},getMultiDeleteUrl:function(b){return String.format("{0}/{1}/bulkdelete",this.connectionServiceUrl,b)},getSearchByArticleUrl:function(b,f,d,a){var c="",c=String.format("{0}/{1}/find/all?label={2}&articleid={3}",this.connectionServiceUrl,b,d,f);if("undefined"!==typeof a&&0<a.length)for(b=0;b<a.length;b+=1)c=c+"&"+a[b];return c},getConnectedArticles:function(b,f,d){var a="",a=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,b,f);if(d&&d.length&&0<d.length)for(b=
0;b<d.length;b+=1)a=0==b?a+("?"+d[b]):a+("&"+d[b]);return a},getInterconnectsUrl:function(){var b="";return b=String.format("{0}/interconnects",this.connectionServiceUrl)},getPropertiesSearchUrl:function(b,f){var d=String.format("{0}/{1}/find/all",this.connectionServiceUrl,b);return d+("?properties="+f)}};this.cannedList={cannedListServiceUrl:"list",getGetListItemsUrl:function(b){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,b)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",
this.pushServiceUrl)},getGetNotificationUrl:function(b){return String.format("{0}/notification/{1}",this.pushServiceUrl,b)},getGetAllNotificationsUrl:function(b){return String.format("{0}/getAll?psize={1}&pnum={2}",this.pushServiceUrl,b.psize,b.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(b){return String.format("{0}/uploadurl?contenttype={1}&expires=20",this.fileServiceUrl,escape(b))},getUpdateUrl:function(b,f){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",
this.fileServiceUrl,b,escape(f))},getDownloadUrl:function(b,f){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,b,f)},getDeleteUrl:function(b){return String.format("{0}/delete/{1}",this.fileServiceUrl,b)}};this.query={params:function(b){var f=[];return""==location.search||-1==location.search.indexOf("?")?f:b?(b=b.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(d,a){var c=a.split("="),g=c[1];2<c.length&&c.forEach(function(a){0==a||1==a||(g=g+"="+c[a])});
c[0].toLowerCase()==b&&(f=[c[0],g])}),f):location.search.split("?")[1].split("=")}}}})(global);
(function(b){b.Appacitive.eventManager=new function(){var b={};this.subscribe=function(f,d){if("string"!=typeof f||"function"!=typeof d)throw Error("Incorrect subscription call");"undefined"==typeof b[f]&&(b[f]=[]);var a;a=function(){return Math.floor(65536*Math.random()).toString(16)};a=a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a();b[f].push({callback:d,id:a});return a};this.unsubscribe=function(f){if(!f)return!1;var d=-1,a=null,c;for(c in b)for(var g=0;g<b[c].length;g+=1)if(b[c][g].id==f){d=g;
a=c;break}return-1!=d?(b[a].splice(d,1),!0):!1};this.fire=function(f,d,a){if("string"!=typeof f)throw Error("Incorrect fire call");if("undefined"==typeof a||null===a)a={};a.eventName=f;if("undefined"!=typeof b.all)for(var c=0;c<b.all.length;c+=1)b.all[c].callback(d,a);c=function(a,c,b){setTimeout(function(){a(c,b)},0)};if("undefined"!=typeof b[f])for(var g=0;g<b[f].length;g+=1)c(b[f][g].callback,d,a)};this.clearSubscriptions=function(f){if("string"!=typeof f)throw Error("Event Name must be string in EventManager.clearSubscriptions");
b[f]&&(b[f].length=0);return this};this.clearAndSubscribe=function(b,d){this.clearSubscriptions(b);this.subscribe(b,d)};this.dump=function(){console.dir(b)}}})(global);(function(b){b.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/"}})(global);
(function(b){b.Appacitive.Session=new function(){var e=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},f=null,d=null,a=null,c=null,g=!1;this.useApiKey=!0;this.onSessionCreated=function(){};this.recreate=function(){b.Appacitive.Session.create(d)};this.create=function(c){d=c=c||{};var g=new e;c.apikey?(g.apikey=c.apikey||"",a=g.apikey):g.apikey=a;g.isnonsliding=c.isnonsliding||g.isnonsliding;g.usagecount=c.usagecount||g.usagecount;g.windowtime=c.windowtime||g.windowtime;
c=new b.Appacitive.HttpRequest;c.url=b.Appacitive.config.apiBaseUrl+"application.svc/session";c.method="put";c.data=g;c.onSuccess=function(a){a&&a.status&&"200"==a.status.code?(f=a.session.sessionkey,b.Appacitive.Session.useApiKey=!1,b.Appacitive.eventManager.fire("session.success",{},a),b.Appacitive.Session.onSessionCreated()):b.Appacitive.eventManager.fire("session.error",{},a)};b.Appacitive.http.send(c)};b.Appacitive.http.addProcessor({pre:function(d){b.Appacitive.Session.useApiKey?d.headers.push({key:"appacitive-apikey",
value:a}):d.headers.push({key:"appacitive-session",value:f});!0===g&&(1==d.headers.filter(function(a){return"appacitive-user-auth"==a.key}).length?d.headers.forEach(function(a){"appacitive-user-auth"==a.key&&(a.value=c)}):d.headers.push({key:"appacitive-user-auth",value:c}))}});this.setUserAuthHeader=function(a,d,f){try{a&&(g=!0,c=a,f||(d||(d=60),-1==d&&(d=null),b.Appacitive.runtime.isBrowser&&(b.Appacitive.Cookie.setCookie("Appacitive-UserToken",a,d),b.Appacitive.Cookie.setCookie("Appacitive-UserTokenExpiry",
d?d:-1,d))))}catch(e){}};this.incrementExpiry=function(){};this.removeUserAuthHeader=function(a,d){a&&("function"!=typeof a&&"boolean"==typeof a)&&(d=a,a=function(){});g=!1;a=a||function(){};b.Appacitive.localStorage.remove("Appacitive-User");b.Appacitive.runtime.isBrowser&&(b.Appacitive.Cookie.eraseCookie("Appacitive-UserToken"),b.Appacitive.Cookie.eraseCookie("Appacitive-UserTokenExpiry"));if(c&&!d)try{var f=new b.Appacitive.HttpRequest;f.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.user.getInvalidateTokenUrl(c);
c=null;f.method="POST";f.data={};f.onSuccess=function(){"function"==typeof a&&a()};b.Appacitive.http.send(f)}catch(e){}else c=null,"function"==typeof a&&a()};this.isSessionValid=function(a){if(!a)return!0;if(a.status){if(a.status.code&&("8027"==a.status.code||"8002"==a.status.code))return!1}else if(a.code&&("8027"==a.code||"8002"==a.code))return!1;return!0};this.resetSession=function(){f=null;this.useApiKey=!0};this.get=function(){return f};this.setSession=function(a){a&&(f=a,this.useApiKey=!1)};
this.setApiKey=function(c){c&&(a=c,this.useApiKey=!0)};var h="sandbox";this.__defineGetter__("environment",function(){return h});this.__defineSetter__("environment",function(a){"sandbox"!=a&&"live"!=a&&(a="sandbox");h=a})};b.Appacitive.initialize=function(e){b.Appacitive.Session.setApiKey(e.apikey||"");b.Appacitive.Session.environment=e.env||"";b.Appacitive.useApiKey=!0;if(e.userToken)-1==e.expiry?e.expiry=null:e.expiry||(e.expiry=3600),b.Appacitive.Session.setUserAuthHeader(e.userToken,e.expiry),
e.user&&(b.Appacitive.localStorage.set("Appacitive-User",e.user),b.Appacitive.Users.setCurrentUser(e.user));else if(b.Appacitive.runtime.isBrowser&&(e=b.Appacitive.Cookie.readCookie("Appacitive-UserToken"))){var f=b.Appacitive.Cookie.readCookie("Appacitive-UserTokenExpiry");f||(f=60);var d=b.Appacitive.localStorage.get("Appacitive-User");b.Appacitive.Users.setCurrentUser(d,e,f)}}})(global);
(function(b){b.Appacitive&&b.Appacitive.http&&b.Appacitive.http.addProcessor({pre:function(e){e.headers.push({key:"appacitive-environment",value:b.Appacitive.Session.environment})}})})(global);
(function(b){b.Appacitive.Queries={};var e=function(a){a=a||{};var c=1,b=200;this.__defineGetter__("pageNumber",function(){return c});this.__defineSetter__("pageNumber",function(a){c=a||1});this.__defineGetter__("pageSize",function(){return b});this.__defineSetter__("pageSize",function(a){b=a||200});this.pageNumber=a.pageNumber;this.pageSize=a.pageSize};e.prototype.toString=function(){return"psize="+this.pageSize+"&pnum="+this.pageNumber};var f=function(a){a=a||{};var c="__UtcLastUpdatedDate",b=!1;
this.__defineGetter__("orderBy",function(){return c});this.__defineSetter__("orderBy",function(a){c=a||"__UtcLastUpdatedDate"});this.__defineGetter__("isAscending",function(){return b});this.__defineSetter__("isAscending",function(a){b="undefined"==typeof a?!1:a});this.orderBy=a.orderBy;this.isAscending=a.isAscending};f.prototype.toString=function(){return"orderBy="+this.orderBy+"&isAsc="+this.isAscending};var d=function(a){var c=a||{},d="",h="",l="",j=a.queryType,m=new e(a),k=new f(a),n=a.schema||
a.relation,p=a.schema?"article":"connection";this.__defineGetter__("type",function(){return p});this.__defineGetter__("entityType",function(){return n});this.__defineGetter__("queryType",function(){return j});this.__defineGetter__("pageQuery",function(){return m});this.__defineGetter__("sortQuery",function(){return k});this.__defineGetter__("filter",function(){return d});this.__defineSetter__("filter",function(a){d=a});this.__defineGetter__("freeText",function(){return h});this.__defineSetter__("freeText",
function(a){"string"==typeof a?h=a:"object"==typeof a&&a.length&&(h=a.join(" "))});this.__defineGetter__("fields",function(){return l});this.__defineSetter__("fields",function(a){"string"==typeof a?l=a:"object"==typeof a&&a.length&&(l=a.join(","))});this.filter=c.filter||"";this.freeText=c.freeText||"";this.fields=c.fields||"";this.setFilter=function(a){this.filter=a};this.setFreeText=function(a){this.freeText=a};this.setFields=function(a){this.fields=a};this.extendOptions=function(a){for(var b in a)c[b]=
a[b];m=new e(c);k=new f(c)};this.getQueryString=function(){var a=this.pageQuery.toString()+"&"+this.sortQuery.toString();this.filter&&0<this.filter.trim().length&&(a+="&query="+this.filter);this.freeText&&0<this.freeText.trim().length&&(a+="&freetext="+this.freeText+"&language=en");this.fields&&0<this.fields.trim().length&&(a+="&fields="+this.fields);return a};this.toUrl=function(){return b.Appacitive.config.apiBaseUrl+n+"/find/all?"+this.getQueryString()};this.toRequest=function(){var a=new b.Appacitive.HttpRequest;
a.url=this.toUrl();a.method="get";return a};this.getOptions=function(){var a={},c;for(c in this)this.hasOwnProperty(c)&&"function"!=typeof this[c]&&(a[c]=this[c]);return a};this.fetch=function(a,c){var d=this.toRequest();d.onSuccess=function(d){if(d&&d.status&&"200"==d.status.code){if("function"==typeof a){var f=d[p+"s"],g=[];f||(f=[]);var e="article"==p?"Article":"Connection";f.forEach(function(a){g.push(new b.Appacitive[e](a))});a(g,d.paginginfo)}}else d=d||{},"function"==typeof c&&c(d.status||
{message:"Server error",code:400})};d.onError=function(a){a=a||{};"function"==typeof c&&c(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(d)}};b.Appacitive.Queries.BasicFilterQuery=function(a){a=a||{};if(!a.schema&&!a.relation||a.schema&&a.relation)throw Error("Specify either schema or relation for basic filter query");a.queryType="BasicFilterQuery";a=new d(a);a.toRequest=function(){var a=new b.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};a.toUrl=function(){return b.Appacitive.config.apiBaseUrl+
this.type+".svc/"+this.entityType+"/find/all?"+this.getQueryString()};return a};b.Appacitive.Queries.ConnectedArticlesQuery=function(a){a=a||{};if(!a.relation)throw Error("Specify relation for connected articles query");if(!a.articleId)throw Error("Specify articleId for connected articles query");a.schema&&delete a.schema;a.queryType="ConnectedArticlesQuery";var c=new d(a);c.articleId=a.articleId;c.relation=a.relation;c.label="";a.label&&("string"==typeof a.label&&0<a.label.length)&&(c.label="&label="+
a.label);c.toRequest=function(){var a=new b.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};c.toUrl=function(){return b.Appacitive.config.apiBaseUrl+"connection/"+this.relation+"/"+this.articleId+"/find?"+this.getQueryString()+this.label};return c};b.Appacitive.Queries.GetConnectionsQuery=function(a){a=a||{};if(!a.relation)throw Error("Specify relation for GetConnectionsQuery query");if(!a.articleId)throw Error("Specify articleId for GetConnectionsQuery query");if(!a.label||0==
a.label.trim().length)throw Error("Specify label for GetConnectionsQuery query");a.schema&&delete a.schema;a.queryType="GetConnectionsQuery";var c=new d(a);c.articleId=a.articleId;c.relation=a.relation;c.label=a.label;c.toRequest=function(){var a=new b.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};c.toUrl=function(){return b.Appacitive.config.apiBaseUrl+"connection/"+c.relation+"/find/all?articleid="+this.articleId+"&label="+this.label+c.getQueryString()};return c};b.Appacitive.Queries.GetConnectionsBetweenArticlesQuery=
function(a,c){a=a||{};if(!a.articleAId||"string"!=typeof a.articleAId||0==a.articleAId.length)throw Error("Specify valid articleAId for GetConnectionsBetweenArticlesQuery query");if(!a.articleBId||"string"!=typeof a.articleBId||0==a.articleBId.length)throw Error("Specify articleBId for GetConnectionsBetweenArticlesQuery query");a.schema&&delete a.schema;a.queryType=c||"GetConnectionsBetweenArticlesQuery";var f=new d(a);f.articleAId=a.articleAId;f.articleBId=a.articleBId;f.label="GetConnectionsBetweenArticlesForRelationQuery"==
f.queryType&&a.label&&"string"==typeof a.label&&0<a.label.length?"&label="+a.label:"";f.relation=a.relation&&"string"==typeof a.relation&&0<a.relation.length?a.relation+"/":"";f.toRequest=function(){var a=new b.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};f.toUrl=function(){return b.Appacitive.config.apiBaseUrl+"connection/"+this.relation+"find/"+this.articleAId+"/"+this.articleBId+"?"+this.getQueryString()+this.label};return f};b.Appacitive.Queries.GetConnectionsBetweenArticlesForRelationQuery=
function(a){a=a||{};if(!a.relation)throw Error("Specify relation for GetConnectionsBetweenArticlesForRelationQuery query");a=new b.Appacitive.Queries.GetConnectionsBetweenArticlesQuery(a,"GetConnectionsBetweenArticlesForRelationQuery");a.fetch=function(a,d){this.toUrl();var f=this.toRequest();f.onSuccess=function(b){b&&b.status&&"200"==b.status.code?"function"==typeof a&&a(new Appacitive.Connection(b.connection)):(b=b||{},"function"==typeof d&&d(b.status||{message:"Server error",code:400}))};f.onError=
function(a){a=a||{};"function"==typeof d&&d(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(f)};return a};b.Appacitive.Queries.InterconnectsQuery=function(a){a=a||{};if(!a.articleAId||"string"!=typeof a.articleAId||0==a.articleAId.length)throw Error("Specify valid articleAId for InterconnectsQuery query");if(!a.articleBIds||"object"!=typeof a.articleBIds||!(0<a.articleBIds.length))throw Error("Specify list of articleBIds for InterconnectsQuery query");a.schema&&delete a.schema;
a.queryType="InterconnectsQuery";var c=new d(a);c.articleAId=a.articleAId;c.articleBIds=a.articleBIds;c.toRequest=function(){var a=new b.Appacitive.HttpRequest;a.url=this.toUrl();a.method="post";a.data={article1id:this.articleAId,article2ids:this.articleBIds};return a};c.toUrl=function(){return b.Appacitive.config.apiBaseUrl+"connection/interconnects?"+this.getQueryString()};return c};b.Appacitive.Queries.GraphQuery=function(a){a=a||{};if(!a.graphQuery)throw Error("graphQuery object is mandatory");
this.toRequest=function(){var c=new b.Appacitive.HttpRequest;c.url=b.Appacitive.config.apiBaseUrl;c.url+=b.Appacitive.storage.urlFactory.article.getProjectionQueryUrl();c.method="post";c.data=a.graphQuery;return c}}})(global);
(function(b){b.Appacitive.BaseObject=function(e,f){var d={},a=e=e||{};if(f)for(var c in a)if("string"==typeof a[c]||"number"==typeof a[c])d[c]=a[c];else if("object"==typeof a[c]){d[c]=0<=a[c].length?[]:{};for(var g in a[c])d[c][g]=a[c][g]}else d[c]=obj[c];!d.__id&&e.__id&&(d.__id=e.__id);e.__schematype?(e.__schematype=e.__schematype.toLowerCase(),this.entityType=e.__schematype,this.type="user"==e.__schematype||"device"==e.__schematype?e.__schematype:"article"):e.__relationtype&&(e.__relationtype=
e.__relationtype.toLowerCase(),this.entityType=e.__relationtype,this.type="connection");var h=function(a){a=a||{};a.message=a.message||"Server error";a.code=a.code||"500"},l=function(c){for(var b in c)if("string"==typeof c[b])a[b]=c[b];else if("object"==typeof c[b]){a[b]=0<=c[b].length?[]:{};for(var d in c[b])a[b][d]=c[b][d]}else a[b]=c[b]};this.getObject=function(){return a};this.toJSON=function(){return a};this.attributes=function(){if(0===arguments.length)return a.__attributes||(a.__attributes=
{}),a.__attributes;if(1==arguments.length)return a.__attributes||(a.__attributes={}),a.__attributes[arguments[0]];if(2==arguments.length){if("string"!==typeof arguments[1])throw Error("only string values can be stored in attributes.");a.__attributes||(a.__attributes={});a.__attributes[arguments[0]]=arguments[1]}else throw Error(".attributes() called with an incorrect number of arguments. 0, 1, 2 are supported.");};this.aggregates=function(){var c={},b;for(b in a){if(!a.hasOwnProperty(b))return;"$"==
b[0]&&(c[b]=a[b])}if(0===arguments.length)return c;if(1==arguments.length)return c[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");};var j=[];a.__tags||(a.__tags=[]);this.__defineGetter__("tags",function(){return!a.__tags?[]:a.__tags});this.addTags=function(c){c&&("string"==typeof c&&c.length)&&(a.__tags.push(c),a.__tags=Array.distinct(a.__tags),j&&j.length&&(c=j.indexOf(c),-1!=c&&j.splice(c,1)))};this.removeTags=function(c){c&&("string"==
typeof c&&c.length)&&(j.push(c),j=Array.distinct(j),a.__tags&&a.__tags.length&&(c=a.__tags.indexOf(c),-1!=c&&a.__tags.splice(c,1)))};this.get=function(c){if(c)return a[c]};this.set=function(c,b){if(!c||"string"!=typeof c||0==c.length)return b;null==b||"undefined"==b?a[c]=null:"string"==typeof b?a[c]=b:"number"==typeof b?a[c]=b+"":"object"==typeof b&&0<=b.length&&(a[c]=b);return b};this.copy=function(a){a&&l(a)};this.save=function(c,b){a.__id?k.apply(this,arguments):m.apply(this,arguments)};var m=
function(c,f){c=c||function(){};f=f||function(){};var e=this,g=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory[this.type].getCreateUrl(a.__schematype||a.__relationtype);if(a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))g=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getCreateUrl();var j=new b.Appacitive.HttpRequest;j.url=g;j.method="put";a.__revision&&delete a.__revision;j.data=a;j.onSuccess=
function(b){var g=null;if(b&&(b.article||b.connection||b.user||b.device))g=b.article||b.connection||b.user||b.device;b&&g?(d=g,a.__id=g.__id,l(g),e.connectionCollections&&0<e.connectionCollections.length&&e.connectionCollections.forEach(function(c){c.getQuery().extendOptions({articleId:a.__id})}),"connection"==e.type&&e.parseConnection(),Appacitive.eventManager.fire((e.__schematype||e.__relationtype)+"."+e.type+".created","base",{object:e}),"function"==typeof c&&c(e)):(b=b||{},b.status=b.status||
{},b.status=h(b.status),Appacitive.eventManager.fire((e.__schematype||e.__relationtype)+"."+e.type+".createFailed","base",{error:b.status}),"function"==typeof f&&f(b.status,e))};j.onError=function(a){a=h(a);"function"==typeof f&&f(a,e)};b.Appacitive.http.send(j)},k=function(c,f){c=c||function(){};f=f||function(){};var e=!1,g=JSON.parse(JSON.stringify(d)),m;for(m in a)"undefined"==typeof a[m]||null===a[m]?(g[m]=null,e=!0):a[m]!=d[m]?(g[m]=a[m],e=!0):a[m]==d[m]&&delete g[m];try{g.__revision&&delete g.__revision,
g.__endpointa&&delete g.__endpointa,g.__endpointb&&delete g.__endpointb,g.__createdby&&delete g.__createdby,g.__lastmodifiedby&&delete g.__lastmodifiedby,g.__schematype&&delete g.__schematype,g.__relationtype&&delete g.__relationtype,g.__utcdatecreated&&delete g.__utcdatecreated,g.__utclastupdateddate&&delete g.__utclastupdateddate,g.__tags&&delete g.__tags}catch(k){}a.__tags&&0<a.__tags.length&&(g.__addtags=a.__tags);j&&0<j.length&&(g.__removetags=j);var q=this;if(e){e=new b.Appacitive.HttpRequest;
m=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory[this.type].getUpdateUrl(a.__schematype||a.__relationtype,d.__id?d.__id:a.__id);if(a&&a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))m=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getUpdateUrl(d.__id);e.url=m;e.method="post";e.data=g;e.onSuccess=function(b){b&&(b.article||b.connection||b.user||b.device)?(d=b.article||b.connection||b.user||
b.device,l(d),Appacitive.eventManager.fire(q.type+"."+a.__id+".updated","base",{object:q}),"function"==typeof c&&c(q)):(b=b||{},b.status=b.status||{},b.status=h(b.status),Appacitive.eventManager.fire(q.type+"."+a.__id+".updateFailed","base",{object:b.status}),"function"==typeof f&&f(b.status,q))};e.onError=function(a){a=a||{};a.message=a.message||"Server error";a.code=a.code||"500";"function"==typeof f&&f(a,q)};b.Appacitive.http.send(e)}else"function"==typeof c&&c(q)};this.fetch=function(c,f){c=c||
function(){};f=f||function(){};if(a.__id){var g=this,e=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory[this.type].getGetUrl(a.__schematype||a.__relationtype,a.__id),j=new b.Appacitive.HttpRequest;j.url=e;j.method="get";j.onSuccess=function(a){a&&(a.article||a.connection||a.user||a.device)?(d=a.article||a.connection||a.user||a.device,l(d),g.___collection&&"article"==g.___collection.collectionType&&g.___collection.addToCollection(g),"function"==typeof c&&c(g)):(a=a||{},a.status=a.status||
{},a.status=h(a),"function"==typeof f&&f(a.status,g))};j.onError=function(a){a=h(a);"function"==typeof f&&f(a,g)};b.Appacitive.http.send(j)}else"function"==typeof f&&f({code:"400",message:"Please specify id for get operation"},this)};this.del=function(c,d,f){if(!a.__id&&this.___collection)this.___collection.removeByCId(this.__cid),"function"==typeof c&&c(this);else{c=c||function(){};d=d||function(){};f=f||{};var g=this,e=b.Appacitive.config.apiBaseUrl,e=e+b.Appacitive.storage.urlFactory[this.type].getDeleteUrl(a.__schematype||
a.__relationtype,a.__id);if(a&&a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))e=b.Appacitive.config.apiBaseUrl,e+=b.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getDeleteUrl(a.__id);f.deleteConnections&&!0===f.deleteConnections&&(e=-1==e.indexOf("?")?e+"?deleteconnections=true":e+"&deleteconnections=true");f=new b.Appacitive.HttpRequest;f.url=e;f.method="delete";f.onSuccess=function(b){"200"==b.code?(g.___collection&&g.___collection.removeById(a.__id),
"function"==typeof c&&c(b)):(b=h(b),"function"==typeof d&&d(b,g))};f.onError=function(a){a=h(a);"function"==typeof d&&d(a,g)};b.Appacitive.http.send(f)}}};b.Appacitive.BaseObject.prototype.toString=function(){return JSON.stringify(this.getObject())}})(global);
(function(b){var e=function(){return Math.floor(65536*Math.random()).toString(16)};b.Appacitive.GUID=function(){var b=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e(),d="",a,c,g,h,l,j,m=0,b=b.replace(/\r\n/g,"\n");c="";for(g=0;g<b.length;g++)h=b.charCodeAt(g),128>h?c+=String.fromCharCode(h):(127<h&&2048>h?c+=String.fromCharCode(h>>6|192):(c+=String.fromCharCode(h>>12|224),c+=String.fromCharCode(h>>6&63|128)),c+=String.fromCharCode(h&63|128));for(b=c;m<b.length;)a=b.charCodeAt(m++),c=b.charCodeAt(m++),
g=b.charCodeAt(m++),h=a>>2,a=(a&3)<<4|c>>4,l=(c&15)<<2|g>>6,j=g&63,isNaN(c)?l=j=64:isNaN(g)&&(j=64),d=d+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(j);return d.toString()}})(global);
(function(b){b.Appacitive.ArticleCollection=function(e){var f=null,d=null,a=[],c=e;this.collectionType="article";if(!e||!e.schema)throw Error("Must provide schema while initializing ArticleCollection.");var f=e.schema,g=this,h=function(a){a.type="article";a.schema?f=a.schema:a.schema=f;d=new b.Appacitive.Queries.BasicFilterQuery(a);c=a;g.extendOptions=d.extendOptions};this.setFilter=function(a){c.filter=a;c.type="article";d?d.filter=a:(d=new b.Appacitive.Queries.BasicFilterQuery(c),g.extendOptions=
d.extendOptions)};this.setFreeText=function(a){!a&&0==a.trim().length&&(c.freeText="");c.freeText=a;c.type="article";d?d.freeText=a:(d=new b.Appacitive.Queries.BasicFilterQuery(c),g.extendOptions=d.extendOptions)};this.setFields=function(a){a||(c.fields="");c.fields=a;c.type="article";d?d.fields=a:(d=new b.Appacitive.Queries.BasicFilterQuery(c),g.extendOptions=d.extendOptions)};this.reset=function(){f=c=null;a.length=0;d=null};this.__defineGetter__("query",function(){return d});this.getQuery=function(){return d};
var l=["BasicFilterQuery"];this.__defineSetter__("query",function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to articleCollection");if(-1==l.indexOf(c.queryType))throw Error("ArticleCollection only accepts "+l.join(", "));a.length=0;d=c});this.setQuery=function(a){this.query=a};this.setOptions=h;h(e);this.get=function(c){if(c!=parseInt(c,10))return null;c=parseInt(c,10);return"number"!=typeof c||c>=a.length?null:a.slice(c,c+1)[0]};this.addToCollection=function(c){if(!c||
c.get("__schematype")!=f)throw Error("Null article passed or schema type mismatch");var b=null;a.forEach(function(a,d){a.get("__id")==c.get("__id")&&(b=d)});0!=b?a.splice(b,1):a.push(c)};this.getArticleById=function(c,b,d){b=b||function(){};d=d||function(){};var f=a.filter(function(a){return a.get("__id")==c});1==f.length?b(Array.prototype.slice.call(f)[0]):d()};this.getAll=function(){return Array.prototype.slice.call(a)};this.getAllArticles=function(){return Array.prototype.slice.call(a).map(function(a){return a.getArticle()})};
this.removeById=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.getArticle().__id&&a.getArticle().__id==c&&(b=d)});return null!==b?(a.splice(b,1),!0):!1};this.removeByCId=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.__cid&&a.__cid==c&&(b=d)});return null!==b?(a.splice(b,1),!0):!1};this.fetch=function(c,f){c=c||function(){};f=f||function(){};a.length=0;var e=d.toRequest();e.onSuccess=function(d){var e=c,h=d.articles;if(h){if(!h.length||0===h.length)h=[];h.forEach(function(c){c=
new b.Appacitive.Article(c,!0);c.___collection=g;a.push(c)});e(d.paginginfo||{})}else f(d.status)};b.Appacitive.http.send(e)};this.fetchByPageNumber=function(a,c,b){d.getOptions().pageQuery.pageNumber=b;this.fetch(a,c)};this.fetchNextPage=function(a,c){d.getOptions().pageQuery.pageNumber+=1;this.fetch(a,c)};this.fetchPreviousPage=function(a,c){var b=d.getOptions().pageQuery;b.pageNumber-=1;0===b.pageNumber&&(b.pageNumber=1);this.fetch(a,c)};this.createNewArticle=function(c){c=c||{};c.__schematype=
f;c=new b.Appacitive.Article(c);c.___collection=g;c.__cid=parseInt(1E6*Math.random(),10);a.push(c);return c};this.map=function(){return a.map.apply(this,arguments)};this.forEach=function(){return a.forEach.apply(this,arguments)};this.filter=function(){return a.filter.apply(this,arguments)}};b.Appacitive.ArticleCollection.prototype.toString=function(){return JSON.stringify(this.getAllArticles())};b.Appacitive.ArticleCollection.prototype.toJSON=function(){return this.getAllArticles()};b.Appacitive.ArticleCollection.prototype.__defineGetter__("articles",
function(){return this.getAll()})})(global);
(function(b){b.Appacitive.ConnectionCollection=function(e){var f=null,d=null,a=[],c=[],g=e;this.collectionType="connection";if(!e||!e.relation)throw Error("Must provide relation while initializing ConnectionCollection.");var f=e.relation,h=function(a){a.type="connection";a.relation?f=a.relation:a.relation=f;d=new b.Appacitive.Queries.BasicFilterQuery(a);g=a};this.setFilter=function(a){g.filter=a;g.type="connection";d?d.filter=a:(d=new b.Appacitive.Queries.BasicFilterQuery(g),j.extendOptions=d.extendOptions)};
this.setFreeText=function(a){!a&&0==a.trim().length&&(g.freeText="");g.freeText=a;g.type="connection";d?d.freeText=a:(d=new b.Appacitive.Queries.BasicFilterQuery(g),j.extendOptions=d.extendOptions)};this.setFields=function(a){a||(g.fields="");g.fields=a;g.type="connection";d?d.fields=a:(d=new b.Appacitive.Queries.BasicFilterQuery(g),j.extendOptions=d.extendOptions)};this.__defineGetter__("query",function(){return d});this.getQuery=function(){return d};var l=["BasicFilterQuery","ConnectedArticlesQuery",
"GetConnectionsQuery","GetConnectionsBetweenArticlesForRelationQuery"];this.__defineSetter__("query",function(b){if(!b||!b.toRequest)throw Error("Invalid  appacitive query passed to connectionCollection");if(-1==l.indexOf(b.queryType))throw Error("ConnectionCollection only accepts "+l.join(", "));c.length=0;a.length=0;d=b});this.setQuery=function(a){this.query=a};this.reset=function(){f=g=null;c.length=0;a.length=0;d=null};this.setOptions=h;h(e);this.get=function(c){if(c!=parseInt(c,10))return null;
c=parseInt(c,10);return"number"!=typeof c||c>=a.length?null:a.slice(c,c+1)[0]};this.addToCollection=function(c){if(!c||c.get("__relationtype")!=f)throw Error("Null connection passed or relation type mismatch");var b=null;a.forEach(function(a,d){a.get("__id")==c.get("__id")&&(b=d)});null!==b?a.splice(b,1):a.push(c)};this.getConnection=function(c,b,d){b=b||function(){};d=d||function(){};var f=a.filter(function(a){return a.get("__id")==c});1==f.length?b(Array.prototype.slice.call(f)[0]):d()};this.getAll=
function(){return Array.prototype.slice.call(a)};this.getAllConnections=function(){return Array.prototype.slice.call(a).map(function(a){return a.getConnection()})};this.removeById=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.getConnection().__id&&a.getConnection().__id==c&&(b=d)});return null!==b?(a.splice(b,1),!0):!1};this.removeByCId=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.__cid&&a.__cid==c&&(b=d)});return null!==b?(a.splice(b,1),!0):!1};var j=this;this.getConnectedArticle=
function(a){if(!c||0===c.length)return null;var b=c.filter(function(c){return c.get("__id")==a});return 0<b.length?b[0]:null};this.fetch=function(f,g){f=f||function(){};g=g||function(){};a.length=0;var e=d.toRequest();e.onSuccess=function(e){a:{var h=f;e=e||{};var l=e.connections;"GetConnectionsBetweenArticlesForRelationQuery"==d.queryType&&e.connection&&(l=[e.connection]);if(!l)if(e.status&&e.status.code&&"200"==e.status.code)l=[];else{g(e.status);break a}if(!l.length||0===l.length)l=[];l.forEach(function(d){d=
new b.Appacitive.Connection(d,!0);d.___collection=j;if(d.endpointA.article||d.endpointB.article){var f=d.endpointA.article||d.endpointB.article;f.___collection=j;c.push(f)}try{d.___collection.connectedArticle||delete d.connectedArticle}catch(e){}a.push(d)});h(e.paginginfo||{})}};b.Appacitive.http.send(e)};this.fetchByPageNumber=function(a,c,b){d.getOptions().pageQuery.pageNumber=b;this.fetch(a,c)};this.fetchNextPage=function(a,c){d.getOptions().pageQuery.pageNumber+=1;this.fetch(a,c)};this.fetchPreviousPage=
function(a,c){var b=d.getOptions().pageQuery;b.pageNumber-=1;0===b.pageNumber&&(b.pageNumber=1);this.fetch(a,c)};this.createNewConnection=function(c){c=c||{};c.__relationtype=f;c=new b.Appacitive.Connection(c);c.___collection=j;c.__cid=parseInt(1E6*Math.random(),10);a.push(c);return c};this.map=function(){return a.map.apply(this,arguments)};this.forEach=function(c,b){return a.forEach(c,b||this)};this.filter=function(){return a.filter.apply(this,arguments)}}})(global);
(function(b){var e=function(f,d){f=f||function(){};d=d||function(){};var a=new b.Appacitive.HttpRequest;a.method="get";a.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getGetAllLinkedAccountsUrl(this.get("__id"));a.onSuccess=function(a){var b=null;a&&(a.identities&&0<a.identities.length)&&(a=a.identities.filter(function(a){return"facebook"==a.authtype.toLowerCase()}),1==a.length&&(b=a[0].username));null!==b?FB.api("/"+b,function(a){a?f(a):d()}):d()};a.onError=function(){d()};
b.Appacitive.http.send(a)};b.Appacitive.Article=function(f,d){if(!f.__schematype&&!f.schema)throw new error("Cannot set article without __schematype");f.schema&&(f.__schematype=f.schema,delete f.schema);var a=new b.Appacitive.BaseObject(f,d);a.type="article";a.connectionCollections=[];a.getArticle=a.getObject;a.get("__schematype")&&"user"==a.get("__schematype").toLowerCase()&&(a.getFacebookProfile=e);a.getConnectedArticles=function(a){if("article"!=this.type)return null;a=a||{};a.articleId=this.get("__id");
var d=new b.Appacitive.ConnectionCollection({relation:a.relation});d.connectedArticle=this;this.connectionCollections.push(d);d.query=new b.Appacitive.Queries.ConnectedArticlesQuery(a);return d};a.getConnections=function(a){if("article"!=this.type)return null;a=a||{};a.articleId=this.get("__id");var d=new b.Appacitive.ConnectionCollection({relation:a.relation});this.connectionCollections.push(d);d.query=new b.Appacitive.Queries.GetConnectionsQuery(a);return d};return a};b.Appacitive.Article.multiDelete=
function(f,d,a,c){if(!f)throw Error("Specify schemaName");if("user"==f.toLowerCase()||"device"==f.toLowerCase())throw Error("Cannot delete user and devices using multidelete");if(0<d.length){a=a||function(){};c=c||function(){};var e=new b.Appacitive.HttpRequest;e.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.article.getMultiDeleteUrl(f);e.method="post";e.data={idlist:d};e.onSuccess=function(b){b&&"200"==b.code?"function"==typeof a&&a():(b=b||{},"function"==typeof c&&c(b.status||
{message:"Server error",code:400}))};e.onError=function(a){a=a||{};"function"==typeof c&&c(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(e)}else a()};b.Appacitive.Article.multiGet=function(f,d,a,c){if(!f)throw Error("Specify schemaName");if("user"==f.toLowerCase()||"device"==f.toLowerCase())throw Error("Cannot multiget user and devices using multidelete");if("object"==typeof d&&0<d.length){var e=new b.Appacitive.HttpRequest;e.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.article.getMultiGetUrl(f,
d.join(","));e.method="get";e.onSuccess=function(d){if(d&&d.articles){if("function"==typeof a){var f=[];d.articles.forEach(function(a){f.push(new b.Appacitive.Article(a))});a(f,d.paginginfo)}}else d=d||{},"function"==typeof c&&c(d.status||{message:"Server error",code:400})};e.onError=function(a){a=a||{};"function"==typeof c&&c(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(e)}else a([])}})(global);
(function(b){var e=function(a,c,b){var d={label:a.label};a.articleid&&(d.articleid=a.articleid);if(a.article)"function"==typeof a.article.getArticle?a.article.get("__id")?d.articleid=a.article.get("__id"):d.article=a.article.getArticle():"object"==typeof a.article&&a.article.__schematype&&(a.article.__id?d.articleid=a.article.__id:d.article=a.article,a.article=new Appacitive.Article(a.article));else if(!d.articleid&&!d.article)throw Error("Incorrectly configured endpoints provided to setupConnection");
b["endpoint"+c]=a;return d},f=function(a,c,d){d.get("__endpoint"+c.toLowerCase()).article&&"object"==typeof d.get("__endpoint"+c.toLowerCase()).article?(d["endpoint"+c]?d["endpoint"+c]&&d["endpoint"+c].article&&d["endpoint"+c].article.getArticle?d["endpoint"+c].article.copy(d.get("__endpointb").article):d["endpoint"+c].article=new b.Appacitive.Article(d.get("__endpoint"+c.toLowerCase()).article):(d["endpoint"+c]={},d["endpoint"+c].article=new b.Appacitive.Article(d.get("__endpoint"+c.toLowerCase()).article)),
d["endpoint"+c].articleid=d.get("__endpoint"+c.toLowerCase()).articleid,d["endpoint"+c].label=d.get("__endpoint"+c.toLowerCase()).label,d["endpoint"+c].type=d.get("__endpoint"+c.toLowerCase()).type,d["endpoint"+c].article.___collection=d.___collection,delete d.get("__endpoint"+c.toLowerCase()).article):d["endpoint"+c]=d.get("__endpoint"+c.toLowerCase())};b.Appacitive.Connection=function(a,c){if(!a.__relationtype&&!a.relation)throw new error("Cannot set connection without relation");a.relation&&(a.__relationtype=
a.relation,delete a.relation);a.endpoints&&2==a.endpoints.length&&(a.__endpointa=a.endpoints[0],a.__endpointb=a.endpoints[1],delete a.endpoints);var d=new b.Appacitive.BaseObject(a);d.type="connection";d.getConnection=d.getObject;d.setupConnection=function(a,c){if(!a||!a.articleid&&!a.article||!a.label||!c||!c.articleid&&!c.article||!c.label)throw Error("Incorrect endpoints configuration passed.");d.set("__endpointa",e(a,"A",d));d.set("__endpointb",e(c,"B",d))};d.parseConnection=function(){var c=
"A",b="B";a.__endpointa.label==this.get("__endpointb").label&&a.__endpointa.articleid==this.get("__endpointb").articleid&&(c="B",b="A");f(this.get("__endpointa"),c,d);f(this.get("__endpointb"),b,d);d.__defineGetter__("endpoints",function(){var a=[];a.push(this.endpointA);a.push(this.endpointB);return a});return d};c?(d.__defineGetter__("connectedArticle",function(){if(!d.___collection.connectedArticle)throw Error("connectedArticle can be accessed only by using the getConnectedArticles call");var a=
d.___collection.connectedArticle.get("__id");if(!a)return null;var c=d.getConnection().__endpointa.articleid;d.getConnection().__endpointa.articleid==a&&(c=d.getConnection().__endpointb.articleid);return d.___collection.getConnectedArticle(c)}),d.parseConnection()):a.__endpointa&&a.__endpointb&&d.setupConnection(d.get("__endpointa"),d.get("__endpointb"));return d};b.Appacitive.Connection.multiDelete=function(a,c,d,f){if(!a||"string"!=typeof a||0==a.length)throw Error("Specify relationName");if(0<
c.length){var e=new b.Appacitive.HttpRequest;e.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.connection.getMultiDeleteUrl(a);e.method="post";e.data={idlist:c};e.onSuccess=function(a){a&&"200"==a.code?d():(a=a||{},f(a||{message:"Server error",code:400}))};e.onError=function(a){a=a||{};f(a||{message:"Server error",code:400})};b.Appacitive.http.send(e)}else d()};var d=function(a,c,d){a.onSuccess=function(a){if(a&&a.status&&"200"==a.status.code){if("function"==typeof c){var f=a.connections,
e=[];f||(f=[]);f.forEach(function(a){e.push(new b.Appacitive.Connection(a))});c(e,a.paginginfo)}}else a=a||{},"function"==typeof d&&d(a.status||{message:"Server error",code:400})};a.onError=function(a){a=a||{};"function"==typeof d&&d(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(a)};b.Appacitive.Connection.multiGet=function(a,c,f,e){if(!a||"string"!=typeof a||0==a.length)throw Error("Specify relationName");if(!c||"object"!==typeof c||!(0<c.length))throw Error("Specify list of ids for multiget");
var l=new b.Appacitive.HttpRequest;l.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.connection.getMultiGetUrl(a,c.join(","));l.method="get";d(l,f,e)};b.Appacitive.Connection.getInterconnects=function(a,c,b,f){a=(new Appacitive.Queries.InterconnectsQuery({articleAId:a,articleBIds:c})).toRequest();d(a,b,f)};b.Appacitive.Connection.getBetweenArticles=function(a,c,b,f){a=(new Appacitive.Queries.GetConnectionsBetweenArticlesQuery({articleAId:a,articleBId:c})).toRequest();d(a,b,f)};b.Appacitive.Connection.getBetweenArticlesForRelation=
function(a,c,d,f,e){a=(new Appacitive.Queries.GetConnectionsBetweenArticlesForRelationQuery({articleAId:a,articleBId:c,relation:d})).toRequest();a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?"function"==typeof f&&(a=a.connection?new b.Appacitive.Connection(a.connection):null,f(a)):(a=a||{},"function"==typeof e&&e(a.status||{message:"Server error",code:400}))};a.onError=function(a){a=a||{};"function"==typeof e&&e(a.status||{message:"Server error",code:400})};b.Appacitive.http.send(a)}})(global);
(function(b){b.Appacitive.Users=new function(){var e=null;this.__defineGetter__("currentUser",function(){return e});this.setCurrentUser=function(f,d,a){if(!f||"object"!=typeof f)throw Error("Cannot set null object as user");var c=f;f.getArticle||(c=new b.Appacitive.User(f));if(!c.get("__id")||0==c.get("__id").length)throw Error("Specify user __id");b.Appacitive.localStorage.set("Appacitive-User",f);a||(a=60);e=c;d&&b.Appacitive.Session.setUserAuthHeader(d,a);e.logout=function(a){b.Appacitive.Users.logout(a)};
e.updatePassword=function(a,c,d,f){var e=this.get("__id"),k=d,n=f;if(!e||"string"!==typeof e||0==e.length)throw Error("Please specify valid userid");if(!a||"string"!==typeof a||0==a.length)throw Error("Please specify valid oldPassword");if(!c||"string"!==typeof c||0==c.length)throw Error("Please specify valid newPassword");k=k||function(){};n=n||function(){};a==c?"function"==typeof k&&k():(a={oldpassword:a,newpassword:c},c=new b.Appacitive.HttpRequest,c.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getUpdatePasswordUrl(e),
c.method="post",c.data=a,c.onSuccess=function(a){a&&"200"==a.code&&("function"==typeof k?k():n(a))},c.onError=n,b.Appacitive.http.send(c))};b.Appacitive.eventManager.clearAndSubscribe("user."+c.get("__id")+".updated",function(a,c){b.Appacitive.localStorage.set("Appacitive-User",c.object.getArticle())})};b.Appacitive.User=function(f){f.__schematype="user";return new b.Appacitive.Article(f,!0)};this.deleteUser=function(f,d,a){if(!f)throw Error("Specify userid for user delete");(new b.Appacitive.Article({__schematype:"user",
__id:f})).del(d||function(){},a||function(){})};this.deleteCurrentUser=function(f,d){f=f||function(){};if(null===e)throw Error("Current user is not yet set for delete operation");var a=e.get("__id");this.deleteUser(a,function(a){b.Appacitive.Session.removeUserAuthHeader();"function"==typeof f&&f(a)},d)};this.createUser=this.createNewUser=function(f,d,a){f=f||{};f.__schematype="user";if(!f.username||!f.password||!f.firstname||0==f.username.length||0==f.password.length||0==f.firstname.length)throw Error("username, password and firstname are mandatory");
var c=new b.Appacitive.Article(f);f.type="user";c.save(d,a)};this.signup=function(b,d,a){var c=this;this.createUser(b,function(){c.login(b.username,b.password,d,a)},function(c){a(c)})};this.authenticateUser=function(f,d,a){d=d||function(){};a=a||function(){};f.expiry||(f.expiry=864E5);var c=this,e=new b.Appacitive.HttpRequest;e.method="post";e.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getAuthenticateUserUrl();e.data=f;e.onSuccess=function(b){b&&b.user?(c.setCurrentUser(b.user,
b.token,f.expiry),d({user:c.currentUser,token:b.token})):(b=b||{},a(b.status))};e.onError=a;b.Appacitive.http.send(e)};this.login=function(b,d,a,c){if(!b||!d||0==b.length||0==d.length)throw Error("Please specify username and password");this.authenticateUser({username:b,password:d,expiry:864E5},a||function(){},c||function(){})};this.authenticateWithFacebook=this.signupWithFacebook=function(e,d){e=e||function(){};d=d||function(){};var a=this;FB?FB.api("/me",function(){var c={accesstoken:b.Appacitive.facebook.accessToken,
type:"facebook",expiry:864E5,createnew:!0},g=new b.Appacitive.HttpRequest;g.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getAuthenticateUserUrl();g.method="post";g.data=c;g.onSuccess=function(c){c.user?(a.setCurrentUser(c.user,c.token,120),e({user:a.currentUser,token:c.token})):(data=data||{},d(data))};g.onError=d;b.Appacitive.http.send(g)}):d()};this.validateCurrentUser=function(e,d){e&&("function"!=typeof e&&"boolean"==typeof e)&&(d=e,e=function(){});var a=b.Appacitive.Cookie.readCookie("Appacitive-UserToken");
if(!a)return"function"==typeof e&&e(!1),!1;if(d)return"function"==typeof e&&e(!0),!0;try{var c=new b.Appacitive.HttpRequest;c.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getValidateTokenUrl(a);c.method="POST";c.data={};c.onSuccess=function(a){"function"==typeof e&&e(a.result)};b.Appacitive.http.send(c)}catch(g){e(!1)}};this.sendResetPasswordEmail=function(e,d,a,c){a=a||function(){};c=c||function(){};if(!e||"string"!=typeof e||0==e.length)throw Error("Please specify valid username");
if(d&&"string"==typeof d&&0==d.length)throw Error("Plase specify subject for email");e={username:e,subject:d};d=new b.Appacitive.HttpRequest;d.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.user.getSendResetPasswordEmailUrl();d.method="post";d.data=e;d.onSuccess=function(b){b&&"200"==b.code&&("function"==typeof a?a():c(b))};d.onError=c;b.Appacitive.http.send(d)};this.logout=function(f,d){e=null;b.Appacitive.Session.removeUserAuthHeader(f||function(){},d)}}})(global);
(function(b){b.Appacitive.Email=new function(){var e={smtp:{username:null,password:null,host:"smtp.gmail.com",port:465,enablessl:!0},from:null,replyto:null};this.getConfig=function(){return e};var f=function(d,a,c){var e=new b.Appacitive.HttpRequest;e.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.email.getSendEmailUrl();e.method="post";e.data=d;e.onSuccess=function(b){b&&b.status&&"200"==b.status.code?a(b.email):(b=b||{},b.status=b.status||{},c(b.status.message||"Server error"))};
b.Appacitive.http.send(e)};this.setupEmail=function(b){b=b||{};e.smtp.username=b.username||e.smtp.username;e.from=b.from||e.from;e.smtp.password=b.password||e.smtp.password;e.smtp.host=b.smtp.host||e.smtp.host;e.smtp.port=b.smtp.port||e.smtp.port;e.smtp.enablessl=b.enableSSL||e.smtp.enablessl;e.replyto=b.replyTo||e.replyto};this.sendTemplatedEmail=function(b,a,c){a=a||function(){};c=c||function(){};if(!b||!b.to||!b.to.length||0==b.to.length)throw Error("Atleast one receipient is mandatory to send an email");
if(!b.subject||0==b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");if(!b.templateName)throw Error("template name is mandatory to send an email");var g={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,body:{templatename:b.templateName||"",data:b.data||{},ishtml:!1==b.isHtml?!1:!0}};if(b.useConfig){g.smtp=e.smtp;if(!b.from&&!e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");
g.from=b.from||e.from;g.replyto=b.replyTo||e.replyto}f(g,a,c)};this.sendRawEmail=function(b,a,c){a=a||function(){};c=c||function(){};if(!b||!b.to||!b.to.length||0==b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0==b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.body)throw Error("body is mandatory to send an email");var g={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,body:{content:b.body||"",ishtml:!1==b.isHtml?
!1:!0}};if(b.useConfig){g.smtp=e.smtp;if(!b.from&&!e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");g.from=b.from||e.from;g.replyto=b.replyTo||e.replyto}f(g,a,c)}}})(global);
(function(b){var e=function(){var b=require("facebook-node-sdk"),d=null;this.FB=null;this.initialize=function(a,c){if(!a)throw Error("Please provide appid");if(!c)throw Error("Please provide app secret");this.FB=new b({appId:a,secret:c})};this.requestLogin=function(a,b,e){this.FB?(d=accesstoken,FB.setAccessToken(a)):e("Intialize facebook with your appid and appsecret")};this.getCurrentUserInfo=function(a,b){this.FB&&d?(a=a||function(){},b=b||function(){},this.FB.api("/me",function(d,e){e?a(e):b("Access token is invalid")})):
b("Either intialize facebook with your appid and appsecret or set accesstoken")};this.__defineGetter__("accessToken",function(){return d});this.__defineSetter__("accessToken",function(a){console.log(a);d=a;this.FB&&this.FB.setAccessToken(a)});this.getProfilePictureUrl=function(a){return"https://graph.facebook.com/"+a+"/picture"}};b.Appacitive.facebook=b.Appacitive.runtime.isBrowser?new function(){var b=null;this.requestLogin=function(d,a){d=d||function(){};a=a||function(){};FB?FB.login(function(c){c.authResponse?
(b=c.authResponse.accessToken,d(c.authResponse)):a()},{scope:"email,user_birthday"}):a()};this.getCurrentUserInfo=function(b,a){b=b||function(){};a=a||function(){};FB.api("/me",function(c){c?b(c):a()})};this.__defineGetter__("accessToken",function(){return b});this.__defineSetter__("accessToken",function(d){b=d});this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=function(b,a){b=b||function(){};a=a||function(){};Appacitive.facebook.accessToken="";try{FB.logout(function(){Appacitive.Users.logout();
b()})}catch(c){a(c.message)}}}:new e})(global);
(function(b){b.Appacitive.Push=new function(){this.send=function(e,f,d){f=f||function(){};d=d||function(){};if(!e)throw Error("Please specify push options");var a=new b.Appacitive.HttpRequest;a.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getPushUrl();a.method="post";a.data=e;a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?f(a.id):(a=a||{},a.status=a.status||{},d(a.status.message||"Server error"))};a.onError=function(a){d(a||"Server error")};b.Appacitive.http.send(a)};
this.getNotification=function(e,f,d){f=f||function(){};d=d||function(){};if(!e)throw Error("Please specify notification id");var a=new b.Appacitive.HttpRequest;a.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getGetNotificationUrl(e);a.method="get";a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?f(a.pushnotification):(a=a||{},a.status=a.status||{},d(a.status.message||"Server error"))};a.onError=function(a){d(a||"Server error")};b.Appacitive.http.send(a)};this.getAllNotifications=
function(e,f,d){f=f||function(){};d=d||function(){};e?(e.pnum=e.pnum||1,e.psize=e.psize||20):e={pnum:1,psize:20};var a=new b.Appacitive.HttpRequest;a.url=b.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getGetAllNotificationsUrl(e);a.method="get";a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?f(a.pushnotifications,a.paginginfo):(a=a||{},a.status=a.status||{},d(a.status.message||"Server error"))};a.onError=function(a){d(a||"Server error")};b.Appacitive.http.send(a)}}})(global);
(function(b){b.Appacitive.File=function(e){e=e||{};this.fileId=e.fileId;this.contentType=e.contentType;this.fileData=e.fileData;var f=function(a,c,d){var e=new b.Appacitive.HttpRequest;e.url=a;e.method="GET";e.onSuccess=c;e.onError=d;b.Appacitive.http.send(e)},d=function(a,c,d,e,f){(new FormData).append("fileToUpload",c);var j=new b.Appacitive.HttpRequest;j.url=a;j.method="PUT";j.data=c;j.headers.push({key:"content-type",value:d});j.onSuccess=e;j.onError=f;j.send(!0)};this.save=function(a,c,e){if(this.fileId&&
"string"==typeof this.fileId&&0<this.fileId.length){var h=this,l=a,j=c;if(!h.fileData)throw Error("Please specify filedata");if(e||"string"==typeof e)h.contentType=e;else{if(!h.contentType||"string"!==typeof e||0==h.contentType.length)h.contentType="text/plain";try{h.contentType=file.type}catch(m){}}a=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.file.getUpdateUrl(h.fileId,h.contentType);l=l||function(){};j=j||function(){};f(a,function(a){a&&a.status&&"200"==a.status.code?d(a.url,
h.fileData,h.contentType,function(){h.getDownloadUrl(function(a){l(a,h)},j)},j):"function"==typeof j&&j(a.status,h)},j)}else{var k=this,n=a,p=c;if(!k.fileData)throw Error("Please specify filedata");if(e||"string"==typeof e)k.contentType=e;else{if(!k.contentType||"string"!==typeof e||0==k.contentType.length)k.contentType="text/plain";try{k.contentType=file.type}catch(r){}}a=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.file.getUploadUrl(k.contentType);n=n||function(){};p=p||function(){};
f(a,function(a){a&&a.status&&"200"==a.status.code?d(a.url,k.fileData,k.contentType,function(){k.fileId=a.id;k.getDownloadUrl(function(a){n(a,k)},p)},p):"function"==typeof p&&p(a.status,k)},p)}};this.deleteFile=function(a,c){if(!this.fileId)throw Error("Please specify fileId to delete");a=a||function(){};c=c||function(){};var d=new b.Appacitive.HttpRequest;d.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.file.getDeleteUrl(this.fileId);d.method="DELETE";d.onSuccess=function(b){b&&
"200"==b.code?"function"==typeof a&&a():"function"==typeof c&&"function"==typeof c&&c(b,that)};d.onError=c;b.Appacitive.http.send(d)};this.getDownloadUrl=function(a,c){if(!this.fileId)throw Error("Please specify fileId to download");var d=this;a=a||function(){};c=c||function(){};var e=new b.Appacitive.HttpRequest;e.url=b.Appacitive.config.apiBaseUrl+b.Appacitive.storage.urlFactory.file.getDownloadUrl(this.fileId,556E4);e.method="GET";e.onSuccess=function(b){b&&b.status&&"200"==b.status.code?(d.url=
b.uri,"function"==typeof a&&a(b.uri)):"function"==typeof c&&"function"==typeof c&&c(b.status,d)};e.onError=c;b.Appacitive.http.send(e)}}})(global);
(function(b){b.Appacitive.Date={};b.Appacitive.Date.parseISODate=function(b){try{var f=new Date(b);if(isNaN(f)){if(/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$/.exec(b)){var d=b.split("T"),a=d[0].split("-"),c=d[1].split("Z")[0].split(":"),g=c[2].split("."),h=Number(c[0]),f=new Date;f.setUTCFullYear(Number(a[0]));f.setUTCMonth(Number(a[1])-1);f.setUTCDate(Number(a[2]));f.setUTCHours(Number(h));f.setUTCMinutes(Number(c[1]));f.setUTCSeconds(Number(g[0]));
g[1]&&f.setUTCMilliseconds(Number(g[1]));return f}return null}return f}catch(l){return null}};b.Appacitive.Date.toISOString=function(b){try{return b=b.toISOString(),b=replace("Z","0000Z")}catch(f){return null}}})(global);
(function(b){b.Appacitive.localStorage=new function(){var e=b.Appacitive.runtime.isBrowser?window.localStorage:{};this.set=function(b,d){d=d||"";if(!b)return!1;if("object"==typeof d)try{d=JSON.stringify(d)}catch(a){}e[b]=d;return!0};this.get=function(b){if(!b)return null;b=e.getItem(b);if(!b)return null;if("{"==b[0])try{b=JSON.parse(b)}catch(d){}return b};this.remove=function(b){if(b)try{delete e[b]}catch(d){}}}})(global);
(function(b){b.Appacitive.runtime.isBrowser&&(b.Appacitive.Cookie=new function(){this.setCookie=function(b,f,d,a){if(d){var c=new Date;c.setTime(c.getTime()+6E4*d);c="; expires="+c.toGMTString()}a||(c="");document.cookie=b+"="+f+c+"; path=/"};this.readCookie=function(b){b+="=";for(var f=document.cookie.split(";"),d=0;d<f.length;d++){for(var a=f[d];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(b))return a.substring(b.length,a.length)}return null};this.eraseCookie=function(b){this.setCookie(b,
"",-1,!0)}})})(global);"undefined"!=typeof module&&(module.exports=function(b){global.Appacitive.initialize(b);return global.Appacitive});