try{!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return!0}}).x&&(Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:!1,configurable:!0,value:function(d,e){Object.defineProperty(this,d,{get:e,enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:!1,configurable:!0,value:function(d,e){Object.defineProperty(this,d,{set:e,enumerable:!0,configurable:!0})}}))}catch(defPropException){}var global={};
(function(){global="undefined"==typeof window?process:window;global.Appacitive||(global.Appacitive={runtime:{isNode:"undefined"!=typeof process,isBrowser:"undefined"!=typeof window}});var d=function(a){if(!a||!a.send||"function"!=typeof a.send)throw Error("No applicable httpTransport class found");a.onResponse=this.onResponse;var c=[],b={},j=0,d={},e=0;this.addProcessor=function(a){if(a){a.pre=a.pre||function(){};a.post=a.post||function(){};var c=a.pre;j+=1;b[j]=c;a=a.post;e+=1;d[e]=a}};this.enqueueRequest=
function(a){c.push(a)};this.notify=function(){if(0!==c.length){var j=[],e;for(e in d)d.hasOwnProperty(e)&&j.push(d[e]);for(;0<c.length;){var n=c.shift(),m=[];for(e in b)b.hasOwnProperty(e)&&m.push(b[e](n));a.send(n,j,m)}}};this.onResponse=function(a){console.dir(a)}},e=function(){var a=function(){throw Error("Not Implemented Exception");};this.inOnline=this.send=a;this.onResponse=function(){a()};this.onError=function(){a()}},c=function(){var a=new e;a.type="jQuery based http provider";a.send=function(a,
f,d){"function"==typeof a.beforeSend&&a.beforeSend(a);switch(a.method.toLowerCase()){case "get":$.ajax({url:a.url,type:"GET",async:a.async,beforeSend:function(c){for(var b=0;b<a.headers.length;b+=1)c.setRequestHeader(a.headers[b].key,a.headers[b].value)},success:function(e){try{e=JSON.parse(e)}catch(k){}c(e,f,d);b.onResponse(e,a)},error:function(c){b.onError(a,c)}});break;case "post":$.ajax({url:a.url,type:"POST",async:a.async,contentType:"application/json",data:JSON.stringify(a.data),beforeSend:function(c){for(var b=
0;b<a.headers.length;b+=1)c.setRequestHeader(a.headers[b].key,a.headers[b].value)},success:function(e){try{e=JSON.parse(e)}catch(k){}c(e,f,d);b.onResponse(e,a)},error:function(c){b.onError(a,c)}});break;case "put":$.ajax({url:a.url,type:"PUT",contentType:"application/json",data:JSON.stringify(a.data),async:a.async,beforeSend:function(c){for(var b=0;b<a.headers.length;b+=1)c.setRequestHeader(a.headers[b].key,a.headers[b].value)},success:function(e){try{e=JSON.parse(e)}catch(k){}c(e,f,d);b.onResponse(e,
a)},error:function(c){b.onError(a,c)}});break;case "delete":$.ajax({url:a.url,type:"DELETE",async:a.async,beforeSend:function(c){for(var b=0;b<a.headers.length;b+=1)c.setRequestHeader(a.headers[b].key,a.headers[b].value)},success:function(e){try{e=JSON.parse(e)}catch(k){}c(e,f,d);b.onResponse(e,a)},error:function(c){b.onError(a,c)}});break;default:throw Error("Unrecognized http method: "+a.method);}};a.isOnline=function(){return window.navigator.onLine||!0};var c=function(a,c,b){if(c.length!=b.length)throw Error("Callback length and state length mismatch!");
for(var f=0;f<c.length;f+=1)c[f].apply({},[a,b[f]])},b=a;$=$||{};$.ajax=$.ajax||{};return a},b=function(){var a=new e;a.type="Http provider for nodejs";a.send=function(a,f,e){"function"==typeof a.beforeSend&&a.beforeSend(a);var k=a;a=require("url").parse(k.url);var k=k||{},l;for(l in k)if("headers"==l)for(var m=0;m<k.headers.length;m+=1)b.headers[k.headers[m].key]=k.headers[m].value;else b[l]=k[l];b.host=a.host;b.port=a.port||80;b.path=a.path;b.method=k.method.toUpperCase();"string"!=typeof b.data&&
(b.data=JSON.stringify(b.data));b.headers["Content-Length"]=b.data.length;b.headers["Content-Type"]="application/json";l=d.request(b,function(a){var b="";a.setEncoding("utf8");a.on("data",function(a){b+=a});a.on("end",function(){if("application/json"==a.headers["content-type"]&&"200"==a.statusCode){"{"!=b[0]&&(b=b.substr(1,b.length-1));a.json=JSON.parse(b);var d=a.json;if(f.length!=e.length)throw Error("Callback length and state length mismatch!");for(var j=0;j<f.length;j+=1)f[j].apply({},[d,e[j]]);
c.onResponse(a.json,k)}else a.text=b,c.onError(k,a)})});l.write(b.data);l.on("error",function(a){c.onError(k,a)});l.end()};a.isOnline=function(){return!0};var c=a,b={host:"localhost",port:80,path:"",data:"{}",method:"GET",headers:{"Content-Type":"application/json",accept:"application/json"}},d=require("http");return a};global.Appacitive.http=new function(){var a=global.Appacitive.runtime.isBrowser?new c:new b,g=new d(a),e=!1;this.pause=function(){e=!0};this.unpause=function(){e=!1};this.addProcessor=
function(a){var b=Error('Must provide a processor object with either a "pre" function or a "post" function.');if(!a)throw b;if(!a.pre&&!a.post)throw b;g.addProcessor(a)};this.send=function(b){g.enqueueRequest(b);a.isOnline()&&!1==e&&g.notify()};this.flush=function(b){b?g.notify():a.isOnline()&&g.notify()};this.onError=function(a,b){if(a.onError)if(a.context)a.onError.apply(a.context,[b]);else a.onError(b)};a.onError=this.onError;this.onResponse=function(a,b){if(b.onSuccess)if(b.context)b.onSuccess.apply(b.context,
[a]);else b.onSuccess(a)};a.onResponse=this.onResponse};global.Appacitive.HttpRequest=function(){this.url="";this.data={};this.async=!0;this.headers=[];this.method="GET"};global.Appacitive&&global.Appacitive.http&&global.Appacitive.http.addProcessor({pre:function(){return(new Date).getTime()},post:function(a,b){var c=(new Date).getTime()-b;a._timeTakenInMilliseconds=c}});var a=global;a.Appacitive&&a.Appacitive.http&&a.Appacitive.http.addProcessor({pre:function(a){return a},post:function(){}})})();
(function(d){String.format=function(c,b){if(1>=arguments.length)return c;for(var a=arguments.length-2,f=0;f<=a;f++)c=c.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+1]);return c};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(c){var b=RegExp("^"+c),a=this;b.test(a)&&(a=a.slice(1,a.length));b=RegExp(c+"$");b.test(a)&&(a=a.slice(0,-1));return a};String.toSearchString=function(c){"undefined"==typeof c&&(c="");for(var b=
"",a=0;a<c.length;a+=1)-1==" .,;#".indexOf(c[a])&&(b+=c[a]);return b=b.toLowerCase()};String.contains=function(c,b){return-1!=c.indexOf(b)};String.startsWith=function(c,b){return 0==c.indexOf(b)};d.dateFromWcf=function(c,b){var a=/Date\(([^)]+)\)/.exec(c);if(2!=a.length){if(!b)return s;throw Error(s+" is not .net json date.");}return new Date(parseFloat(a[1]))};var e=function(){d.Appacitive.bag=d.Appacitive.bag||{};this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",
this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(){return String.format("{0}/create",this.userServiceUrl)},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getUserUrl:function(c){return String.format("{0}/{1}",this.userServiceUrl,c)},getUpdateUrl:function(c){return String.format("{0}/{1}",this.userServiceUrl,c)},getDeleteUrl:function(c){return String.format("{0}/{1}",this.userServiceUrl,c)},getSearchAllUrl:function(c,b,a){c=
"";c=String.format("{0}/search/user/all",(new e).article.articleServiceUrl);c=a?c+"?psize="+a:c+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(a=0;a<b.length;a+=1)0!=b[a].trim().length&&(c=c+"&"+b[a]);return c},getGetAllLinkedAccountsUrl:function(c){return String.format("{0}/{1}/linkedaccounts",this.userServiceUrl,c)},getValidateTokenUrl:function(c){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,c)},getInvalidateTokenUrl:function(c){return String.format("{0}/invalidate?userToken={1}",
this.userServiceUrl,c)}};this.device={deviceServiceUrl:"device",getCreateUrl:function(){return String.format("{0}/register",this.deviceServiceUrl)},getUpdateUrl:function(c){return String.format("{0}/{1}",this.deviceServiceUrl,c)},getDeleteUrl:function(c){return String.format("{0}/{1}",this.deviceServiceUrl,c)}};this.article={articleServiceUrl:"article",getGetUrl:function(c,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,c,b)},getMultiGetUrl:function(c,b,a){return String.format("{0}/multiGet/{1}/{2}",
this.articleServiceUrl,b,a)},getMultiDeleteUrl:function(c,b){return String.format("{0}/multidelete/{1}",this.articleServiceUrl,b)},getSearchAllUrl:function(c,b,a,f){c="";c=String.format("{0}/search/{1}/all",this.articleServiceUrl,b);c=f?c+"?psize="+f:c+"?psize=10";if("undefined"!==typeof a&&0<a.length)for(b=0;b<a.length;b+=1)0!=a[b].trim().length&&(c=c+"&"+a[b]);return c},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.articleServiceUrl)},getPropertiesSearchUrl:function(c,
b,a){c=String.format("{0}/search/{1}/all",this.articleServiceUrl,b);return c+("?properties="+a)},getDeleteUrl:function(c,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,c,b)},getCreateUrl:function(c){return String.format("{0}/{1}",this.articleServiceUrl,c)},getUpdateUrl:function(c,b){return String.format("{0}/{1}/{2}",this.articleServiceUrl,c,b)},getMultideleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",this.articleServiceUrl,c)}};this.connection={connectionServiceUrl:"connection",
getGetUrl:function(c,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,c,b)},getCreateUrl:function(c){return String.format("{0}/{1}",this.connectionServiceUrl,c)},getUpdateUrl:function(c,b,a){return String.format("{0}/update/{1}/{2}",this.connectionServiceUrl,b,a)},getDeleteUrl:function(c,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",this.connectionServiceUrl,c)},getSearchByArticleUrl:function(c,
b,a,f,d){c="";c=String.format("{0}/{1}/find/all?label={2}&articleid={3}",this.connectionServiceUrl,b,f,a);if("undefined"!==typeof d&&0<d.length)for(b=0;b<d.length;b+=1)c=c+"&"+d[b];return c},getConnectedArticles:function(c,b,a,f){c="";c=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,b,a);if(f&&f.length&&0<f.length)for(b=0;b<f.length;b+=1)c=0==b?c+("?"+f[b]):c+("&"+f[b]);return c},getInterconnectsUrl:function(){var c="";return c=String.format("{0}/connectedarticles",this.connectionServiceUrl)},
getPropertiesSearchUrl:function(c,b,a){c=String.format("{0}/{1}/find/all",this.connectionServiceUrl,b);return c+("?properties="+a)}};this.cannedList={cannedListServiceUrl:"list",getGetListItemsUrl:function(c){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,c)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",this.pushServiceUrl)},getGetNotificationUrl:function(c){return String.format("{0}/notification/{1}",this.pushServiceUrl,c)},getGetAllNotificationsUrl:function(c){return String.format("{0}/getAll?psize={1}&pnum={2}",
this.pushServiceUrl,c.psize,c.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(){return String.format("{0}/uploadurl?contenttype={1}&expires=20",this.fileServiceUrl,escape(contenttype))},getUploadUrl:function(c,b){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",this.fileServiceUrl,b,escape(contenttype))},getDownloadUrl:function(c,b){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,c,b)},getDeleteUrl:function(){return String.format("{0}/delete/{1}",
this.fileServiceUrl,fileId)}};this.query={params:function(c){var b=[];return""==location.search||-1==location.search.indexOf("?")?b:c?(c=c.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(a,f){var d=f.split("="),e=d[1];2<d.length&&d.forEach(function(a){0==a||1==a||(e=e+"="+d[a])});d[0].toLowerCase()==c&&(b=[d[0],e])}),b):location.search.split("?")[1].split("=")}}};d.Appacitive.storage=d.Appacitive.storage||{};d.Appacitive.storage.urlFactory=new e})(global);
(function(d){d.Appacitive.eventManager=new function(){var d={};this.subscribe=function(c,b){if("string"!=typeof c||"function"!=typeof b)throw Error("Incorrect subscription call");"undefined"==typeof d[c]&&(d[c]=[]);var a;a=function(){return Math.floor(65536*Math.random()).toString(16)};a=a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a();d[c].push({callback:b,id:a});return a};this.unsubscribe=function(c){if(!c)return!1;var b=-1,a=null,f;for(f in d)for(var g=0;g<d[f].length;g+=1)if(d[f][g].id==c){b=g;
a=f;break}return-1!=b?(d[a].splice(b,1),!0):!1};this.fire=function(c,b,a){if("string"!=typeof c)throw Error("Incorrect fire call");if("undefined"==typeof a||null===a)a={};a.eventName=c;console&&(console.log&&"function"==typeof console.log)&&console.log(c+" fired");if("undefined"!=typeof d.all)for(var f=0;f<d.all.length;f+=1)d.all[f].callback(b,a);f=function(a,b,c){setTimeout(function(){a(b,c)},0)};if("undefined"!=typeof d[c])for(var g=0;g<d[c].length;g+=1)f(d[c][g].callback,b,a)};this.clearSubscriptions=
function(c){if("string"!=typeof c)throw Error("Event Name must be string in EventManager.clearSubscriptions");d[c]&&(d[c].length=0);return this};this.clearAndSubscribe=function(c,b){this.clearSubscriptions(c);this.subscribe(c,b)};this.dump=function(){console.dir(d)}}})(global);(function(d){d.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/"}})(global);
(function(d){d.Appacitive.session=new function(){var e=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},c=null,b=null,a=null;this.useApiKey=!0;this.onSessionCreated=function(){};this.recreate=function(){d.Appacitive.session.create(b)};this.create=function(f){b=f=f||{};var g=new e;f.apikey?(g.apikey=f.apikey||"",a=g.apikey):g.apikey=a;g.isnonsliding=f.isnonsliding||g.isnonsliding;g.usagecount=f.usagecount||g.usagecount;g.windowtime=f.windowtime||g.windowtime;f=
new d.Appacitive.HttpRequest;f.url=d.Appacitive.config.apiBaseUrl+"application.svc/session";f.method="put";f.data=g;f.onSuccess=function(a){a&&a.status&&"200"==a.status.code?(c=a.session.sessionkey,d.Appacitive.session.useApiKey=!1,d.Appacitive.eventManager.fire("session.success",{},a),d.Appacitive.session.onSessionCreated()):d.Appacitive.eventManager.fire("session.error",{},a)};d.Appacitive.http.send(f)};var f=null,g=!1;d.Appacitive.http.addProcessor({pre:function(b){d.Appacitive.session.useApiKey?
b.headers.push({key:"appacitive-apikey",value:a}):b.headers.push({key:"appacitive-session",value:c});!0===g&&(1==b.headers.filter(function(a){return"appacitive-user-auth"==a.key}).length?b.headers.forEach(function(a){"appacitive-user-auth"==a.key&&(a.value=f)}):b.headers.push({key:"appacitive-user-auth",value:f}))}});this.setUserAuthHeader=function(a,b){a&&(g=!0,f=a,d.Appacitive.runtime.isBrowser&&d.Appacitive.Cookie.setCookie("Appacitive-UserToken",a,b))};this.removeUserAuthHeader=function(a){g=
!1;a=a||function(){};if(f)try{var b=new d.Appacitive.HttpRequest;b.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.user.getInvalidateTokenUrl(f);f=null;d.Appacitive.localStorage.remove("Appacitive-User");b.method="POST";request.data={};request.onSuccess=function(){"function"==typeof a&&a()};d.Appacitive.http.send(request)}catch(c){}else"function"==typeof a&&a();d.Appacitive.runtime.isBrowser&&d.Appacitive.Cookie.eraseCookie("Appacitive-UserToken")};this.isSessionValid=function(a){if(!a)return!0;
if(a.status){if(a.status.code&&("8027"==a.status.code||"8002"==a.status.code))return!1}else if(a.code&&("8027"==a.code||"8002"==a.code))return!1;return!0};this.resetSession=function(){c=null};this.get=function(){return c};this.setSession=function(a){c=a};this.setApiKey=function(b){a=b};var h="sandbox";this.__defineGetter__("environment",function(){return h});this.__defineSetter__("environment",function(a){"sandbox"!=a&&"live"!=a&&(a="sandbox");h=a})};d.Appacitive.initialize=function(e){d.Appacitive.session.setApiKey(e.apikey||
"");d.Appacitive.session.environment=e.env||"";d.Appacitive.useApiKey=!0;if(e.user)d.Appacitive.localStorage.set("Appacitive-User",e.user),d.Appacitive.Users.setCurrentUser(e.user);else if(d.Appacitive.runtime.isBrowser){var c=d.Appacitive.localStorage.get("Appacitive-User");d.Appacitive.Users.setCurrentUser(c);(c=d.Appacitive.Cookie.readCookie("Appacitive-UserToken"))&&d.Appacitive.session.setUserAuthHeader(c,60)}e.userToken&&d.Appacitive.session.setUserAuthHeader(e.userToken,60)}})(global);
(function(d){d.Appacitive&&d.Appacitive.http&&d.Appacitive.http.addProcessor({pre:function(e){e.headers.push({key:"appacitive-environment",value:d.Appacitive.session.environment})}})})(global);
(function(d){d.Appacitive.queries={};var e=function(a){a=a||{};this.pageNumber=a.pageNumber||1;this.pageSize=a.pageSize||200};e.prototype.toString=function(){return"psize="+this.pageSize+"&pnum="+this.pageNumber};var c=function(a){a=a||{};this.orderBy=a.orderBy||"__UtcLastUpdatedDate";this.isAscending="undefined"==typeof a.isAscending?!1:a.isAscending};c.prototype.toString=function(){return"orderBy="+this.orderBy+"&isAsc="+this.isAscending};var b=function(a){var b=a||{};this.pageQuery=new e(a);this.sortQuery=
new c(a);this.baseType=a.schema||a.relation;if(!this.baseType)throw Error("schema or relation name is mandatory");this.type=a.schema?"article":"connection";this.filter=a.filter||"";this.freeText=a.freeText||"";this.fields=a.fields||"";this.extendOptions=function(a){for(var d in a)b[d]=a[d];this.pageQuery=new e(b);this.sortQuery=new c(b)};this.toUrl=function(){var a=d.Appacitive.config.apiBaseUrl+this.type+".svc/"+this.baseType+"/find/all?"+this.pageQuery.toString()+"&"+this.sortQuery.toString();this.filter&&
0<this.filter.trim().length&&(a+="&query="+this.filter);this.freeText&&0<this.freeText.trim().length&&(a+="&freetext="+this.freeText+"&language=en");this.fields&&0<this.fields.trim().length&&(a+="&fields="+this.fields);return a};this.toString=function(){var a=this.pageQuery.toString()+"&"+this.sortQuery.toString();this.filter&&0<this.filter.trim().length&&(a+="&query="+this.filter);this.freeText&&0<this.freeText.trim().length&&(a+="&freetext="+this.freeText+"&language=en");this.fields&&0<this.fields.trim().length&&
(a+="&fields="+this.fields);return a}};d.Appacitive.queries.SearchAllQuery=function(a){a=a||{};var c=new b(a);this.toRequest=function(){var a=new d.Appacitive.HttpRequest;a.url=c.toUrl();a.method="get";return a};this.extendOptions=function(){c.extendOptions.apply(c,arguments)};this.getOptions=function(){var a={},b;for(b in c)c.hasOwnProperty(b)&&"function"!=typeof c[b]&&(a[b]=c[b]);return a}};d.Appacitive.queries.BasicFilterQuery=function(a){a=a||{};var c=new b(a);this.toRequest=function(){var a=
new d.Appacitive.HttpRequest;a.url=c.toUrl();a.method="get";return a};this.setFilter=function(a){c.filter=a};this.setFreeText=function(a,b){c.freeText=b};this.__defineGetter__("filter",function(){return c.filter});this.__defineSetter__("filter",function(a){return c.filter=a});this.__defineGetter__("freeText",function(){return c.freetext});this.__defineSetter__("freeText",function(a){return c.freeText=a});this.__defineGetter__("fields",function(){return c.fields});this.__defineSetter__("fields",function(a){return c.fields=
a});this.extendOptions=function(){c.extendOptions.apply(c,arguments)};this.getOptions=function(){var a={},b;for(b in c)c.hasOwnProperty(b)&&"function"!=typeof c[b]&&(a[b]=c[b]);return a}};d.Appacitive.queries.GraphQuery=function(a){a=a||{};if(!a.graphQuery)throw Error("graphQuery object is mandatory");this.toRequest=function(){var b=new d.Appacitive.HttpRequest;b.url=d.Appacitive.config.apiBaseUrl;b.url+=d.Appacitive.storage.urlFactory.article.getProjectionQueryUrl();b.method="post";b.data=a.graphQuery;
return b}};d.Appacitive.queries.ConnectedArticlesQuery=function(a){a=a||{};var c=new b(a);this.toRequest=function(){var b=new d.Appacitive.HttpRequest;b.url=d.Appacitive.config.apiBaseUrl+"connection/"+a.relation+"/"+a.articleId+"/find?"+c.toString();return b};this.extendOptions=function(){c.extendOptions.apply(c,arguments)};this.setFilter=function(a){c.filter=a};this.setFreeText=function(a,b){c.freeText=b};this.__defineGetter__("filter",function(){return c.filter});this.__defineSetter__("filter",
function(a){return c.filter=a});this.__defineGetter__("freeText",function(){return c.freetext});this.__defineSetter__("freeText",function(a){return c.freeText=a});this.__defineGetter__("fields",function(){return c.fields});this.__defineSetter__("fields",function(a){return c.fields=a});this.getOptions=function(){var a={},b;for(b in c)c.hasOwnProperty(b)&&"function"!=typeof c[b]&&(a[b]=c[b]);return a}}})(global);
(function(d){d.Appacitive.BaseObject=function(e,c){var b={},a=e=e||{};if(c)for(var f in a)b[f]=a[f];!b.__id&&e.__id&&(b.__id=e.__id);this.fetch=function(c,f){c=c||function(){};f=f||function(){};if(a.__id){var e=this,g=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory[this.type].getGetUrl(a.__schematype||a.__relationtype,a.__id),h=new d.Appacitive.HttpRequest;h.url=g;h.method="get";h.onSuccess=function(d){if(d&&(d.article||d.connection||d.user||d.device)){b=d.article||d.connection||d.user||
d.device;d=d.article||d.connection||d.user||d.device;a.__id=d.__id;for(var g in d)"undefined"==typeof a[g]&&(a[g]=d[g]);e.___collection&&"article"==e.___collection.collectionType&&e.___collection.addToCollection(e);c()}else f(d.status)};d.Appacitive.http.send(h)}else f()};this.del=function(b,c,f){b=b||function(){};c=c||function(){};f=f||{};if(!a.__id&&this.___collection)this.___collection.removeByCId(this.__cid),b();else{var e=this,g=d.Appacitive.config.apiBaseUrl,g=g+d.Appacitive.storage.urlFactory[this.type].getDeleteUrl(a.__schematype||
a.__relationtype,a.__id);if(a&&a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))g=d.Appacitive.config.apiBaseUrl,g+=d.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getDeleteUrl(a.__id);f.deleteConnections&&!0===f.deleteConnections&&(g=-1==g.indexOf("?")?g+"?deleteconnections=true":g+"&deleteconnections=true");f=new d.Appacitive.HttpRequest;f.url=g;f.method="delete";f.onSuccess=function(d){"200"==d.code?(e.___collection&&e.___collection.removeById(a.__id),
b()):c(d)};f.onError=function(a){c(a)};d.Appacitive.http.send(f)}};this.getObject=function(){return a};this.toJSON=function(){return a};this.attributes=function(){if(0===arguments.length)return a.__attributes||(a.__attributes={}),a.__attributes;if(1==arguments.length)return a.__attributes||(a.__attributes={}),a.__attributes[arguments[0]];if(2==arguments.length){if("string"!==typeof arguments[1])throw Error("only string values can be stored in attributes.");a.__attributes||(a.__attributes={});a.__attributes[arguments[0]]=
arguments[1]}else throw Error(".attributes() called with an incorrect number of arguments. 0, 1, 2 are supported.");};this.aggregates=function(){var b={},c;for(c in a){if(!a.hasOwnProperty(c))return;"$"==c[0]&&(b[c]=a[c])}if(0===arguments.length)return b;if(1==arguments.length)return b[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");};this.get=function(b){if(b)return a[b]};this.set=function(b,c){b&&(a[b]=c);return c};this.save=function(b,
c){a.__id?g.apply(this,arguments):h.apply(this,arguments)};this.copy=function(b){for(var c in b)a[c]=b[c]};var g=function(c,f){c=c||function(){};f=f||function(){};var e=!1,g=JSON.parse(JSON.stringify(b)),h;for(h in a)"undefined"==typeof a[h]||null===a[h]?(g[h]=null,e=!0):a[h]!=b[h]?(g[h]=a[h],e=!0):a[h]==b[h]&&delete g[h],g.__revision&&delete g.__revision;if(e){e=new d.Appacitive.HttpRequest;h=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory[this.type].getUpdateUrl(a.__schematype||a.__relationtype,
b.__id?b.__id:a.__id);if(a&&a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))h=d.Appacitive.config.apiBaseUrl,h+=d.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getUpdateUrl(b.__id);e.url=h;e.method="post";e.data=g;e.onSuccess=function(a){a&&(a.article||a.connection||a.user||a.device)?(b=a.article||a.connection||a.user||a.device,"function"==typeof c&&c()):"function"==typeof f&&f(a.status)};e.onError=function(a){f(a)};d.Appacitive.http.send(e)}else c()},
h=function(c,f){c=c||function(){};f=f||function(){};var e=this,g=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory[this.type].getCreateUrl(a.__schematype||a.__relationtype);if(a.__schematype&&("user"==a.__schematype.toLowerCase()||"device"==a.__schematype.toLowerCase()))g=d.Appacitive.config.apiBaseUrl,g+=d.Appacitive.storage.urlFactory[a.__schematype.toLowerCase()].getCreateUrl();var h=new d.Appacitive.HttpRequest;h.url=g;h.method="put";a.__revision&&delete a.__revision;h.data=a;h.onSuccess=
function(d){var g=null;if(d&&(d.article||d.connection||d.user||d.device))g=d.article||d.connection||d.user||d.device;if(d&&g){b=g;a.__id=g.__id;for(var h in g)"undefined"==typeof a[h]&&(a[h]=g[h]);e.connectionCollections&&0<e.connectionCollections.length&&e.connectionCollections.forEach(function(b){b.getQuery().extendOptions({articleId:a.__id})});"connection"==e.type&&e.parseConnection();"function"==typeof c&&c(e)}else"function"==typeof f&&f(d.status)};h.onError=function(a){f(a)};d.Appacitive.http.send(h)}};
d.Appacitive.BaseObject.prototype.toString=function(){return JSON.stringify(this.getObject())}})(global);
(function(d){var e=function(){return Math.floor(65536*Math.random()).toString(16)};d.Appacitive.GUID=function(){var c=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e(),b="",a,d,g,h,j,p,n=0,c=c.replace(/\r\n/g,"\n");d="";for(g=0;g<c.length;g++)h=c.charCodeAt(g),128>h?d+=String.fromCharCode(h):(127<h&&2048>h?d+=String.fromCharCode(h>>6|192):(d+=String.fromCharCode(h>>12|224),d+=String.fromCharCode(h>>6&63|128)),d+=String.fromCharCode(h&63|128));for(c=d;n<c.length;)a=c.charCodeAt(n++),d=c.charCodeAt(n++),
g=c.charCodeAt(n++),h=a>>2,a=(a&3)<<4|d>>4,j=(d&15)<<2|g>>6,p=g&63,isNaN(d)?j=p=64:isNaN(g)&&(p=64),b=b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(j)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p);return b.toString()}})(global);
(function(d){d.Appacitive.ArticleCollection=function(e){var c=null,b=null,a=[],f=e;this.collectionType="article";if(!e||!e.schema)throw Error("Must provide schema while initializing ArticleCollection.");var c=e.schema,g=this,h=function(a){a.type="article";a.schema?c=a.schema:a.schema=c;b=new d.Appacitive.queries.BasicFilterQuery(a);f=a;g.extendOptions=b.extendOptions};this.setFilter=function(a){f.filter=a;f.type="article";b?b.filter=a:(b=new d.Appacitive.queries.BasicFilterQuery(f),g.extendOptions=
b.extendOptions)};this.setFreeText=function(a){!a&&0==a.trim().length&&(f.freeText="");f.freeText=a;f.type="article";b?b.freeText=a:(b=new d.Appacitive.queries.BasicFilterQuery(f),g.extendOptions=b.extendOptions)};this.reset=function(){c=f=null;a.length=0;b=null};this.__defineGetter__("query",function(){return b});this.getQuery=function(){return b};this.__defineSetter__("query",function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to articleCollection");a.length=0;b=c});this.setQuery=
function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to articleCollection");a.length=0;b=c};this.setOptions=h;h(e);this.get=function(b){if(b!=parseInt(b,10))return null;b=parseInt(b,10);return"number"!=typeof b||b>=a.length?null:a.slice(b,b+1)[0]};this.addToCollection=function(b){if(!b||b.get("__schematype")!=c)throw Error("Null article passed or schema type mismatch");var d=null;a.forEach(function(a,c){a.get("__id")==b.get("__id")&&(d=c)});0!=d?a.splice(d,1):a.push(b)};this.getArticle=
function(b,c,d){c=c||function(){};d=d||function(){};var f=a.filter(function(a){return a.get("__id")==b});1==f.length?c(Array.prototype.slice.call(f)[0]):d()};this.getAll=function(){return Array.prototype.slice.call(a)};this.getAllArticles=function(){return Array.prototype.slice.call(a).map(function(a){return a.getArticle()})};this.removeById=function(b){if(!b)return!1;var c=null;a.forEach(function(a,d){a.getArticle().__id&&a.getArticle().__id==b&&(c=d)});return null!==c?(a.splice(c,1),!0):!1};this.removeByCId=
function(b){if(!b)return!1;var c=null;a.forEach(function(a,d){a.__cid&&a.__cid==b&&(c=d)});return null!==c?(a.splice(c,1),!0):!1};this.fetch=function(c,f){c=c||function(){};f=f||function(){};a.length=0;var e=b.toRequest();e.onSuccess=function(b){var e=c,h=b.articles;if(h){if(!h.length||0===h.length)h=[];h.forEach(function(b){b=new d.Appacitive.Article(b,!0);b.___collection=g;a.push(b)});e(b.paginginfo||{})}else f(b.status)};d.Appacitive.http.send(e)};this.fetchByPageNumber=function(a,c,d){b.getOptions().pageQuery.pageNumber=
d;this.fetch(a,c)};this.fetchNextPage=function(a,c){b.getOptions().pageQuery.pageNumber+=1;this.fetch(a,c)};this.fetchPreviousPage=function(a,c){var d=b.getOptions().pageQuery;d.pageNumber-=1;0===d.pageNumber&&(d.pageNumber=1);this.fetch(a,c)};this.createNewArticle=function(b){b=b||{};b.__schematype=c;b=new d.Appacitive.Article(b);b.___collection=g;b.__cid=parseInt(1E6*Math.random(),10);a.push(b);return b};this.map=function(){return a.map.apply(this,arguments)};this.forEach=function(){return a.forEach.apply(this,
arguments)};this.filter=function(){return a.filter.apply(this,arguments)}};d.Appacitive.ArticleCollection.prototype.toString=function(){return JSON.stringify(this.getAllArticles())};d.Appacitive.ArticleCollection.prototype.toJSON=function(){return this.getAllArticles()};d.Appacitive.ArticleCollection.prototype.__defineGetter__("articles",function(){return this.getAll()})})(global);
(function(d){d.Appacitive.ConnectionCollection=function(e){var c=null,b=null,a=[],f=[],g=e;this.collectionType="connection";if(!e||!e.relation)throw Error("Must provide relation while initializing ConnectionCollection.");var c=e.relation,h=function(a){a.type="connection";a.relation?c=a.relation:a.relation=c;b=new d.Appacitive.queries.BasicFilterQuery(a);g=a};this.setFilter=function(a){g.filter=a;g.type="connection";b?b.filter=a:(b=new d.Appacitive.queries.BasicFilterQuery(g),j.extendOptions=b.extendOptions)};
this.setFreeText=function(a){!a&&0==a.trim().length&&(g.freeText="");g.freeText=a;g.type="connection";b?b.freeText=a:(b=new d.Appacitive.queries.BasicFilterQuery(g),j.extendOptions=b.extendOptions)};this.__defineGetter__("query",function(){return b});this.getQuery=function(){return b};this.__defineSetter__("query",function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to connectionCollection");f.length=0;a.length=0;b=c});this.setQuery=function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to connectionCollection");
f.length=0;a.length=0;b=c};this.reset=function(){c=g=null;f.length=0;a.length=0;b=null};this.setOptions=h;h(e);this.get=function(b){if(b!=parseInt(b,10))return null;b=parseInt(b,10);return"number"!=typeof b||b>=a.length?null:a.slice(b,b+1)[0]};this.addToCollection=function(b){if(!b||b.get("__relationtype")!=c)throw Error("Null connection passed or relation type mismatch");var d=null;a.forEach(function(a,c){a.get("__id")==b.get("__id")&&(d=c)});null!==d?a.splice(d,1):a.push(b)};this.getConnection=
function(b,c,d){c=c||function(){};d=d||function(){};var f=a.filter(function(a){return a.get("__id")==b});1==f.length?c(Array.prototype.slice.call(f)[0]):d()};this.getAll=function(){return Array.prototype.slice.call(a)};this.getAllConnections=function(){return Array.prototype.slice.call(a).map(function(a){return a.getConnection()})};this.removeById=function(b){if(!b)return!1;var c=null;a.forEach(function(a,d){a.getConnection().__id&&a.getConnection().__id==b&&(c=d)});return null!==c?(a.splice(c,1),
!0):!1};this.removeByCId=function(b){if(!b)return!1;var c=null;a.forEach(function(a,d){a.__cid&&a.__cid==b&&(c=d)});return null!==c?(a.splice(c,1),!0):!1};var j=this;this.getConnectedArticle=function(a){if(!f||0===f.length)return null;var b=f.filter(function(b){return b.get("__id")==a});return 0<b.length?b[0]:null};this.fetch=function(c,e){c=c||function(){};e=e||function(){};a.length=0;var g=b.toRequest();g.onSuccess=function(b){a:{var g=c;b=b||{};var h=b.connections;if(!h)if(b.status&&b.status.code&&
"200"==b.status.code)h=[];else{e(b.status);break a}if(!h.length||0===h.length)h=[];h.forEach(function(b){var c=new d.Appacitive.Connection(b,!0);c.___collection=j;a.push(c);if(b.__endpointa.article||b.__endpointb.article)b=new d.Appacitive.Article(b.__endpointa.article||b.__endpointb.article),b.___collection=j,f.push(b)});g(b.paginginfo||{})}};d.Appacitive.http.send(g)};this.createNewConnection=function(b){b=b||{};b.__relationtype=c;b=new d.Appacitive.Connection(b);b.___collection=j;b.__cid=parseInt(1E6*
Math.random(),10);a.push(b);return b};this.map=function(){return a.map.apply(this,arguments)};this.forEach=function(b,c){return a.forEach(b,c||this)};this.filter=function(){return a.filter.apply(this,arguments)}}})(global);
(function(d){var e=function(c,b){var a=new d.Appacitive.HttpRequest;a.method="get";a.url=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory.user.getGetAllLinkedAccountsUrl(this.get("__id"));a.onSuccess=function(a){var d=null;a&&(a.identities&&0<a.identities.length)&&(a=a.identities.filter(function(a){return"facebook"==a.authtype.toLowerCase()}),1==a.length&&(d=a[0].username));null!==d?FB.api("/"+d,function(a){a?c(a):b()}):b()};a.onError=function(){b()};d.Appacitive.http.send(a)};d.Appacitive.Article=
function(c,b){if(!c.__schematype&&!c.schema)throw new error("Cannot set article without __schematype");c.schema&&(c.__schematype=c.schema,delete c.schema);var a=new d.Appacitive.BaseObject(c,b);a.type="article";a.connectionCollections=[];a.getArticle=a.getObject;a.get("__schematype")&&"user"==a.get("__schematype").toLowerCase()&&(a.getFacebookProfile=e);return a};d.Appacitive.BaseObject.prototype.getConnectedArticles=function(c){if("article"!=this.type)return null;c=c||{};c.articleId=this.get("__id");
var b=new d.Appacitive.ConnectionCollection({relation:c.relation});b.connectedArticle=this;this.connectionCollections.push(b);c=new d.Appacitive.queries.ConnectedArticlesQuery(c);b.query=c;return b};d.Appacitive.Article.multiDelete=function(c,b,a,f){if(!c)throw Error("Specify schemaname");if(0<b.length){var e=new d.Appacitive.HttpRequest;e.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.article.getMultideleteUrl(c);e.method="post";e.data={idlist:b};e.onSuccess=function(b){b&&"200"==
b.code?a():(b=b||{},f(b||{message:"Server error",code:400}))};e.onError=function(a){a=a||{};f(a||{message:"Server error",code:400})};d.Appacitive.http.send(e)}else a()}})(global);
(function(d){var e=function(c,b,a){var d={label:c.label};if(c.articleid)d.articleid=c.articleid;else if(c.article&&"function"==typeof c.article.getArticle)c.article.get("__id")?d.articleid=c.article.get("__id"):d.article=c.article.getArticle(),a["endpoint"+b]=c;else if("object"==typeof c.article&&c.article.__schematype)c.article.__id?d.articleid=c.article.__id:d.article=c.article;else throw Error("Incorrectly configured endpoints provided to setupConnection");return d};d.Appacitive.Connection=function(c,
b){c.endpoints&&2==c.endpoints.length&&(c.__endpointa=c.endpoints[0],c.__endpointb=c.endpoints[1],delete c.endpoints);if(!c.__endpointa||!c.__endpointb)throw Error("Provide both endpoints.");var a=new d.Appacitive.BaseObject(c);a.type="connection";a.getConnection=a.getObject;a.setupConnection=function(b,c){if(!b||!b.articleid&&!b.article||!b.label||!c||!c.articleid&&!c.article||!c.label)throw Error("Incorrect endpoints configuration passed.");a.set("__endpointa",e(b,"A",a));a.set("__endpointb",e(c,
"B",a))};a.__defineGetter__("endpoints",function(){var a=[];a.push(this.endpointA);a.push(this.endpointB);return a});a.parseConnection=function(){var b="A",e="B";c.__endpointa.articleid==this.get("__endpointa").articleid&&(b="B",e="A");"object"==typeof this.get("__endpointa").article?(this.endpointa?this["endpoint"+b].copy(this.get("__endpointb").getArticle()):this["endpoint"+b]=new d.Appacitive.Article(this.get("__endpointa").article),this["endpoint"+b].___collection=this.___collection):this["endpoint"+
b]=this.get("__endpointa");"object"==typeof this.get("__endpointb").article?(this.endpointb?this["endpoint"+e].copy(this.get("__endpointb").getArticle()):this["endpoint"+e]=new d.Appacitive.Article(this.get("__endpointb").article),this["endpoint"+e].___collection=this.___collection):this["endpoint"+e]=this.get("__endpointb");return a};b?a.__defineGetter__("connectedArticle",function(){if(!a.___collection.connectedArticle)throw Error("connectedArticle can be accessed only by using the getConnectedArticles call");
var b=a.___collection.connectedArticle.get("__id");if(!b)return null;var c=a.getConnection().__endpointa.articleid;a.getConnection().__endpointa.articleid==b&&(c=a.getConnection().__endpointb.articleid);return a.___collection.getConnectedArticle(c)}):a.setupConnection(a.get("__endpointa"),a.get("__endpointb"));return a};d.Appacitive.Connection.multiDelete=function(c,b,a,f){if(!c)throw Error("Specify relationName");if(0<b.length){var e=new d.Appacitive.HttpRequest;e.url=d.Appacitive.config.apiBaseUrl+
Appacitive.storage.urlFactory.connection.getMultideleteUrl(c);e.method="post";e.data={idlist:b};e.onSuccess=function(b){b&&"200"==b.code?a():(b=b||{},f(b||{message:"Server error",code:400}))};e.onError=function(a){a=a||{};f(a||{message:"Server error",code:400})};d.Appacitive.http.send(e)}else a()}})(global);
(function(d){d.Appacitive.Users=new function(){var e=null;this.__defineGetter__("currentUser",function(){return e});this.setCurrentUser=function(c,b,a){d.Appacitive.localStorage.set("Appacitive-User",c);-1==a?a=null:a||(a=3600);e=c;b&&Appacitive.session.setUserAuthHeader(b,a)};d.Appacitive.User=function(c){c=new d.Appacitive.BaseObject(c);c.type="user";c.connectionCollections=[];c.get("__schematype")&&"user"==c.get("__schematype").toLowerCase()&&(c.getFacebookProfile=_getFacebookProfile);return c};
this.deleteUser=function(c,b,a){b=b||function(){};a=a||function(){};var e=new d.Appacitive.HttpRequest;e.method="delete";e.url=d.Appacitive.config.apiBaseUrl;e.url+=d.Appacitive.storage.urlFactory.user.getDeleteUrl(c);e.onSuccess=function(c){c&&c.code&&"200"==c.code?b(c):(c=c||{},c.message=c.message||"Server error",a(c))};e.onError=a;d.Appacitive.http.send(e)};this.deleteCurrentUser=function(c,b){c=c||function(){};if(null===e)throw Error("Current user is not set yet for delete operation");this.deleteUser(e.__id,
function(a){d.Appacitive.session.removeUserAuthHeader();c(a)},b||function(){})};this.createUser=this.signup=function(c,b,a){b=b||function(){};a=a||function(){};c=c||{};c.__schematype="user";if(!c.username||!c.password||!c.firstname||0==c.username.length||0==c.password.length||0==c.firstname.length)throw Error("Username, password and firstname are mandatory");var e=new d.Appacitive.HttpRequest;e.method="put";e.url=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory.user.getCreateUrl();e.data=
c;e.onSuccess=function(c){c&&c.user?b(c.user):a((c||{}).status||"No response from APIs.")};e.onError=a;d.Appacitive.http.send(e)};this.authenticateUser=function(c,b,a){b=b||function(){};a=a||function(){};var f=this,g=new d.Appacitive.HttpRequest;g.method="post";g.url=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory.user.getAuthenticateUserUrl();g.data=c;g.onSuccess=function(d){d&&d.user?(e=d.user,f.setCurrentUser(d.user,d.token,c.expiry),b(d)):(d=d||{},a(d.status))};g.onError=a;d.Appacitive.http.send(g)};
this.authenticateWithFacebook=this.signupWithFacebook=function(c,b){c=c||function(){};b=b||function(){};var a=this;FB.api("/me",function(){var f={accesstoken:d.Appacitive.facebook.accessToken,type:"facebook",expiry:3600,attempts:-1,createnew:!0},g=new d.Appacitive.HttpRequest;g.url=d.Appacitive.config.apiBaseUrl+d.Appacitive.storage.urlFactory.user.getAuthenticateUserUrl();g.method="post";g.data=f;g.onSuccess=function(d){d.user?(d.user.__authType="FB",e=d.user,a.setCurrentUser(d.user,d.token,3600),
c(d)):b(d)};g.onError=function(){b()};d.Appacitive.http.send(g)})};this.logout=function(c){c=c||function(){};this.currentUser?d.Appacitive.session.removeUserAuthHeader(c):c()}}})(global);
(function(d){d.Appacitive.email=new function(){var e={smtp:{username:null,password:null,host:"smtp.gmail.com",port:465,enablessl:!0},from:null,replyto:null};this.getConfig=function(){return e};var c=function(b,a,c){var e=new d.Appacitive.HttpRequest;e.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.email.getSendEmailUrl();e.method="post";e.data=b;e.onSuccess=function(b){b&&b.status&&"200"==b.status.code?a(b.email):(b=b||{},b.status=b.status||{},c(b.status.message||"Server error"))};
d.Appacitive.http.send(e)};this.setupEmail=function(b){b=b||{};e.smtp.username=b.username||e.smtp.username;e.from=b.from||e.from;e.smtp.password=b.password||e.smtp.password;e.smtp.host=b.smtp.host||e.smtp.host;e.smtp.port=b.smtp.port||e.smtp.port;e.smtp.enablessl=b.enableSSL||e.smtp.enablessl;e.replyto=b.replyTo||e.replyto};this.sendTemplatedEmail=function(b,a,d){a=a||function(){};d=d||function(){};if(!b||!b.to||!b.to.length||0==b.to.length)throw Error("Atleast one receipient is mandatory to send an email");
if(!b.subject||0==b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");if(!b.templateName)throw Error("template name is mandatory to send an email");var g={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,body:{templatename:b.templateName||"",data:b.data||{},ishtml:!1==b.isHtml?!1:!0}};if(b.useConfig){g.smtp=e.smtp;if(!b.from&&!e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");
g.from=b.from||e.from;g.replyto=b.replyTo||e.replyto}c(g,a,d)};this.sendRawEmail=function(b,a,d){a=a||function(){};d=d||function(){};if(!b||!b.to||!b.to.length||0==b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0==b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.body)throw Error("body is mandatory to send an email");var g={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,body:{content:b.body||"",ishtml:!1==b.isHtml?
!1:!0}};if(b.useConfig){g.smtp=e.smtp;if(!b.from&&!e.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");g.from=b.from||e.from;g.replyto=b.replyTo||e.replyto}c(g,a,d)}}})(global);
(function(d){var e=function(){var c=require("facebook-node-sdk"),b=null;this.FB=null;this.initialize=function(a,b){if(!a)throw Error("Please provide appid");if(!b)throw Error("Please provide app secret");this.FB=new c({appId:a,secret:b})};this.requestLogin=function(a,c,d){this.FB?(b=accesstoken,FB.setAccessToken(a)):d("Intialize facebook with your appid and appsecret")};this.getCurrentUserInfo=function(a,c){this.FB&&b?(a=a||function(){},c=c||function(){},this.FB.api("/me",function(b,d){d?a(d):c("Access token is invalid")})):
c("Either intialize facebook with your appid and appsecret or set accesstoken")};this.__defineGetter__("accessToken",function(){return b});this.__defineSetter__("accessToken",function(a){console.log(a);b=a;this.FB&&this.FB.setAccessToken(a)});this.getProfilePictureUrl=function(a){return"https://graph.facebook.com/"+a+"/picture"}};d.Appacitive.facebook=d.Appacitive.runtime.isBrowser?new function(){var c=null;this.requestLogin=function(b,a){b=b||function(){};a=a||function(){};FB?FB.login(function(d){d.authResponse?
(c=d.authResponse.accessToken,b(d.authResponse)):a()},{scope:"email,user_birthday"}):a()};this.getCurrentUserInfo=function(b,a){b=b||function(){};a=a||function(){};FB.api("/me",function(c){c?b(c):a()})};this.__defineGetter__("accessToken",function(){return c});this.__defineSetter__("accessToken",function(b){c=b});this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=function(b,a){b=b||function(){};a=a||function(){};Appacitive.facebook.accessToken="";try{FB.logout(function(){b()})}catch(c){a(c.message)}}}:
new e})(global);
(function(d){d.Appacitive.push=new function(){this.send=function(e,c,b){c=c||function(){};b=b||function(){};if(!e)throw Error("Please specify push options");var a=new d.Appacitive.HttpRequest;a.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getPushUrl();a.method="post";a.data=e;a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?c(a.id):(a=a||{},a.status=a.status||{},b(a.status.message||"Server error"))};a.onError=function(a){b(a||"Server error")};d.Appacitive.http.send(a)};this.getNotification=
function(e,c,b){c=c||function(){};b=b||function(){};if(!e)throw Error("Please specify notification id");var a=new d.Appacitive.HttpRequest;a.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getGetNotificationUrl(e);a.method="get";a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?c(a.pushnotification):(a=a||{},a.status=a.status||{},b(a.status.message||"Server error"))};a.onError=function(a){b(a||"Server error")};d.Appacitive.http.send(a)};this.getAllNotifications=function(e,
c,b){c=c||function(){};b=b||function(){};e?(e.pnum=e.pnum||1,e.psize=e.psize||20):e={pnum:1,psize:20};var a=new d.Appacitive.HttpRequest;a.url=d.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.push.getGetAllNotificationsUrl(e);a.method="get";a.onSuccess=function(a){a&&a.status&&"200"==a.status.code?c(a.pushnotifications,a.paginginfo):(a=a||{},a.status=a.status||{},b(a.status.message||"Server error"))};a.onError=function(a){b(a||"Server error")};d.Appacitive.http.send(a)}}})(global);
(function(d){d.Appacitive.parseISODate=function(d){try{var c=new Date(d);if(isNaN(c)){if(/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$/.exec(d)){var b=d.split("T"),a=b[0].split("-"),f=b[1].split("Z")[0].split(":"),g=f[2].split("."),h=Number(f[0]),c=new Date;c.setUTCFullYear(Number(a[0]));c.setUTCMonth(Number(a[1])-1);c.setUTCDate(Number(a[2]));c.setUTCHours(Number(h));c.setUTCMinutes(Number(f[1]));c.setUTCSeconds(Number(g[0]));g[1]&&c.setUTCMilliseconds(Number(g[1]));
return c}return null}return c}catch(j){return null}};d.Appacitive.toISOString=function(d){try{return d=d.toISOString(),d.indexOf("Z"),d=replace("Z","0000Z")}catch(c){return null}}})(global);
(function(d){d.Appacitive.localStorage=new function(){var d=window.localStorage||{};this.set=function(c,b){b=b||"";if(!c)return!1;if("object"==typeof b)try{b=JSON.stringify(b)}catch(a){}d[c]=b;return!0};this.get=function(c){if(!c)return null;c=d.getItem(c);if(!c)return null;if("{"==c[0])try{c=JSON.parse(c)}catch(b){}return c};this.remove=function(c){if(c)try{delete d[c]}catch(b){}}}})(global);
(function(d){d.Appacitive.runtime.isBrowser&&(d.Appacitive.Cookie=new function(){this.setCookie=function(d,c,b){if(b){var a=new Date;a.setTime(a.getTime()+6E4*b);b="; expires="+a.toGMTString()}else b="";document.cookie=d+"="+c+b+"; path=/"};this.readCookie=function(d){d+="=";for(var c=document.cookie.split(";"),b=0;b<c.length;b++){for(var a=c[b];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(d))return a.substring(d.length,a.length)}return null};this.eraseCookie=function(d){this.setCookie(d,
"",-1)}})})(global);"undefined"!=typeof module&&(module.exports=function(d){global.Appacitive.initialize({apikey:d});return global.Appacitive});