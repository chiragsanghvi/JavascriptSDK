try{!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return!0}}).x&&(Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:!1,configurable:!0,value:function(e,f){Object.defineProperty(this,e,{get:f,enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:!1,configurable:!0,value:function(e,f){Object.defineProperty(this,e,{set:f,enumerable:!0,configurable:!0})}}))}catch(defPropException){}var global={};
(function(){global="undefined"==typeof window?process:window;global.Appacitive||(global.Appacitive={runtime:{isNode:"undefined"!=typeof process,isBrowser:"undefined"!=typeof window}});var e=function(a){if(!a||!a.send||"function"!=typeof a.send)throw Error("No applicable httpTransport class found");a.onResponse=this.onResponse;var c=[],b={},d=0,e={},f=0;this.addProcessor=function(a){if(a){a.pre=a.pre||function(){};a.post=a.post||function(){};var c=a.pre;d+=1;b[d]=c;a=a.post;f+=1;e[f]=a}};this.enqueueRequest=
function(a){c.push(a)};this.notify=function(){if(0!==c.length){var d=[],k;for(k in e)e.hasOwnProperty(k)&&d.push(e[k]);for(;0<c.length;){var f=c.shift(),l=[];for(k in b)b.hasOwnProperty(k)&&l.push(b[k](f));a.send(f,d,l)}}};this.onResponse=function(a){console.dir(a)}},f=function(){var a=function(){throw Error("Not Implemented Exception");};this.inOnline=this.send=a;this.onResponse=function(){a()};this.onError=function(){a()}},d=null,d=global.Appacitive.runtime.isBrowser?XMLHttpRequest:require("xmlhttprequest").XMLHttpRequest,
b=function(a,c){if("undefined"!==typeof XDomainRequest)throw Error("Appacitive doesn't support versions of IE6, IE7, IE8, IE9 due to crossdomain calls");if(!a.url)throw Error("Please specify request url");a.method||(a.method="GET");a.headers||(a.headers=[]);var b={};if(c)b=a.data;else try{a.data&&(b=a.data),b=JSON.stringify(b)}catch(e){}if(!a.onSuccess||"function"!=typeof a.onSuccess)a.onSuccess=function(){};if(!a.onError||"function"!=typeof a.onError)a.onError=function(){};var f=new d;f.onreadystatechange=
function(){if(4==this.readyState)if(200<=this.status&&300>this.status||304==this.status){var c=this.responseText;try{var b=this.getResponseHeader("content-type")||this.getResponseHeader("Content-Type");if("application/json"==b.toLowerCase()||"application/javascript"==b.toLowerCase())b=c,global.Appacitive.runtime.isBrowser||"{"!=b[0]&&(b=b.substr(1,b.length-1)),c=JSON.parse(b)}catch(d){}a.onSuccess(c,this)}else a.onError({code:this.status,message:this.statusText},this)};f.open(a.method,a.url,!0);for(var l=
0;l<a.headers.length;l+=1)f.setRequestHeader(a.headers[l].key,a.headers[l].value);global.Appacitive.runtime.isBrowser||f.setRequestHeader("User-Agent","Appacitive-NodeJSSDK");f.send(b);return f},a=function(){var a=new f;a.isOnline=function(){return!0};var c=function(c,d,e,h){h||c.headers.push({key:"content-type",value:"application/json"});new b({method:c.method,url:c.url,headers:c.headers,data:c.data,onSuccess:function(b){try{b=JSON.parse(b)}catch(h){}var f=b;if(d.length!=e.length)throw Error("Callback length and state length mismatch!");
for(var l=0;l<d.length;l+=1)d[l].apply({},[f,e[l]]);a.onResponse(b,c)},onError:function(b){a.onError(c,b)}})};a.send=function(a,b,g){"function"==typeof a.beforeSend&&a.beforeSend(a);c(a,b,g)};a.upload=function(a,b,g){"function"==typeof a.beforeSend&&a.beforeSend(a);c(a,b,g,!0)};return a};global.Appacitive.http=new function(){var c=new a,b=new e(c),d=!1;this.pause=function(){d=!0};this.unpause=function(){d=!1};this.addProcessor=function(a){var c=Error('Must provide a processor object with either a "pre" function or a "post" function.');
if(!a)throw c;if(!a.pre&&!a.post)throw c;b.addProcessor(a)};this.send=function(a){b.enqueueRequest(a);c.isOnline()&&!1==d&&b.notify()};this.flush=function(a){a?b.notify():c.isOnline()&&b.notify()};this.onError=function(a,c){if(a.onError)if(a.context)a.onError.apply(a.context,[c]);else a.onError(c)};c.onError=this.onError;this.onResponse=function(a,c){if(c.onSuccess)if(c.context)c.onSuccess.apply(c.context,[a]);else c.onSuccess(a)};c.onResponse=this.onResponse};global.Appacitive.HttpRequest=function(a){a=
a||{};this.url=a.url||"";this.data=a.data||{};this.headers=a.headers||[];this.method=a.method||"GET";this.onSuccess=a.onSuccess||function(){};this.onError=a.onError||function(){};this.send=function(a){return new b(this,a)}};var c=global;c.Appacitive&&c.Appacitive.http&&(c.Appacitive.http.addProcessor({pre:function(a){return a},post:function(a,b){try{c.Appacitive.Session.isSessionValid(a)?a&&(a.status&&a.status.code&&"8036"==a.status.code||a.code&&"8036"==a.code)?c.Appacitive.Users.logout(function(){},
!0):c.Appacitive.Session.incrementExpiry():(null!=c.Appacitive.Session.get()&&c.Appacitive.Session.resetSession(),c.Appacitive.http.send(b))}catch(d){}}}),c.Appacitive.http.addProcessor({pre:function(){return(new Date).getTime()},post:function(a,c){var b=(new Date).getTime()-c;a._timeTakenInMilliseconds=b}}))})();
(function(e){String.format=function(e,d){if(1>=arguments.length)return e;for(var b=arguments.length-2,a=0;a<=b;a++)e=e.replace(RegExp("\\{"+a+"\\}","gi"),arguments[a+1]);return e};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(e){var d=RegExp("^"+e),b=this;d.test(b)&&(b=b.slice(1,b.length));d=RegExp(e+"$");d.test(b)&&(b=b.slice(0,-1));return b};String.toSearchString=function(e){"undefined"==typeof e&&(e="");for(var d=
"",b=0;b<e.length;b+=1)-1==" .,;#".indexOf(e[b])&&(d+=e[b]);return d=d.toLowerCase()};String.contains=function(e,d){return-1!=e.indexOf(d)};String.startsWith=function(e,d){return 0==e.indexOf(d)};Array.distinct=function(e){var d=[],b=e.length,a,c,g;for(c=0;c<b;c++){a=void 0;for(g=0;g<d.length;g++)if(e[c].toLowerCase()===d[g].toLowerCase()){a=!0;break}a||d.push(e[c])}return d};e.dateFromWcf=function(e,d){var b=/Date\(([^)]+)\)/.exec(e);if(2!=b.length){if(!d)return s;throw Error(s+" is not .net json date.");
}return new Date(parseFloat(b[1]))};e.Appacitive.storage=e.Appacitive.storage||{};e.Appacitive.storage.urlFactory=new function(){e.Appacitive.bag=e.Appacitive.bag||{};var f=function(d){if("object"==typeof d&&0<d.length&&("string"==typeof d[0]||"number"==typeof d[0]))d=d.join(",");d||(d="");return d};this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(d){return String.format("{0}/create?fields={1}",
this.userServiceUrl,f(d))},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getGetUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.userServiceUrl,d,f(b))},getUpdateUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.userServiceUrl,d,f(b))},getDeleteUrl:function(d){return String.format("{0}/{1}",this.userServiceUrl,d)},getGetAllLinkedAccountsUrl:function(d){return String.format("{0}/{1}/linkedaccounts",this.userServiceUrl,
d)},getValidateTokenUrl:function(d){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,d)},getInvalidateTokenUrl:function(d){return String.format("{0}/invalidate?userToken={1}",this.userServiceUrl,d)},getSendResetPasswordEmailUrl:function(){return String.format("{0}/sendresetpasswordemail",this.userServiceUrl)},getUpdatePasswordUrl:function(d){return String.format("{0}/{1}/changepassword",this.userServiceUrl,d)},getLinkAccountUrl:function(d){return String.format("{0}/{1}/link",
this.userServiceUrl,d)},getDelinkAccountUrl:function(d,b){return String.format("{0}/{1}/{2}/delink",this.userServiceUrl,d,b)}};this.device={deviceServiceUrl:"device",getCreateUrl:function(d){return String.format("{0}/register?fields={1}",this.deviceServiceUrl,f(d))},getGetUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,d,f(b))},getUpdateUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,d,f(b))},getDeleteUrl:function(d){return String.format("{0}/{1}",
this.deviceServiceUrl,d)}};this.article={articleServiceUrl:"article",getSearchAllUrl:function(d,b,a){var c="",c=String.format("{0}/search/{1}/all",this.articleServiceUrl,d),c=a?c+"?psize="+a:c+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(d=0;d<b.length;d+=1)0!=b[d].trim().length&&(c=c+"&"+b[d]);return c},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.articleServiceUrl)},getPropertiesSearchUrl:function(d,b){return String.format("{0}/search/{1}/all?properties={2}",
this.articleServiceUrl,d,b)},getMultiGetUrl:function(d,b,a){return String.format("{0}/{1}/multiGet/{2}?fields={3}",this.articleServiceUrl,d,b,f(a))},getCreateUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.articleServiceUrl,d,f(b))},getGetUrl:function(d,b,a){return String.format("{0}/{1}/{2}?fields={3}",this.articleServiceUrl,d,b,f(a))},getUpdateUrl:function(d,b,a){return String.format("{0}/{1}/{2}?fields={3}",this.articleServiceUrl,d,b,f(a))},getDeleteUrl:function(d,b){return String.format("{0}/{1}/{2}",
this.articleServiceUrl,d,b)},getMultiDeleteUrl:function(d){return String.format("{0}/{1}/bulkdelete",this.articleServiceUrl,d)}};this.connection={connectionServiceUrl:"connection",getGetUrl:function(d,b,a){return String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,d,b,f(a))},getMultiGetUrl:function(d,b,a){return String.format("{0}/{1}/multiGet/{2}?fields={3}",this.connectionServiceUrl,d,b,f(a))},getCreateUrl:function(d,b){return String.format("{0}/{1}?fields={2}",this.connectionServiceUrl,
d,f(b))},getUpdateUrl:function(d,b,a){return String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,d,b,f(a))},getDeleteUrl:function(d,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,d,b)},getMultiDeleteUrl:function(d){return String.format("{0}/{1}/bulkdelete",this.connectionServiceUrl,d)},getSearchByArticleUrl:function(d,b,a,c){var g="",g=String.format("{0}/{1}/find/all?label={2}&articleid={3}",this.connectionServiceUrl,d,a,b);if("undefined"!==typeof c&&0<c.length)for(d=
0;d<c.length;d+=1)g=g+"&"+c[d];return g},getConnectedArticles:function(d,b,a){var c="",c=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,d,b);if(a&&a.length&&0<a.length)for(d=0;d<a.length;d+=1)c=0==d?c+("?"+a[d]):c+("&"+a[d]);return c},getInterconnectsUrl:function(){return String.format("{0}/interconnects",this.connectionServiceUrl)},getPropertiesSearchUrl:function(d,b){return String.format("{0}/{1}/find/all?properties=",this.connectionServiceUrl,d,b)}};this.cannedList={cannedListServiceUrl:"list",
getGetListItemsUrl:function(d){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,d)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",this.pushServiceUrl)},getGetNotificationUrl:function(d){return String.format("{0}/notification/{1}",this.pushServiceUrl,d)},getGetAllNotificationsUrl:function(d){return String.format("{0}/getAll?psize={1}&pnum={2}",this.pushServiceUrl,d.psize,d.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(d){return String.format("{0}/uploadurl?contenttype={1}&expires=20",
this.fileServiceUrl,escape(d))},getUpdateUrl:function(d,b){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",this.fileServiceUrl,d,escape(b))},getDownloadUrl:function(d,b){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,d,b)},getDeleteUrl:function(d){return String.format("{0}/delete/{1}",this.fileServiceUrl,d)}};this.query={params:function(d){var b=[];return""==location.search||-1==location.search.indexOf("?")?b:d?(d=d.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(a,
c){var g=c.split("="),e=g[1];2<g.length&&g.forEach(function(a){0==a||1==a||(e=e+"="+g[a])});g[0].toLowerCase()==d&&(b=[g[0],e])}),b):location.search.split("?")[1].split("=")}}}})(global);
(function(e){e.Appacitive.eventManager=new function(){var e={};this.subscribe=function(d,b){if("string"!=typeof d||"function"!=typeof b)throw Error("Incorrect subscription call");"undefined"==typeof e[d]&&(e[d]=[]);var a;a=function(){return Math.floor(65536*Math.random()).toString(16)};a=a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a();e[d].push({callback:b,id:a});return a};this.unsubscribe=function(d){if(!d)return!1;var b=-1,a=null,c;for(c in e)for(var g=0;g<e[c].length;g+=1)if(e[c][g].id==d){b=g;
a=c;break}return-1!=b?(e[a].splice(b,1),!0):!1};this.fire=function(d,b,a){if("string"!=typeof d)throw Error("Incorrect fire call");if("undefined"==typeof a||null===a)a={};a.eventName=d;if("undefined"!=typeof e.all)for(var c=0;c<e.all.length;c+=1)e.all[c].callback(b,a);c=function(a,c,b){setTimeout(function(){a(c,b)},0)};if("undefined"!=typeof e[d])for(var g=0;g<e[d].length;g+=1)c(e[d][g].callback,b,a)};this.clearSubscriptions=function(d){if("string"!=typeof d)throw Error("Event Name must be string in EventManager.clearSubscriptions");
e[d]&&(e[d].length=0);return this};this.clearAndSubscribe=function(e,b){this.clearSubscriptions(e);this.subscribe(e,b)};this.dump=function(){console.dir(e)}}})(global);(function(e){e.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/"}})(global);
(function(e){e.Appacitive.Session=new function(){var f=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},d=null,b=null,a=null,c=null,g=!1;this.useApiKey=!0;this.onSessionCreated=function(){};this.recreate=function(){e.Appacitive.Session.create(b)};this.create=function(c){b=c=c||{};var g=new f;c.apikey?(g.apikey=c.apikey||"",a=g.apikey):g.apikey=a;g.isnonsliding=c.isnonsliding||g.isnonsliding;g.usagecount=c.usagecount||g.usagecount;g.windowtime=c.windowtime||g.windowtime;
c=new e.Appacitive.HttpRequest;c.url=e.Appacitive.config.apiBaseUrl+"application.svc/session";c.method="put";c.data=g;c.onSuccess=function(a){a&&a.status&&"200"==a.status.code?(d=a.session.sessionkey,e.Appacitive.Session.useApiKey=!1,e.Appacitive.eventManager.fire("session.success",{},a),e.Appacitive.Session.onSessionCreated()):e.Appacitive.eventManager.fire("session.error",{},a)};e.Appacitive.http.send(c)};e.Appacitive.http.addProcessor({pre:function(b){e.Appacitive.Session.useApiKey?b.headers.push({key:"appacitive-apikey",
value:a}):b.headers.push({key:"appacitive-session",value:d});!0===g&&(1==b.headers.filter(function(a){return"appacitive-user-auth"==a.key}).length?b.headers.forEach(function(a){"appacitive-user-auth"==a.key&&(a.value=c)}):b.headers.push({key:"appacitive-user-auth",value:c}))}});this.setUserAuthHeader=function(a,b,d){try{a&&(g=!0,c=a,d||(b||(b=60),-1==b&&(b=null),e.Appacitive.runtime.isBrowser&&(e.Appacitive.Cookie.setCookie("Appacitive-UserToken",a,b),e.Appacitive.Cookie.setCookie("Appacitive-UserTokenExpiry",
b?b:-1,b))))}catch(h){}};this.incrementExpiry=function(){};this.removeUserAuthHeader=function(a,b){a&&("function"!=typeof a&&"boolean"==typeof a)&&(b=a,a=function(){});g=!1;a=a||function(){};e.Appacitive.localStorage.remove("Appacitive-User");e.Appacitive.runtime.isBrowser&&(e.Appacitive.Cookie.eraseCookie("Appacitive-UserToken"),e.Appacitive.Cookie.eraseCookie("Appacitive-UserTokenExpiry"));if(c&&!b)try{var d=new e.Appacitive.HttpRequest;d.url=e.Appacitive.config.apiBaseUrl+Appacitive.storage.urlFactory.user.getInvalidateTokenUrl(c);
c=null;d.method="POST";d.data={};d.onSuccess=function(){"function"==typeof a&&a()};e.Appacitive.http.send(d)}catch(h){}else c=null,"function"==typeof a&&a()};this.isSessionValid=function(a){if(!a)return!0;if(a.status){if(a.status.code&&("8027"==a.status.code||"8002"==a.status.code))return!1}else if(a.code&&("8027"==a.code||"8002"==a.code))return!1;return!0};this.resetSession=function(){d=null;this.useApiKey=!0};this.get=function(){return d};this.setSession=function(a){a&&(d=a,this.useApiKey=!1)};
this.setApiKey=function(c){c&&(a=c,this.useApiKey=!0)};var h="sandbox";this.__defineGetter__("environment",function(){return h});this.__defineSetter__("environment",function(a){"sandbox"!=a&&"live"!=a&&(a="sandbox");h=a})};e.Appacitive.initialize=function(f){e.Appacitive.Session.setApiKey(f.apikey||"");e.Appacitive.Session.environment=f.env||"";e.Appacitive.useApiKey=!0;if(f.userToken)-1==f.expiry?f.expiry=null:f.expiry||(f.expiry=3600),e.Appacitive.Session.setUserAuthHeader(f.userToken,f.expiry),
f.user?e.Appacitive.Users.setCurrentUser(f.user):(f=e.Appacitive.localStorage.get("Appacitive-User"))&&e.Appacitive.Users.setCurrentUser(f);else if(e.Appacitive.runtime.isBrowser){var d=e.Appacitive.Cookie.readCookie("Appacitive-UserToken");if(d){var b=e.Appacitive.Cookie.readCookie("Appacitive-UserTokenExpiry");b||(b=60);(f=e.Appacitive.localStorage.get("Appacitive-User"))&&e.Appacitive.Users.setCurrentUser(f,d,b)}}}})(global);
(function(e){e.Appacitive&&e.Appacitive.http&&e.Appacitive.http.addProcessor({pre:function(f){f.headers.push({key:"appacitive-environment",value:e.Appacitive.Session.environment})}})})(global);
(function(e){e.Appacitive.Queries={};var f=function(a){a=a||{};var c=1,b=200;this.__defineGetter__("pageNumber",function(){return c});this.__defineSetter__("pageNumber",function(a){c=a||1});this.__defineGetter__("pageSize",function(){return b});this.__defineSetter__("pageSize",function(a){b=a||200});this.pageNumber=a.pageNumber;this.pageSize=a.pageSize};f.prototype.toString=function(){return"psize="+this.pageSize+"&pnum="+this.pageNumber};var d=function(a){a=a||{};var c="__UtcLastUpdatedDate",b=!1;
this.__defineGetter__("orderBy",function(){return c});this.__defineSetter__("orderBy",function(a){c=a||"__UtcLastUpdatedDate"});this.__defineGetter__("isAscending",function(){return b});this.__defineSetter__("isAscending",function(a){b="undefined"==typeof a?!1:a});this.orderBy=a.orderBy;this.isAscending=a.isAscending};d.prototype.toString=function(){return"orderBy="+this.orderBy+"&isAsc="+this.isAscending};var b=function(a){var c=a||{},b="",h="",j="",k=a.queryType,m=new f(a),l=new d(a),p=a.schema||
a.relation,n=a.schema?"article":"connection";this.__defineGetter__("type",function(){return n});this.__defineGetter__("entityType",function(){return p});this.__defineGetter__("queryType",function(){return k});this.__defineGetter__("pageQuery",function(){return m});this.__defineGetter__("sortQuery",function(){return l});this.__defineGetter__("filter",function(){return b});this.__defineSetter__("filter",function(a){b=a});this.__defineGetter__("freeText",function(){return h});this.__defineSetter__("freeText",
function(a){"string"==typeof a?h=a:"object"==typeof a&&a.length&&(h=a.join(" "))});this.__defineGetter__("fields",function(){return j});this.__defineSetter__("fields",function(a){"string"==typeof a?j=a:"object"==typeof a&&a.length&&(j=a.join(","))});this.filter=c.filter||"";this.freeText=c.freeText||"";this.fields=c.fields||"";this.setFilter=function(a){this.filter=a};this.setFreeText=function(a){this.freeText=a};this.setFields=function(a){this.fields=a};this.extendOptions=function(a){for(var b in a)c[b]=
a[b];m=new f(c);l=new d(c)};this.getQueryString=function(){var a=this.pageQuery.toString()+"&"+this.sortQuery.toString();this.filter&&0<this.filter.trim().length&&(a+="&query="+this.filter);this.freeText&&0<this.freeText.trim().length&&(a+="&freetext="+this.freeText+"&language=en");this.fields&&0<this.fields.trim().length&&(a+="&fields="+this.fields);return a};this.toUrl=function(){return e.Appacitive.config.apiBaseUrl+p+"/find/all?"+this.getQueryString()};this.toRequest=function(){var a=new e.Appacitive.HttpRequest;
a.url=this.toUrl();a.method="get";return a};this.getOptions=function(){var a={},c;for(c in this)this.hasOwnProperty(c)&&"function"!=typeof this[c]&&(a[c]=this[c]);return a};this.fetch=function(a,c){var b=this.toRequest();b.onSuccess=function(b){if(b&&b.status&&"200"==b.status.code){if("function"==typeof a){var d=b[n+"s"],g=[];d||(d=[]);var h="article"==n?"Article":"Connection";d.forEach(function(a){g.push(new e.Appacitive[h](a))});a(g,b.paginginfo)}}else b=b||{},"function"==typeof c&&c(b.status||
{message:"Server error",code:400})};b.onError=function(a){a=a||{};"function"==typeof c&&c(a.status||{message:"Server error",code:400})};e.Appacitive.http.send(b);return this}};e.Appacitive.Queries.BasicFilterQuery=function(a){a=a||{};if(!a.schema&&!a.relation||a.schema&&a.relation)throw Error("Specify either schema or relation for basic filter query");a.queryType="BasicFilterQuery";a=new b(a);a.toRequest=function(){var a=new e.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};a.toUrl=
function(){return e.Appacitive.config.apiBaseUrl+this.type+".svc/"+this.entityType+"/find/all?"+this.getQueryString()};return a};e.Appacitive.Queries.ConnectedArticlesQuery=function(a){a=a||{};if(!a.relation)throw Error("Specify relation for connected articles query");if(!a.articleId)throw Error("Specify articleId for connected articles query");a.schema&&delete a.schema;a.queryType="ConnectedArticlesQuery";var c=new b(a);c.articleId=a.articleId;c.relation=a.relation;c.label="";a.label&&("string"==
typeof a.label&&0<a.label.length)&&(c.label="&label="+a.label);c.toRequest=function(){var a=new e.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};c.toUrl=function(){return e.Appacitive.config.apiBaseUrl+"connection/"+this.relation+"/"+this.articleId+"/find?"+this.getQueryString()+this.label};return c};e.Appacitive.Queries.GetConnectionsQuery=function(a){a=a||{};if(!a.relation)throw Error("Specify relation for GetConnectionsQuery query");if(!a.articleId)throw Error("Specify articleId for GetConnectionsQuery query");
if(!a.label||0==a.label.trim().length)throw Error("Specify label for GetConnectionsQuery query");a.schema&&delete a.schema;a.queryType="GetConnectionsQuery";var c=new b(a);c.articleId=a.articleId;c.relation=a.relation;c.label=a.label;c.toRequest=function(){var a=new e.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};c.toUrl=function(){return e.Appacitive.config.apiBaseUrl+"connection/"+c.relation+"/find/all?articleid="+this.articleId+"&label="+this.label+c.getQueryString()};return c};
e.Appacitive.Queries.GetConnectionsBetweenArticlesQuery=function(a,c){a=a||{};if(!a.articleAId||"string"!=typeof a.articleAId||0==a.articleAId.length)throw Error("Specify valid articleAId for GetConnectionsBetweenArticlesQuery query");if(!a.articleBId||"string"!=typeof a.articleBId||0==a.articleBId.length)throw Error("Specify articleBId for GetConnectionsBetweenArticlesQuery query");a.schema&&delete a.schema;a.queryType=c||"GetConnectionsBetweenArticlesQuery";var d=new b(a);d.articleAId=a.articleAId;
d.articleBId=a.articleBId;d.label="GetConnectionsBetweenArticlesForRelationQuery"==d.queryType&&a.label&&"string"==typeof a.label&&0<a.label.length?"&label="+a.label:"";d.relation=a.relation&&"string"==typeof a.relation&&0<a.relation.length?a.relation+"/":"";d.toRequest=function(){var a=new e.Appacitive.HttpRequest;a.url=this.toUrl();a.method="get";return a};d.toUrl=function(){return e.Appacitive.config.apiBaseUrl+"connection/"+this.relation+"find/"+this.articleAId+"/"+this.articleBId+"?"+this.getQueryString()+
this.label};return d};e.Appacitive.Queries.GetConnectionsBetweenArticlesForRelationQuery=function(a){a=a||{};if(!a.relation)throw Error("Specify relation for GetConnectionsBetweenArticlesForRelationQuery query");a=new e.Appacitive.Queries.GetConnectionsBetweenArticlesQuery(a,"GetConnectionsBetweenArticlesForRelationQuery");a.fetch=function(a,b){this.toUrl();var d=this.toRequest();d.onSuccess=function(d){d&&d.status&&"200"==d.status.code?"function"==typeof a&&a(new e.Appacitive.Connection(d.connection)):
(d=d||{},"function"==typeof b&&b(d.status||{message:"Server error",code:400}))};d.onError=function(a){a=a||{};"function"==typeof b&&b(a.status||{message:"Server error",code:400})};e.Appacitive.http.send(d);return this};return a};e.Appacitive.Queries.InterconnectsQuery=function(a){a=a||{};if(!a.articleAId||"string"!=typeof a.articleAId||0==a.articleAId.length)throw Error("Specify valid articleAId for InterconnectsQuery query");if(!a.articleBIds||"object"!=typeof a.articleBIds||!(0<a.articleBIds.length))throw Error("Specify list of articleBIds for InterconnectsQuery query");
a.schema&&delete a.schema;a.queryType="InterconnectsQuery";var c=new b(a);c.articleAId=a.articleAId;c.articleBIds=a.articleBIds;c.toRequest=function(){var a=new e.Appacitive.HttpRequest;a.url=this.toUrl();a.method="post";a.data={article1id:this.articleAId,article2ids:this.articleBIds};return a};c.toUrl=function(){return e.Appacitive.config.apiBaseUrl+"connection/interconnects?"+this.getQueryString()};return c};e.Appacitive.Queries.GraphQuery=function(a){a=a||{};if(!a.graphQuery)throw Error("graphQuery object is mandatory");
this.toRequest=function(){var c=new e.Appacitive.HttpRequest;c.url=e.Appacitive.config.apiBaseUrl;c.url+=e.Appacitive.storage.urlFactory.article.getProjectionQueryUrl();c.method="post";c.data=a.graphQuery;return c}}})(global);
(function(e){e.Appacitive.BaseObject=function(f,d){var b={},a=function(a,c){for(var b in a)if("string"==typeof a[b])c[b]=a[b];else if("object"==typeof a[b]){c[b]=0<=a[b].length?[]:{};for(var d in a[b])c[b][d]=a[b][d]}else c[b]=a[b]},c={};a(f,c);d&&a(c,b);!b.__id&&c.__id&&(b.__id=c.__id);c.__schematype?(c.__schematype=c.__schematype.toLowerCase(),this.schema=this.entityType=c.__schematype,this.type="user"==c.__schematype||"device"==c.__schematype?c.__schematype:"article"):c.__relationtype&&(c.__relationtype=
c.__relationtype.toLowerCase(),this.relation=this.entityType=c.__relationtype,this.type="connection");var g=parseInt(1E6*Math.random(),10);this.__defineGetter__("cid",function(){return g});var h="__revision __endpointa __endpointb __createdby __lastmodifiedby __schematype __relationtype __utcdatecreated __utclastupdateddate __tags __authType __link".split(" "),j=["__link","__endpointa","__endpointb"],k=function(a){a=a||{};a.message=a.message||"Server error";a.code=a.code||"500";return a};this.getObject=
function(){return c};this.toJSON=function(){return c};this.__defineGetter__("id",function(){return this.get("__id")});this.__defineSetter__("id",function(a){this.set("__id",a)});c.__attributes||(c.__attributes={});b.__attributes||(b.__attributes={});this.attributes=function(){if(0===arguments.length)c.__attributes||(c.__attributes={});else{if(1==arguments.length)return c.__attributes||(c.__attributes={}),c.__attributes[arguments[0]];if(2==arguments.length){if("string"!==typeof arguments[1]&&null!=
arguments[1])throw Error("only string values can be stored in attributes.");c.__attributes||(c.__attributes={});c.__attributes[arguments[0]]=arguments[1]}else throw Error(".attributes() called with an incorrect number of arguments. 0, 1, 2 are supported.");}return c.__attributes};var m=function(){var a=!1,d=JSON.parse(JSON.stringify(b.__attributes)),e;for(e in c.__attributes)"undefined"==typeof c.__attributes[e]||null===c.__attributes[e]?(d[e]=null,a=!0):c.__attributes[e]!=b.__attributes[e]?(d[e]=
c.__attributes[e],a=!0):c.__attributes[e]==b.__attributes[e]&&delete d[e];return!a?null:d};this.getChangedAttributes=m;this.aggregates=function(){var a={},b;for(b in c){if(!c.hasOwnProperty(b))return;"$"==b[0]&&(a[b]=c[b])}if(0===arguments.length)return a;if(1==arguments.length)return a[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");};var l=[];c.__tags||(c.__tags=[]);b.__tags||(b.__tags=[]);this.__defineGetter__("tags",function(){return!c.__tags?
[]:c.__tags});this.addTag=function(a){if(!a||"string"!=typeof a||!a.length)return this;c.__tags.push(a);c.__tags=Array.distinct(c.__tags);if(!l||!l.length)return this;a=l.indexOf(a);-1!=a&&l.splice(a,1);return this};this.removeTag=function(a){if(!a||"string"!=typeof a||!a.length)return this;l.push(a);l=Array.distinct(l);if(!c.__tags||!c.__tags.length)return this;a=c.__tags.indexOf(a);-1!=a&&c.__tags.splice(a,1);return this};this.getChangedTags=function(){var a=[];c.__tags.every(function(c){-1==b.__tags.indexOf(c)&&
a.push(c)});return a};this.getRemovedTags=function(){return _removetags};var p=function(a){var d=!1,e=JSON.parse(JSON.stringify(b)),g;for(g in c)"undefined"==typeof c[g]||null===c[g]?(e[g]=null,d=!0):c[g]!=b[g]?"__tags"==g||"__attributes"==g?delete e[g]:(e[g]=c[g],d=!0):c[g]==b[g]&&delete e[g];try{h.forEach(function(a){e[a]&&delete e[a]})}catch(k){}a?(c.__tags&&0<c.__tags.length&&(e.__addtags=this.getChangedTags(),d=!0),l&&0<l.length&&(e.__removetags=l,d=!0)):c.__tags&&0<c.__tags.length&&(e.__tags=
this.getChangedTags(),d=!0);(a=m())?(e.__attributes=a,d=!0):delete e.__attributes;return d?e:!1};this.__defineGetter__("changed",function(){return p()});this.hasChanged=function(){var a=p(!0);return 0===arguments.length?a?!0:!1:1==arguments.length&&"string"==typeof arguments[0]&&0<arguments[0].length&&a&&a[arguments[0]]?!0:!1};this.changedAttributes=function(){var a=p(!0);if(0===arguments.length)return a;if(1==arguments.length&&"object"==typeof arguments[0]&&arguments[0].length){var c={};arguments[0].forEach(function(b){a[b]&&
c.push(a[b])});return c}return!1};this.previous=function(){return 1==arguments.length&&"string"==typeof arguments[0]&&arguments[0].length?b[arguments[0]]:null};this.previousAttributes=function(){return b};var n="";this.__defineGetter__("fields",function(){return n});this.__defineSetter__("fields",function(a){"string"==typeof a?n=a:"object"==typeof a&&a.length&&(n=a.join(","))});this.get=function(a){if(a)return c[a]};this.set=function(a,b){if(!a||"string"!=typeof a||0==a.length)return this;null==b||
"undefined"==b?c[a]=null:"string"==typeof b?c[a]=b:"number"==typeof b?c[a]=b+"":"object"==typeof b&&(0<=b.length?c[a]=b:-1!==j.indexOf(a)&&(c[a]=b));return this};this.unset=function(a){if(!a||"string"!=typeof a||0==a.length||0==a.indexOf("__"))return this;try{delete c[a]}catch(b){}return this};this.has=function(a){return!a||"string"!=typeof a||0==a.length?!1:c[a]&&"undefined"!=typeof c[a]?!0:!1};this.isNew=function(){return c.__id&&c.__id.length?!1:!0};this.clone=function(){return"article"==this.type?
new Appacitive.Article(c):new Appacitive.connection(c)};this.copy=function(b){b&&a(b,c);return this};this.save=function(a,b){c.__id?r.apply(this,arguments):q.apply(this,arguments);return this};var q=function(d,g){d=d||function(){};g=g||function(){};var h=this,j=e.Appacitive.config.apiBaseUrl+e.Appacitive.storage.urlFactory[this.type].getCreateUrl(c.__schematype||c.__relationtype,n);if(c.__schematype&&("user"==c.__schematype.toLowerCase()||"device"==c.__schematype.toLowerCase()))j=e.Appacitive.config.apiBaseUrl+
e.Appacitive.storage.urlFactory[c.__schematype.toLowerCase()].getCreateUrl();var f=new e.Appacitive.HttpRequest;f.url=j;f.method="put";c.__revision&&delete c.__revision;f.data=c;f.onSuccess=function(j){var f=null;if(j&&(j.article||j.connection||j.user||j.device))f=j.article||j.connection||j.user||j.device;j&&f?(b=f,c.__id=f.__id,a(f,c),h.connectionCollections&&0<h.connectionCollections.length&&h.connectionCollections.forEach(function(a){a.getQuery().extendOptions({articleId:c.__id})}),"connection"==
h.type&&h.parseConnection(),e.Appacitive.eventManager.fire((h.schema||h.relation)+"."+h.type+".created",h,{object:h}),"function"==typeof d&&d(h)):(j=j||{},j.status=j.status||{},j.status=k(j.status),e.Appacitive.eventManager.fire((h.schema||h.relation)+"."+h.type+".createFailed",h,{error:j.status}),"function"==typeof g&&g(j.status,h))};f.onError=function(a){a=k(a);"function"==typeof g&&g(a,h)};e.Appacitive.http.send(f);return this},r=function(d,g){d=d||function(){};g=g||function(){};var h=p(!0),j=
this;if(h){var f=new e.Appacitive.HttpRequest,m=e.Appacitive.config.apiBaseUrl+e.Appacitive.storage.urlFactory[this.type].getUpdateUrl(c.__schematype||c.__relationtype,b.__id?b.__id:c.__id,n);if(c&&c.__schematype&&("user"==c.__schematype.toLowerCase()||"device"==c.__schematype.toLowerCase()))m=e.Appacitive.config.apiBaseUrl+e.Appacitive.storage.urlFactory[c.__schematype.toLowerCase()].getUpdateUrl(b.__id);f.url=m;f.method="post";f.data=h;f.onSuccess=function(h){h&&(h.article||h.connection||h.user||
h.device)?(b=h.article||h.connection||h.user||h.device,a(b,c),l=[],e.Appacitive.eventManager.fire((j.schema||j.relation)+"."+j.type+"."+c.__id+".updated",j,{object:j}),"function"==typeof d&&d(j)):(h=h||{},h.status=h.status||{},h.status=k(h.status),e.Appacitive.eventManager.fire((j.schema||j.relation)+"."+j.type+"."+c.__id+".updateFailed",j,{object:h.status}),"function"==typeof g&&g(h.status,j))};f.onError=function(a){a=a||{};a.message=a.message||"Server error";a.code=a.code||"500";"function"==typeof g&&
g(a,j)};e.Appacitive.http.send(f)}else"function"==typeof d&&d(j);return this};this.fetch=function(d,g){d=d||function(){};g=g||function(){};if(c.__id){var h=this,j=e.Appacitive.config.apiBaseUrl+e.Appacitive.storage.urlFactory[this.type].getGetUrl(c.__schematype||c.__relationtype,c.__id,n),f=new e.Appacitive.HttpRequest;f.url=j;f.method="get";f.onSuccess=function(e){e&&(e.article||e.connection||e.user||e.device)?(b=e.article||e.connection||e.user||e.device,a(b,c),h.___collection&&"article"==h.___collection.collectionType&&
h.___collection.addToCollection(h),"function"==typeof d&&d(h)):(e=e||{},e.status=e.status||{},e.status=k(e),"function"==typeof g&&g(e.status,h))};f.onError=function(a){a=k(a);"function"==typeof g&&g(a,h)};e.Appacitive.http.send(f);return this}"function"==typeof g&&g({code:"400",message:"Please specify id for get operation"},this)};this.del=function(a,b,d){if(!c.__id&&this.___collection)this.___collection.removeByCId(g),"function"==typeof a&&a(this);else{a=a||function(){};b=b||function(){};d=d||{};
var h=this,j=e.Appacitive.config.apiBaseUrl,j=j+e.Appacitive.storage.urlFactory[this.type].getDeleteUrl(c.__schematype||c.__relationtype,c.__id);if(c&&c.__schematype&&("user"==c.__schematype.toLowerCase()||"device"==c.__schematype.toLowerCase()))j=e.Appacitive.config.apiBaseUrl,j+=e.Appacitive.storage.urlFactory[c.__schematype.toLowerCase()].getDeleteUrl(c.__id);d.deleteConnections&&!0===d.deleteConnections&&(j=-1==j.indexOf("?")?j+"?deleteconnections=true":j+"&deleteconnections=true");d=new e.Appacitive.HttpRequest;
d.url=j;d.method="delete";d.onSuccess=function(d){"200"==d.code?(h.___collection&&h.___collection.removeById(c.__id),"function"==typeof a&&a(d)):(d=k(d),"function"==typeof b&&b(d,h))};d.onError=function(a){a=k(a);"function"==typeof b&&b(a,h)};e.Appacitive.http.send(d)}}};e.Appacitive.BaseObject.prototype.toString=function(){return JSON.stringify(this.getObject())}})(global);
(function(e){var f=function(){return Math.floor(65536*Math.random()).toString(16)};e.Appacitive.GUID=function(){var d=f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f(),b="",a,c,e,h,j,k,m=0,d=d.replace(/\r\n/g,"\n");c="";for(e=0;e<d.length;e++)h=d.charCodeAt(e),128>h?c+=String.fromCharCode(h):(127<h&&2048>h?c+=String.fromCharCode(h>>6|192):(c+=String.fromCharCode(h>>12|224),c+=String.fromCharCode(h>>6&63|128)),c+=String.fromCharCode(h&63|128));for(d=c;m<d.length;)a=d.charCodeAt(m++),c=d.charCodeAt(m++),
e=d.charCodeAt(m++),h=a>>2,a=(a&3)<<4|c>>4,j=(c&15)<<2|e>>6,k=e&63,isNaN(c)?j=k=64:isNaN(e)&&(k=64),b=b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(j)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);return b.toString()}})(global);
(function(e){e.Appacitive.ArticleCollection=function(f){var d=null,b=null,a=[],c={};"string"==typeof f?c.schema=f:c=f;this.collectionType="article";if(!c||!c.schema)throw Error("Must provide schema while initializing ArticleCollection.");var d=c.schema,g=this;f=function(a){a.type="article";a.schema?d=a.schema:a.schema=d;b=new e.Appacitive.Queries.BasicFilterQuery(a);c=a;g.extendOptions=b.extendOptions};this.setFilter=function(a){c.filter=a;c.type="article";b?b.filter=a:(b=new e.Appacitive.Queries.BasicFilterQuery(c),
g.extendOptions=b.extendOptions);return this};this.setFreeText=function(a){!a&&0==a.trim().length&&(c.freeText="");c.freeText=a;c.type="article";b?b.freeText=a:(b=new e.Appacitive.Queries.BasicFilterQuery(c),g.extendOptions=b.extendOptions);return this};this.setFields=function(a){a||(c.fields="");c.fields=a;c.type="article";b?b.fields=a:(b=new e.Appacitive.Queries.BasicFilterQuery(c),g.extendOptions=b.extendOptions);return this};this.reset=function(){d=c=null;a.length=0;b=null};this.__defineGetter__("query",
function(){return b});this.getQuery=function(){return b};var h=["BasicFilterQuery"];this.__defineSetter__("query",function(c){if(!c||!c.toRequest)throw Error("Invalid  appacitive query passed to articleCollection");if(-1==h.indexOf(c.queryType))throw Error("ArticleCollection only accepts "+h.join(", "));a.length=0;b=c});this.setQuery=function(a){this.query=a;return this};this.setOptions=f;f(c);this.get=function(c){if(c!=parseInt(c,10))return null;c=parseInt(c,10);return"number"!=typeof c||c>=a.length?
null:a.slice(c,c+1)[0]};this.addToCollection=function(c){if(!c||c.get("__schematype")!=d)throw Error("Null article passed or schema type mismatch");var b=null;a.forEach(function(a,d){a.get("__id")==c.get("__id")&&(b=d)});0!=b?a.splice(b,1):a.push(c);return this};this.getArticleById=function(c){var b=a.filter(function(a){return a.get("__id")==c});return 1==b.length?b[0]:null};this.getAll=function(){return Array.prototype.slice.call(a)};this.getAllArticles=function(){return Array.prototype.slice.call(a).map(function(a){return a.getArticle()})};
this.removeById=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.getArticle().__id&&a.getArticle().__id==c&&(b=d)});null!==b&&a.splice(b,1);return this};this.removeByCId=function(c){if(!c)return!1;var b=null;a.forEach(function(a,d){a.cid&&a.cid==c&&(b=d)});null!==b&&a.splice(b,1);return this};this.fetch=function(c,d){c=c||function(){};d=d||function(){};a.length=0;var h=b.toRequest();h.onSuccess=function(b){a:{var h=c;b=b||{};var f=b.articles;if(!f)if(b.status&&b.status.code&&"200"==
b.status.code)f=[];else{h=b.status||{message:"Server error",code:400};"function"==typeof d&&d(h,g);break a}if(!f.length||0===f.length)f=[];f.forEach(function(c){c=new e.Appacitive.Article(c,!0);c.___collection=g;a.push(c)});h(b.paginginfo||{},g)}};h.onError=function(a){a=a||{message:"Server error",code:400};"function"==typeof d&&d(a,g)};e.Appacitive.http.send(h);return this};this.fetchByPageNumber=function(a,c,d){b.getOptions().pageQuery.pageNumber=d;this.fetch(a,c);return this};this.fetchNextPage=
function(a,c){b.getOptions().pageQuery.pageNumber+=1;this.fetch(a,c);return this};this.fetchPreviousPage=function(a,c){var d=b.getOptions().pageQuery;d.pageNumber-=1;0===d.pageNumber&&(d.pageNumber=1);this.fetch(a,c);return this};this.createNewArticle=function(c){c=c||{};c.__schematype=d;c=new e.Appacitive.Article(c);c.___collection=g;a.push(c);return c};this.map=function(){return a.map.apply(this,arguments)};this.forEach=function(){return a.forEach.apply(this,arguments)};this.filter=function(){return a.filter.apply(this,
arguments)}};e.Appacitive.ArticleCollection.prototype.toString=function(){return JSON.stringify(this.getAllArticles())};e.Appacitive.ArticleCollection.prototype.toJSON=function(){return this.getAllArticles()};e.Appacitive.ArticleCollection.prototype.__defineGetter__("articles",function(){return this.getAll()})})(global);
(function(e){e.Appacitive.ConnectionCollection=function(f){var d=null,b=null,a=[],c=[],g={};"string"==typeof f?g.relation=f:g=f;this.collectionType="connection";var h=this;if(!f||!f.relation)throw Error("Must provide relation while initializing ConnectionCollection.");d=f.relation;f=function(a){a.type="connection";a.relation?d=a.relation:a.relation=d;b=new e.Appacitive.Q