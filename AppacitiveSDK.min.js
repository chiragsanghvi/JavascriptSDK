/*
 * AppacitiveSDK.js vappacitive-js-sdk-v1.0.10 - Javascript SDK to integrate applications using Appacitive
 * Copyright (c) 2015 Appacitive Software Pvt Ltd
 * MIT license  : http://www.apache.org/licenses/LICENSE-2.0.html
 * Project      : https://github.com/chiragsanghvi/JavascriptSDK
 * Contact      : support@appacitive.com | csanghvi@appacitive.com
 * Build time 	: Wed Jun 22 17:00:00 PDT 2016
 */
var global={};
(function(){global.Appacitive={runtime:{}};"undefined"!==typeof process&&process.versions&&process.versions.node?global.Appacitive.runtime.isNode=!0:"undefined"!==typeof window&&(global=window,global.Appacitive={runtime:{isBrowser:!0}});var n=global.Appacitive;n.initialize=function(c){c=c||{};var f=new n.Promise;if(n.Session.initialized)return f.fulfill(n);c.masterKey&&0<c.masterKey.length&&n.Session.setMasterKey(c.masterKey);if(!c.apikey||0===c.apikey.length)if(c.masterKey)c.apikey=c.masterKey;else throw Error("apikey is mandatory");
if(!c.appId||0===c.appId.length)throw Error("appId is mandatory");n.Session.setApiKey(c.apikey);n.Session.environment(c.env||"sandbox");n.useApiKey=!0;n.appId=c.appId;n.Session.persistUserToken=c.persistUserToken;c.debug&&(n.config.debug=!0);n.utils._type.isFunction(c.apiLog)&&(n.logs.apiLog=c.apiLog);n.utils._type.isFunction(c.apiErrorLog)&&(n.logs.apiErrorLog=c.apiErrorLog);n.utils._type.isFunction(c.exceptionLog)&&(n.logs.exceptionLog=c.exceptionLog);if(c.userToken)-1==c.expiry?c.expiry=null:c.expiry||
(c.expiry=845E4),n.Session.setUserAuthHeader(c.userToken,c.expiry),c.user&&n.Users.setCurrentUser(c.user);else if(n.runtime.isBrowser){var k=n.LocalStorage.multiGet("Appacitive-UserToken","Appacitive-UserTokenExpiry","Appacitive-UserTokenDate","Appacitive-User");c=k["Appacitive-UserToken"];var b=k["Appacitive-UserTokenExpiry"],g=k["Appacitive-User"],k=k["Appacitive-User"];if(c){b||(b=-1);if(g&&0<b&&new Date(g+1E3*b)<new Date)return;-1==b&&(b=null);k&&n.Users.setCurrentUser(k,c,b)}}n.Session.initialized=
!0;f.fulfill(n.User.current());return f}})(this);
(function(n){var c=n.Appacitive,f=function(b){var g=c.Promise.buildPromise({success:b.onSuccess,error:b.onError}),m=new XDomainRequest;m.onload=function(){var b=m.responseText,h=m.contentType||"";if("application/json"==h.toLowerCase()||"application/javascript"==h.toLowerCase()||"application/json; charset=utf-8"==h.toLowerCase()||"application/json; charset=utf-8;"==h.toLowerCase())try{h=b,c.runtime.isBrowser||"{"!=h[0]&&(h=h.substr(1,h.length-1)),b=JSON.parse(h)}catch(e){return g.reject(m,new c.Error(c.Error.InvalidJson,
"Error while parsing received json "+b))}g.fulfill(b,this)};m.onerror=m.ontimeout=function(){m.responseData="IE's XDomainRequest does not supply error info.";m.status=c.Error.XDomainRequest;g.reject(m,new c.Error(c.Error.XDomainRequest,m.responseData,"Unknown"))};m.onprogress=function(){};-1===b.url.indexOf("?")?b.url+="?ua=ie":b.url+="&ua=ie";m.open(b.method,b.url,b.sync?!1:!0);m.send(b.data);return g},k=c.runtime.isBrowser?XMLHttpRequest:require("xmlhttprequest-with-globalagent").XMLHttpRequest;
c._Http=function(b){if(!b.url)throw Error("Please specify request url");b.method||(b.method="GET");b.headers||(b.headers=[]);var g={};b.onSuccess&&"function"==typeof b.onSuccess||(b.onSuccess=function(){});b.onError&&"function"==typeof b.onError||(b.onError=function(){});var m=c.Promise.buildPromise({success:b.onSuccess,error:b.onError}),d=!0;b.headers.forEach(function(e){"content-type"==e.key.toLowerCase()&&(d=!0,"application/json"==e.value.toLowerCase()||"application/javascript"==e.value.toLowerCase()||
"application/json; charset=utf-8"==e.value.toLowerCase()||"application/json; charset=utf-8;"==e.value.toLowerCase())&&(d=!1)});if(d)g=b.data;else if(b.data&&(g=b.data,"object"==typeof b.data))try{g=JSON.stringify(g)}catch(h){}var e=b.url.split("/")[2]||"";if(n.navigator&&_type.isObject(n.navigator.userAgent)&&_type.isFunction(n.navigator.userAgent.indexOf)&&-1!=n.navigator.userAgent.indexOf("MSIE 9")&&n.location&&n.location.host&&e!==n.location.host.toLowerCase())return b.data=g,new f(b);var l=new k;
l.onreadystatechange=function(){if(4==l.readyState)if(200<=l.status&&300>l.status||304==l.status){var e=l.responseText,b=l.getResponseHeader("content-type")||l.getResponseHeader("Content-Type")||"";if("application/json"==b.toLowerCase()||"application/javascript"==b.toLowerCase()||"application/json; charset=utf-8"==b.toLowerCase()||"application/json; charset=utf-8;"==b.toLowerCase())try{b=e,c.runtime.isBrowser||"{"!=b[0]&&(b=b.substr(1,b.length-1)),e=JSON.parse(b)}catch(d){return m.reject(l,new c.Error(c.Error.InvalidJson,
"Error while parsing received json "+e))}m.fulfill(e,l)}else m.reject(l,new c.Error(c.Error.ConnectionFailed,l.responseText,"Unknown"))};l.open(b.method,b.url,b.sync?!1:!0);for(e=0;e<b.headers.length;e+=1)l.setRequestHeader(b.headers[e].key,b.headers[e].value);c.runtime.isBrowser||l.setRequestHeader("User-Agent","Appacitive-NodeJSSDK");l.send(g);return m}})(global);
(function(n){var c=n.Appacitive,f=function(b){if(b&&b.send&&"function"==typeof b.send)b.onResponse=this.onResponse;else throw Error("No applicable httpTransport class found");var m=[],d={},h=0,e={},l=0;this.addProcessor=function(e){e&&(e.pre=e.pre||function(){},e.post=e.post||function(){},q(e.pre),k(e.post))};var q=function(e){h+=1;d[h]=e;return h},k=function(b){l+=1;e[l]=b;return l};this.enqueueRequest=function(e){m.push(e)};this.changeRequestForCors=function(e){var l={m:e.method.toUpperCase()};
e.headers.forEach(function(e){l[e.key]=e.value});e.prevHeaders=e.headers;e.headers=[];e.headers.push({key:"Content-Type",value:"text/plain; charset=utf-8"});e.method="POST";e.data&&(l.b=e.data);delete e.data;c.config.debug&&(-1===e.url.indexOf("?")?e.url+="?debug=true":e.url+="&debug=true");c.config.metadata&&(-1===e.url.indexOf("?")?e.url+="?metadata=true":e.url+="&metadata=true");try{e.data=JSON.stringify(l)}catch(b){}return e};this.notify=function(){if(0!==m.length){var l=[],c;for(c in e)e.hasOwnProperty(c)&&
l.push(e[c]);for(;0<m.length;){var h=m.shift(),q=[];for(c in d)d.hasOwnProperty(c)&&q.push(d[c](h));this.changeRequestForCors(h);b.send(h,l,q)}}};this.onResponse=function(e){console.dir(e)}},k=function(){var b=function(){throw Error("Not Implemented Exception");};this.inOnline=this.send=b;this.onResponse=function(c,d){b()};this.onError=function(c){b()}},b=function(){var b=new k;b.isOnline=function(){return!0};var m=function(d,h,e){d.options=d.options||{};new c._Http({method:d.method,url:d.url,headers:d.headers,
data:d.data,sync:d.options.sync,onSuccess:function(l,c){if(l){try{l=JSON.parse(l)}catch(m){}var k=l;if(h.length!=e.length)throw Error("Callback length and state length mismatch!");for(var f=0;f<h.length;f+=1)h[f].apply({},[k,e[f]]);if(200<=l.code&&300>=l.code||l.status&&200<=l.status.code&&300>=l.status.code)b.onResponse(d,l);else l=l||{},l=l.status||l,l.message=l.message||"Bad Request",l.code=l.code||"400",b.onError(d,{responseText:l})}else b.onError(d,{responseText:{code:"400",message:"Invalid request"}})},
onError:function(e,h){var m={};h?m=c.Error.toJSON(h):(m.message=e.responseData||e.responseText||"Bad Request",m.code=e.status||"400");b.onError(d,{responseText:m})}})};b.send=function(b,h,e){if(!c.Session.initialized)throw Error("Initialize Appacitive SDK");"function"==typeof b.beforeSend&&b.beforeSend(b);m(b,h,e)};return b};c.http=new function(){var g=new b,m=new f(g),d=!1;this.pause=function(){d=!0};this.unpause=function(){d=!1};this.addProcessor=function(b){var e=Error('Must provide a processor object with either a "pre" function or a "post" function.');
if(!b)throw e;if(!b.pre&&!b.post)throw e;m.addProcessor(b)};this.send=function(b){b.promise=c.Promise.is(b.promise)?b.promise:new c.Promise.buildPromise({error:b.onError});m.enqueueRequest(b);g.isOnline()&&!1===d&&m.notify();return b.promise};this.flush=function(b){b?m.notify():g.isOnline()&&m.notify()};this.onError=function(b,e){var l=e.responseText;c.logs.logRequest(b,l,l,"error");b.entity&&b.entity._triggerError&&b.entity._triggerError(b.options,new c.Error(l));b.promise.reject(new c.Error(l),
b.entity)};g.onError=this.onError;this.onResponse=function(b,e){if(b.onSuccess)if(b.context)b.onSuccess.apply(b.context,[e]);else b.onSuccess(e);c.logs.logRequest(b,e,e?e.status:null,"successful")};g.onResponse=this.onResponse};c.HttpRequest=function(b){b=b||{};this.url=b.url||"";this.data=b.data||{};this.headers=b.headers||[];this.method=b.method||"GET";this.onSuccess=b.onSuccess||function(){};this.onError=b.onError||function(){};this.send=function(b){return new c._Http(this,b)}};(function(b){var c=
b.Appacitive;c&&c.http&&(c.http.addProcessor({pre:function(b){return b},post:function(b,h){try{var e=c.Session.isSessionValid(b);e.status?b&&(b.status&&b.status.code&&("19036"==b.status.code||"421"==b.status.code)||b.code&&("19036"==b.code||"421"==b.code))?c.Users.logout():c.Session.incrementExpiry():e.isSession&&(null!==c.Session.get()&&c.Session.resetSession(),c.http.send(h))}catch(l){}}}),c.http.addProcessor({pre:function(b){return{start:(new Date).getTime(),request:b}},post:function(b,c){c.request.timeTakenInMilliseconds=
(new Date).getTime()-c.start}}))})(n)})(global);var _type=function(n){if(null===n)return"null";if("undefined"===typeof n||"undefined"===n)return"undefined";if(n&&(1===n.nodeType||9===n.nodeType))return"element";var c=Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase();if("number"===c){if(isNaN(n))return"nan";if(!isFinite(n))return"infinity"}return c};
(function(n){"bind"in Function.prototype||(Function.prototype.bind=function(b){var d=this;if(1>=arguments.length)return function(){return d.apply(b,arguments)};var c=Array.prototype.slice.call(arguments,1);return function(){return d.apply(b,0===arguments.length?c:c.concat(Array.prototype.slice.call(arguments)))}});"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});"indexOf"in Array.prototype||(Array.prototype.indexOf=function(b,d){void 0===
d&&(d=0);0>d&&(d+=this.length);0>d&&(d=0);for(var c=this.length;d<c;d++)if(d in this&&this[d]===b)return d;return-1});"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(b,d){void 0===d&&(d=this.length-1);0>d&&(d+=this.length);d>this.length-1&&(d=this.length-1);for(d++;0<d--;)if(d in this&&this[d]===b)return d;return-1});"forEach"in Array.prototype||(Array.prototype.forEach=function(b,d){for(var c=0,e=this.length;c<e;c++)c in this&&b.call(d,this[c],c,this)});"map"in Array.prototype||
(Array.prototype.map=function(b,d){for(var c=Array(this.length),e=0,l=this.length;e<l;e++)e in this&&(c[e]=b.call(d,this[e],e,this));return c});"filter"in Array.prototype||(Array.prototype.filter=function(b,d){for(var c=[],e,l=0,q=this.length;l<q;l++)l in this&&b.call(d,e=this[l],l,this)&&c.push(e);return c});"every"in Array.prototype||(Array.prototype.every=function(b,d){for(var c=0,e=this.length;c<e;c++)if(c in this&&!b.call(d,this[c],c,this))return!1;return!0});"some"in Array.prototype||(Array.prototype.some=
function(b,d){for(var c=0,e=this.length;c<e;c++)if(c in this&&b.call(d,this[c],c,this))return!0;return!1});"find"in Array.prototype||(Array.prototype.find=function(b,d){var c=this.length;if(0!==c)for(var e=0,l;e<c&&e in this;e++)if(l=this[e],b.call(d,l,e,this))return l});"where"in Array.prototype||(Array.prototype.where=function(b,d){return 0===this.length?void 0:Object.isEmpty(b)?d?void 0:[]:this[d?"find":"filter"](function(d){for(var e in b)if(b[e]!==d[e])return!1;return!0})},Array.prototype.findWhere=
function(b){return this.where(b,!0)});"each"in Array.prototype||(Array.prototype.each=function(b,d){for(var c=0;c<this.length;c++)b.apply(d,[this[c]])});"difference"in Array.prototype||(Array.prototype.difference=function(b){return this.filter(function(d){return 0>b.indexOf(d)})});"without"in Array.prototype||(Array.prototype.without=function(){return this.difference(Array.prototype.slice.call(arguments,0))});"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(b){if(null===
this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof b)throw new TypeError(b+" is not a function");var d=Object(this),c=d.length>>>0,e=0,l;if(2<=arguments.length)l=arguments[1];else{for(;e<c&&!e in d;)e++;if(e>=c)throw new TypeError("Reduce of empty array with no initial value");l=d[e++]}for(;e<c;e++)e in d&&(l=b(l,d[e],e,d));return l});var c=function(b,d){return null==b?_.identity:_.isFunction(b)?d?function(){return b.apply(d,
arguments)}:b:function(d){return d[b]}};Array.prototype.pluck=function(b){var d=[];this.each(function(c){d.push(c[b])});return d};Array.prototype.sortBy=function(b,d){b=c(b,d);return this.map(function(c,e){return{value:c,criteria:b.call(d,c,e,this)}},this).sort(function(b,e){var l=b.criteria,d=e.criteria;return l<d?-1:l>d?1:0}).pluck("value")};Array.prototype.removeAll=function(b){for(var d=null,c=0;c<this.length;c++)for(;this[c]===b;)d=this.splice(c,1)[0];return d};Array.prototype.compare=function(b){if(!b||
this.length!=b.length)return!1;for(var d=0,c=this.length;d<c;d++)if(this[d]instanceof Array&&b[d]instanceof Array){if(!this[d].compare(b[d]))return!1}else if(this[d]!=b[d])return!1;return!0};Array.prototype.equals=function(b,d){if(!b)return!1;1==arguments.length&&(d=!1);if(this.length!=b.length)return!1;for(var c=0;c<this.length;c++)if(this[c]instanceof Array&&b[c]instanceof Array){if(!this[c].equals(b[c],d))return!1}else{if(d&&!_type.isEqual(this[c],b[c]))return!1;if(!d)return this.sort().equals(b.sort(),
!0)}return!0};Date.prototype.toISOString||function(){function b(c){c=String(c);1===c.length&&(c="0"+c);return c}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}();String.addSlashes=function(b){if(!b)return b;b=b.replace(/\\/g,"\\\\");b=b.replace(/\'/g,"\\'");b=b.replace(/\"/g,
'\\"');return b=b.replace(/\0/g,"\\0")};String.stripSlashes=function(b){if(!b)return b;b=b.replace(/\\'/g,"'");b=b.replace(/\\"/g,'"');b=b.replace(/\\0/g,"\x00");return b=b.replace(/\\\\/g,"\\")};if("undefined"===typeof console||null===console)console={log:function(){},dir:function(){}};for(var f="Null Undefined Object Array String Number Boolean Function RegExp Element NaN Infinite".split(" "),k=function(b){_type["is"+b]=function(c){return _type(c)===b.toLowerCase()}},b=0;b<f.length;b++)k(f[b]);
_type.isNullOrUndefined=function(b){return"null"==_type(b)||"undefined"==_type(b)};_type.isNumeric=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};_type.isDate=function(b){return b instanceof Date};var g=function(b,c,h,e){var l=Object.prototype.toString;if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;var q=l.call(b);if(q!=l.call(c))return!1;switch(q){case "[object String]":return b==String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==
+c}if("object"!=typeof b||"object"!=typeof c)return!1;if(b instanceof n.Appacitive.GeoCoord&&c instanceof n.Appacitive.GeoCoord)return b.toString()==c.toString();for(l=h.length;l--;)if(h[l]==b)return e[l]==c;var l=b.constructor,k=c.constructor;if(l!==k&&!(_types.isFunction(l)&&l instanceof l&&_types.isFunction(k)&&k instanceof k)&&"constructor"in b&&"constructor"in c)return!1;h.push(b);e.push(c);l=0;k=!0;if("[object Array]"==q){if(l=b.length,k=l==c.length)for(;l--&&(k=g(b[l],c[l],h,e)););}else{for(var p in b)if(Object.prototype.hasOwnProperty.call(b,
p)&&(l++,!(k=Object.prototype.hasOwnProperty.call(c,p)&&g(b[p],c[p],h,e))))break;if(k){for(p in c)if(Object.prototype.hasOwnProperty.call(c,p)&&!l--)break;k=!l}}h.pop();e.pop();return k};_type.isEqual=function(b,c){return g(b,c,[],[])};n.Appacitive.utils=n.Appacitive.utils||{};n.Appacitive.utils._type=_type})(global);
(function(n){var c=Array.prototype,f=Object.prototype,k=n.Appacitive;k.utils._each=function(b,k,d){if(null!=b)if(c.forEach&&b.forEach===c.forEach)b.forEach(k,d);else if(b.length===+b.length)for(var h=0,e=b.length;h<e&&k.call(d,b[h],h,b)!=={};h++);else for(h in b)if(f.hasOwnProperty.call(b,h)&&k.call(d,b[h],h,b)==={})break};k.utils._extend=function(b){k.utils._each(c.slice.call(arguments,1),function(c){if(c)for(var d in c)b[d]=c[d]});return b};k.utils._reject=function(b,c){return b.filter(function(b){return!c(b)})};
k.utils._deepExtend=function(b){k.utils._each(Array.prototype.slice.call(arguments,1),function(c){for(var d in c)k.utils._type.isArray(c[d])?(k.utils._type.isArray(b[d])||(b[d]=[]),b[d]=k.utils._reject(k.utils._extend(b[d],c[d]),function(b){return k.utils._type.isNull(b)})):!k.utils._type.isObject(c[d])||c[d]instanceof k.Object||c[d]instanceof k.Connection||c[d]instanceof k.GeoCoord?b[d]=c[d]:(k.utils._type.isObject(b[d])||(b[d]={}),b[d]=k.utils._extend(b[d],c[d]))});return b};var b=function(b,c){var d=
this,h;h=k.utils._type.isObject(b)&&b.hasOwnProperty("constructor")?b.constructor:function(){return d.apply(this,arguments)};k.utils._extend(h,d,c);var e=function(){this.constructor=h};e.prototype=d.prototype;h.prototype=new e;b&&k.utils._extend(h.prototype,b);h.__super__=d.prototype;return h};k.utils.classExtend=function(c,k,d){return b.apply(c,[k,d])};k.utils._result=function(b,c,d){c=null==b?void 0:b[c];void 0===c&&(c=d);return k.utils._type.isFunction(c)?c.call(b):c};k.clone=k.utils._clone=function(b){return k.utils._type.isObject(b)?
k.utils._type.isArray(b)?b.slice():k.utils._extend({},b):b}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type;c.logs={};var k=function(b,c){setTimeout(function(){try{b.call({},c)}catch(k){}},0)};c.logs.logRequest=function(b,g,m,d){g=g||{};m=m||{};var h={};try{h=JSON.parse(b.data),f.isObject(h)||(h={})}catch(e){}var l={status:d,referenceId:m.referenceid,date:(new Date).toISOString(),method:h.m,url:decodeURIComponent(b.url),responseTime:b.timeTakenInMilliseconds,headers:{},request:null,response:g,description:b.description};b.headers&&b.headers.forEach(function(b){l.headers[b.key]=
b.value});b.prevHeaders&&b.prevHeaders.forEach(function(b){l.headers[b.key]=b.value});"GET"!==l.method&&(l.request=h.b);"error"==d&&(c.runtime.isBrowser&&console.dir(l),f.isFunction(c.logs.apiErrorLog)&&k(c.logs.apiErrorLog,l));f.isFunction(c.logs.apiLog)&&k(c.logs.apiLog,l)};c.logs.logException=function(b){f.isFunction(c.logs.exceptionLog)&&k(c.logs.exceptionLog,b)}})(global);
(function(n){var c=n.Appacitive;String.format=function(c,k){if(1>=arguments.length)return c;for(var b=arguments.length-2,g=0;g<=b;g++)c=c.replace(new RegExp("\\{"+g+"\\}","gi"),arguments[g+1]);return c};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(c){var k=new RegExp("^"+c),b=this;k.test(b)&&(b=b.slice(1,b.length));k=new RegExp(c+"$");k.test(b)&&(b=b.slice(0,-1));return b};String.toSearchString=function(c){"undefined"===
typeof c&&(c="");for(var k="",b=0;b<c.length;b+=1)-1===" .,;#".indexOf(c[b])&&(k+=c[b]);return k=k.toLowerCase()};String.contains=function(c,k){return-1!==c.indexOf(k)};String.startsWith=function(c,k){return 0===c.indexOf(k)};Array.distinct=function(c){var k=[],b=c.length,g,m,d;for(m=0;m<b;m++){g=void 0;for(d=0;d<k.length;d++)if(c[m].toLowerCase()===k[d].toLowerCase()){g=!0;break}g||k.push(c[m])}return k};Object.isEmpty=function(c){if(!c)return!0;var k=!0,b;for(b in c){k=!1;break}return k};n.dateFromWcf=
function(c,k){var b=/Date\(([^)]+)\)/.exec(c);if(2!=b.length){if(!k)return s;throw Error(s+" is not .net json date.");}return new Date(parseFloat(b[1]))};c.storage=c.storage||{};c.storage.urlFactory=new function(){c.bag=c.bag||{};var f=function(c){"object"===typeof c&&0<c.length&&("string"===typeof c[0]||"number"===typeof c[0])&&(c=c.join(","));c||(c="");return c};this.application={applicationServiceUrl:"application",getSessionCreateUrl:function(){return String.format("{0}/session",this.applicationServiceUrl)}};
this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(c,b){return String.format("{0}/create?fields={1}",this.userServiceUrl,f(b))},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getGetUrl:function(c,b,g){return String.format("{0}/{1}?fields={2}",c,b,f(g))},getUserByTokenUrl:function(c){return String.format("{0}/me?useridtype=token&token={1}",
this.userServiceUrl,c)},getUserByUsernameUrl:function(c){return String.format("{0}/{1}?useridtype=username",this.userServiceUrl,c)},getUpdateUrl:function(c,b,g){return g?String.format("{0}/{1}?fields={2}&revision={3}",this.userServiceUrl,c,f(b),g):String.format("{0}/{1}?fields={2}",this.userServiceUrl,c,f(b))},getDeleteUrl:function(c,b,g){return!0===g?String.format("{0}/{1}?deleteconnections=true",this.userServiceUrl,b):String.format("{0}/{1}",this.userServiceUrl,b)},getGetAllLinkedAccountsUrl:function(c){return String.format("{0}/{1}/linkedaccounts",
this.userServiceUrl,c)},getValidateTokenUrl:function(c){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,c)},getInvalidateTokenUrl:function(c){return String.format("{0}/invalidate?userToken={1}",this.userServiceUrl,c)},getSendResetPasswordEmailUrl:function(){return String.format("{0}/sendresetpasswordemail",this.userServiceUrl)},getUpdatePasswordUrl:function(c){return String.format("{0}/{1}/changepassword",this.userServiceUrl,c)},getLinkAccountUrl:function(c){return String.format("{0}/{1}/link",
this.userServiceUrl,c)},getDelinkAccountUrl:function(c,b){return String.format("{0}/{1}/{2}/delink",this.userServiceUrl,c,b)},getCheckinUrl:function(c,b,g){return String.format("{0}/{1}/chekin?lat={2}&lng={3}",this.userServiceUrl,c,b,g)},getResetPasswordUrl:function(c){return String.format("{0}/resetpassword?token={1}",this.userServiceUrl,c)},getValidateResetPasswordUrl:function(c){return String.format("{0}/validateresetpasswordtoken?token={1}",this.userServiceUrl,c)}};this.device={deviceServiceUrl:"device",
getCreateUrl:function(c,b){return String.format("{0}/register?fields={1}",this.deviceServiceUrl,f(b))},getGetUrl:function(c,b,g){return String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,b,f(g))},getUpdateUrl:function(c,b,g){return g?String.format("{0}/{1}?fields={2}&revision={3}",this.deviceServiceUrl,c,f(b),g):String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,c,f(b))},getDeleteUrl:function(c,b,g){return!0===g?String.format("{0}/{1}?deleteconnections=true",this.deviceServiceUrl,b):String.format("{0}/{1}",
this.deviceServiceUrl,b)}};this.object={objectServiceUrl:"object",getSearchAllUrl:function(c,b,g){var f="",f=String.format("{0}/search/{1}/all",this.objectServiceUrl,c),f=g?f+"?psize="+g:f+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(c=0;c<b.length;c+=1)0!==b[c].trim().length&&(f=f+"&"+b[c]);return f},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.objectServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/search/{1}/all?properties={2}",
this.objectServiceUrl,c,b)},getMultiGetUrl:function(c,b,g){return String.format("{0}/{1}/multiGet/{2}?fields={3}",this.objectServiceUrl,c,b,f(g))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.objectServiceUrl,c,f(b))},getGetUrl:function(c,b,g){return String.format("{0}/{1}/{2}?fields={3}",this.objectServiceUrl,c,b,f(g))},getUpdateUrl:function(c,b,g,m){return m?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.objectServiceUrl,c,b,f(g),m):String.format("{0}/{1}/{2}?fields={3}",
this.objectServiceUrl,c,b,f(g))},getDeleteUrl:function(c,b,g){return!0===g?String.format("{0}/{1}/{2}?deleteconnections=true",this.objectServiceUrl,c,b):String.format("{0}/{1}/{2}",this.objectServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",this.objectServiceUrl,c)}};this.connection={connectionServiceUrl:"connection",getGetUrl:function(c,b,g){return String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,f(g))},getMultiGetUrl:function(c,b,g){return String.format("{0}/{1}/multiGet/{2}?fields={3}",
this.connectionServiceUrl,c,b,f(g))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.connectionServiceUrl,c,f(b))},getUpdateUrl:function(c,b,g,m){return m?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.connectionServiceUrl,c,b,f(g),m):String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,f(g))},getDeleteUrl:function(c,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",
this.connectionServiceUrl,c)},getSearchByArticleUrl:function(c,b,g,f){var d="",d=String.format("{0}/{1}/find/all?label={2}&objectid={3}",this.connectionServiceUrl,c,g,b);if("undefined"!==typeof f&&0<f.length)for(c=0;c<f.length;c+=1)d=d+"&"+f[c];return d},getConnectedArticles:function(c,b,g){var f="",f=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,c,b);if(g&&g.length&&0<g.length)for(c=0;c<g.length;c+=1)f=0===c?f+("?"+g[c]):f+("&"+g[c]);return f},getInterconnectsUrl:function(){return String.format("{0}/interconnects",
this.connectionServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/{1}/find/all?properties=",this.connectionServiceUrl,c,b)}};this.cannedList={cannedListServiceUrl:"list",getGetListItemsUrl:function(c){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,c)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",this.pushServiceUrl)},getGetNotificationUrl:function(c){return String.format("{0}/notification/{1}",this.pushServiceUrl,
c)},getGetAllNotificationsUrl:function(c){return String.format("{0}/getAll?psize={1}&pnum={2}",this.pushServiceUrl,c.psize,c.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(c,b){return b&&0<b.length?String.format("{0}/uploadurl?contenttype={1}&expires=20&filename={2}",this.fileServiceUrl,escape(c),escape(b)):String.format("{0}/uploadurl?contenttype={1}&expires=20",this.fileServiceUrl,escape(c))},getUpdateUrl:function(c,b){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",
this.fileServiceUrl,c,escape(b))},getDownloadUrl:function(c,b){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,c,b)},getDeleteUrl:function(c){return String.format("{0}/delete/{1}",this.fileServiceUrl,c)}};this.query={params:function(c){var b=[];return""===location.search||-1===location.search.indexOf("?")?b:c?(c=c.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(g,f){var d=f.split("="),h=d[1];2<d.length&&d.forEach(function(b,c){0!==b&&1!==b&&(h=h+"="+
d[b])});d[0].toLowerCase()===c&&(b=[d[0],h])}),b):location.search.split("?")[1].split("=")}};this.usergroup={usergroupServiceUrl:"usergroup",getUpdateUrl:function(c){return String.format("{0}/{1}/members",this.usergroupServiceUrl,c)}};this.ping={pingServiceUrl:"ping",getPingUrl:function(){return String.format("{0}/",this.pingServiceUrl)}};this.multi={multiServiceUrl:"multi",getBatchUrl:function(){return String.format("{0}/",this.multiServiceUrl)}}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k;k=c.runtime.isNode?process.nextTick:setTimeout;var b=function(){if(!(this instanceof b))return new b;this.calls=[]};b.prototype.isResolved=function(){return 1===this.state?!0:!1};b.prototype.isRejected=function(){return 2===this.state?!0:!1};b.prototype.isFulfilled=function(){return 1===this.state||2===this.state?!0:!1};b.prototype.done=function(){var g,f,d=this.state,h=this.value;if(!d)return this;for(;g=this.calls.shift();)if(f=g[0],"function"===
typeof g[d]){try{h=2===d?g[d].call(f,this.value):g[d].apply(f,this.value)}catch(e){c.logs.logException({name:e.name,message:e.message,stack:e.stack});if(0==f.calls.length)throw e;f.reject(e)}h instanceof b||h&&"function"===typeof h.then?h.then(function(b){f.fulfill(b)},function(b){f.reject(b)}):1===d?f.fulfill(h):f.reject(h)}else 1===d?f.fulfill(h):f.reject(h)};b.prototype.fulfill=function(b){if(this.state)return this;this.state=1;this.reason=this.value=[].slice.call(arguments);this.done();return this};
b.prototype.resolve=b.prototype.fulfill;b.prototype.reject=function(b){if(this.state)return this;this.state=2;this.reason=this.value=b;this.done();return this};b.prototype.then=function(c,f){var d=this,h=new b;this.calls[this.calls.length]=[h,c,f];this.state&&k(function(){d.done()});return h};b.when=function(c){var m=[],d=[],h,e=0,l=new b;if(!c||f.isArray(c)&&0==c.length)return l.fulfill(m),l;var q=function(){e+=1;e==h&&(l.state||(0<d.length?l.reject(d,m?m:[]):l.fulfill(m?m:[])))},t=function(e){var l=
c[e];l instanceof b||l&&"function"===typeof l.then?k(function(){l.then(function(b){m[e]=b;q()},function(b){d[e]=b;q()})}):k(function(){try{m[e]=l.call()}catch(b){d[e]=b}q()})};f.isArray(c)||(c=[c]);h=c.length;for(var p=0;p<h;p+=1)t(p);return l};b.is=function(c){return c instanceof b?!0:!1};b.buildPromise=function(c){var k=new b;f.isObject(c)&&k.then(c.success,c.error);return k};b._continueUntil=function(c,k){return f.isFunction(c)&&c()?k().then(function(){return b._continueUntil(c,k)}):(new b).fulfill()};
c.Promise=b})(global);
(function(n){n.Appacitive.eventManager=new function(){function c(){var c=function(){return Math.floor(65536*Math.random()).toString(16)};return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}var f={};this.subscribe=function(k,b){if("string"!=typeof k||"function"!=typeof b)throw Error("Incorrect subscription call");"undefined"==typeof f[k]&&(f[k]=[]);var g=c();f[k].push({callback:b,id:g});return g};this.unsubscribe=function(c){if(!c)return!1;var b=-1,g=null,m;for(m in f)for(var d=0;d<f[m].length;d+=
1)if(f[m][d].id==c){b=d;g=m;break}return-1!=b?(f[g].splice(b,1),!0):!1};this.fire=function(c,b,g){if("string"!=typeof c)throw Error("Incorrect fire call");if("undefined"==typeof g||null===g)g={};g.eventName=c;if("undefined"!=typeof f.all)for(var m=0;m<f.all.length;m+=1)f.all[m].callback(b,g);m=function(b,c,l){setTimeout(function(){b(c,l)},0)};if("undefined"!=typeof f[c])for(var d=0;d<f[c].length;d+=1)m(f[c][d].callback,b,g)};this.clearSubscriptions=function(c){if("string"!=typeof c)throw Error("Event Name must be string in EventManager.clearSubscriptions");
f[c]&&(f[c].length=0);return this};this.clearAndSubscribe=function(c,b){this.clearSubscriptions(c);this.subscribe(c,b)};this.dump=function(){console.dir(f)}}})(global);
(function(n){var c={},f=Array.prototype.forEach,k=Object.prototype.hasOwnProperty,b=Array.prototype.slice,g=0,m=function(){return{keys:Object.keys,uniqueId:function(b){var c=++g+"";return b?b+c:c},has:function(b,c){return k.call(b,c)},each:function(b,e,l){if(null!=b)if(f&&b.forEach===f)b.forEach(e,l);else if(b.length===+b.length)for(var d=0,h=b.length;d<h&&e.call(l,b[d],d,b)!==c;d++);else for(d in b)if(this.has(b,d)&&e.call(l,b[d],d,b)===c)break},once:function(b){var c=!1,e;return function(){if(c)return e;
c=!0;e=b.apply(this,arguments);b=null;return e}}}}(),d;d={on:function(b,c,l){if(!e(this,"on",b,[c,l])||!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:l,ctx:l||this});return this},once:function(b,c,l){if(!e(this,"once",b,[c,l])||!c)return this;var d=this,h=m.once(function(){d.off(b,h);c.apply(this,arguments)});h._callback=c;return this.on(b,h,l)},off:function(b,c,l){var d,h,g,f,k,n,v,w;if(!this._events||!e(this,"off",b,[c,l]))return this;
if(!b&&!c&&!l)return this._events={},this;f=b?[b]:m.keys(this._events);k=0;for(n=f.length;k<n;k++)if(b=f[k],g=this._events[b]){this._events[b]=d=[];if(c||l)for(v=0,w=g.length;v<w;v++)h=g[v],(c&&c!==h.callback&&c!==h.callback._callback||l&&l!==h.context)&&d.push(h);d.length||delete this._events[b]}return this},trigger:function(c){if(!this._events)return this;var d=b.call(arguments,1);if(!e(this,"trigger",c,d))return this;var h=this._events[c],g=this._events.all;h&&l(h,d);g&&l(g,arguments);return this},
stopListening:function(b,c,e){var l=this._listeners;if(!l)return this;var d=!c&&!e;"object"===typeof c&&(e=this);b&&((l={})[b._listenerId]=b);for(var h in l)l[h].off(c,e,this),d&&delete this._listeners[h];return this}};var h=/\s+/,e=function(b,c,e,l){if(!e)return!0;if("object"===typeof e){for(var d in e)b[c].apply(b,[d,e[d]].concat(l));return!1}if(h.test(e)){e=e.split(h);d=0;for(var g=e.length;d<g;d++)b[c].apply(b,[e[d]].concat(l));return!1}return!0},l=function(b,c){var e,l=-1,d=b.length,h=c[0],g=
c[1],f=c[2];switch(c.length){case 0:for(;++l<d;)(e=b[l]).callback.call(e.ctx);break;case 1:for(;++l<d;)(e=b[l]).callback.call(e.ctx,h);break;case 2:for(;++l<d;)(e=b[l]).callback.call(e.ctx,h,g);break;case 3:for(;++l<d;)(e=b[l]).callback.call(e.ctx,h,g,f);break;default:for(;++l<d;)(e=b[l]).callback.apply(e.ctx,c)}};m.each({listenTo:"on",listenToOnce:"once"},function(b,c){d[c]=function(c,e,l){var d=this._listeners||(this._listeners={}),h=c._listenerId||(c._listenerId=m.uniqueId("l"));d[h]=c;"object"===
typeof e&&(l=this);c[b](e,l,this);return this}});d.bind=d.on;d.unbind=d.off;d.mixin=function(b){m.each("on once off trigger stopListening listenTo listenToOnce bind unbind".split(" "),function(c){b[c]=this[c]},this);return b};n.Appacitive.Events=d})(global);
(function(n){n.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/v1.0/",metadata:!0};n.navigator&&_type.isObject(n.navigator.userAgent)&&_type.isFunction(n.navigator.userAgent.indexOf)&&(-1!=n.navigator.userAgent.indexOf("MSIE 8")||-1!=n.navigator.userAgent.indexOf("MSIE 9"))&&(n.Appacitive.config.apiBaseUrl=window.location.protocol+"//apis.appacitive.com/v1.0/")})(global);
(function(n){var c=n.Appacitive,f=c.utils._type;n=function(k){var b;if(!k||!f.isObject(k))throw Error("Please specify request options");this.promise=c.Promise.buildPromise(k.options);var g=this.request=new c.HttpRequest;b=c.storage.urlFactory[k.type];var m=k.op.replace("get","").replace("Url","")+" "+k.type;b=c.config.apiBaseUrl+b[k.op].apply(b,k.args||[]);g.url=b;g.description=m;g.method=k.method||"get";g.data=k.data||{};g.onSuccess=k.onSuccess;g.onError=k.onError;g.promise=this.promise;g.options=
k.options;k.entity&&(g.entity=k.entity);return this};n.prototype.send=function(){return c.http.send(this.request)};c._Request=n})(global);
(function(n){n=n.Appacitive;var c=n.utils._type,f=n.utils._extend;n.Error=function(f,b,g,m){if(c.isString(f)||c.isNumber(f))f={code:f,message:b,referenceId:g,additionalMessages:m};this.code=f.code||"400";this.message=f.message||"Unknown Error";f.referenceId&&(this.referenceId=f.referenceid||f.referenceId);f.additionalmessages&&(this.additionalMessages=f.additionalmessages||additionalMessages)};n.Error.toJSON=function(c){return{code:c.code,message:c.message,referenceId:c.referenceId,additionalmessages:c.additionalMessages}};
f(n.Error,{BadRequest:"400",AccessControl:"401",PaymentRequired:"402",UsageLimitReached:"403",NotFound:"404",Duplicate:"435",MvccFailure:"409",PreconditionFailed:"412",ApiAuthenticationError:"420",IdentityFailures:"421",IncorrectConfiguration:"436",InternalServerError:"500",DataAccessFailure:"512",UnknownCause:100,InvalidParameters:"400",ConnectionFailed:1001,MissingId:"404",InvalidJson:1007,DuplicateUsername:"435",DuplicateValue:"435",XDomainRequest:5E3})})(global);
(function(n){var c=n.Appacitive,f=c.utils._type;c.Session=new function(){this.initialized=!1;var k=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},b=null,g=null,m=null,d=!1,h;this.useApiKey=!0;this.useMasterKey=!1;this.onSessionCreated=function(){};this.recreate=function(b){return c.Session.create(b)};this.create=function(e){if(!this.initialized)throw Error("Initialize Appacitive SDK");var d=new k;d.apikey=g;var h=new c._Request({method:"PUT",type:"application",
op:"getSessionCreateUrl",options:e,data:d,onSuccess:function(e){b=e.session.sessionkey;c.Session.useApiKey=!1;h.promise.fulfill(e);c.Session.onSessionCreated()}});return h.send()};c.http.addProcessor({pre:function(e){e.options=e.options||{};if(c.Session.useApiKey){var q=g;(e.options.useMasterKey||c.useMasterKey&&!e.options.useMasterKey)&&f.isString(h)&&0<h.length?q=h:f.isString(e.options.apikey)&&(q=e.options.apikey);e.headers.push({key:"ak",value:q})}else e.headers.push({key:"as",value:b});q=f.isString(e.options.userToken)&&
0<e.options.userToken.length?e.options.userToken:!1;if(!0===d||q){var k=-1,p=e.headers.filter(function(b,c){return"ut"==b.key?(k=c,!0):!1});if(e.options.ignoreUserToken)-1!=k&&e.headers.splice(k,1);else{var r=q||m;1==p.length?e.headers.forEach(function(b){"ut"==b.key&&(b.value=r)}):e.headers.push({key:"ut",value:r})}}}});this.setUserAuthHeader=function(b,e,h){try{b&&(d=!0,m=b,h||(e||(e=-1),-1==e&&(e=null),c.LocalStorage.set("Appacitive-UserToken",b),c.LocalStorage.set("Appacitive-UserTokenExpiry",
e),c.LocalStorage.set("Appacitive-UserTokenDate",(new Date).getTime())))}catch(f){}};this.incrementExpiry=function(){try{c.runtime.isBrowser&&d&&c.LocalStorage.set("Appacitive-UserTokenDate",(new Date).getTime())}catch(b){}};this.removeUserAuthHeader=function(b,e){var h=c.Promise.buildPromise(e);b||c.User.trigger("logout",{});c.LocalStorage.remove("Appacitive-User");if(m&&b)try{var f=new c.HttpRequest(e);f.url=c.config.apiBaseUrl+c.storage.urlFactory.user.getInvalidateTokenUrl(m);f.method="POST";
f.data={};f.type="user";f.options=e;f.description="InvalidateToken user";f.onSuccess=f.onError=function(){d=!1;m=null;c.User.trigger("logout",{});c.LocalStorage.remove("Appacitive-UserToken");c.LocalStorage.remove("Appacitive-UserTokenExpiry");c.LocalStorage.remove("Appacitive-UserTokenDate");h.fulfill()};c.http.send(f);return h}catch(g){}else return d=!1,m=null,c.LocalStorage.remove("Appacitive-UserToken"),c.LocalStorage.remove("Appacitive-UserTokenExpiry"),c.LocalStorage.remove("Appacitive-UserTokenDate"),
h.fulfill()};this.isSessionValid=function(b){if(b.status){if(b.status.code&&("420"==b.status.code||"19027"==b.status.code||"19002"==b.status.code))return{status:!1,isSession:"19027"==b.status.code||"420"==b.status.code?!0:!1}}else if(b.code&&("420"==b.code||"19027"==b.code||"19002"==b.code))return{status:!1,isSession:"19027"==b.code||"420"==b.code?!0:!1};return{status:!0}};this.resetSession=function(){b=null;this.useApiKey=!0};this.get=function(){return b};this.setSession=function(c){c&&(b=c,this.useApiKey=
!1)};this.setApiKey=function(b){b&&(g=b,this.useApiKey=!0)};this.setMasterKey=function(b){h=b};this.reset=function(){this.removeUserAuthHeader();m=g=b=null;d=!1;h=null;this.useMasterKey=this.useApiKey=this.initialized=!1};var e="sandbox";this.environment=function(){if(1==arguments.length){var b=arguments[0];"sandbox"!=b&&"live"!=b&&(b="sandbox");e=b}return e}};c.getAppPrefix=function(f){return c.Session.environment()+"/"+c.appId+"/"+f};c.ping=function(f){if(!c.Session.initialized)throw Error("Initialize Appacitive SDK");
var b=new c._Request({method:"GET",type:"ping",op:"getPingUrl",options:f,onSuccess:function(c){return b.promise.fulfill(c.status)}});return b.send()};c.reset=function(){c.Session.reset()}})(global);(function(n){var c=n.Appacitive;c&&c.http&&(c.http.addProcessor({pre:function(f){var k=c.Session.environment();f.options=f.options||{};_type.isString(f.options.env)&&(k=f.options.env);f.headers.push({key:"e",value:k})}}),c.Events.mixin(c))})(global);
(function(n){var c=n.Appacitive,f=c.utils._type;c.GeoCoord=function(b,e){var l=function(b,c){if(isNaN(b)||isNaN(c))throw Error("Invalid Latitiude or longitiude provided");if(-90>b||90<b)throw Error("Latitude "+b+" should be in range of  -90.0 to 90.");if(-180>c||180<c)throw Error("Latitude "+c+" should be in range of  -180.0 to 180.");},d=function(b){if("string"!==typeof b||0==b.length)return!1;b=b.split(",");if(2!==b.length)return!1;try{return new c.GeoCoord(b[0],b[1])}catch(e){return!1}};if(f.isString(b)&&
!e&&(d=d(b)))return d;b&&e?(l(b,e),this.lat=b,this.lng=e):this.lng=this.lat=0;this.toJSON=function(){return{latitude:this.lat,longitude:this.lng}};this.getValue=function(){return String.format("{0},{1}",b,e)};this.toString=function(){return this.getValue()}};var k=function(){this.toString=function(){};this.Or=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new t(p.or,b)};this.And=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new t(p.and,
b)}},b=function(b){k.call(this);b=b||{};this.fieldType=b.fieldType;this.field=b.field||"";this.value=b.value;this.operator=b.operator;this.getFieldType=function(){switch(this.fieldType){case "property":return"*";case "attribute":return"@";case "aggregate":return"$";default:return"*"}};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue())}};b.prototype=new k;b.prototype.constructor=b;var g=function(e){e=e||"";
if(!f.isArray(e.value)||!e.value.length)throw Error("Specify field value as array");b.call(this,e);var l=function(b){return f.isString(b)?"'"+b+"'":f.isNumber(b)?b:f.isDate(b)?"datetime('"+c.Date.toISOString(b)+"')":"'"+b.toString()+"'"};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,l(this.value[c])));return"("+b.join(" or ")+")"}};g.prototype=new b;g.prototype.constructor=g;var m=
function(c){c=c||"";if(!f.isArray(c.value)||!c.value.length)throw Error("Specify field value as array");b.call(this,c);var e=function(b){return f.isString(b)?"'"+b+"'":f.isNumber(b)?b:b.toString()};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(e(this.value[c]));return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,b.join(","))}};m.prototype=new b;m.prototype.constructor=m;var d=function(c){b.call(this,c||"");this.toString=function(){return String.format("{0}{1} {2}",
this.getFieldType(),this.field.toLowerCase(),this.operator)}};d.prototype=new b;d.prototype.constructor=d;var h=function(c){c=c||"";if(!c.val1)throw Error("Specify field value1 ");if(!c.val2)throw Error("Specify field value2 ");this.val1=c.val1;this.val2=c.val2;b.call(this,c);delete this.value;this.toString=function(){return String.format("{0}{1} {2} ({3},{4})",this.getFieldType(),this.field.toLowerCase(),this.operator,this.val1.getValue(),this.val2.getValue())}};h.prototype=new b;h.prototype.constructor=
h;var e=function(e){e=e||"";if(!(e.geoCoord&&e.geoCoord instanceof c.GeoCoord))throw Error("withinCircle filter needs Appacitive.GeoCoord object as argument");b.call(this,e);this.value=e.geoCoord;this.unit=e.unit||"mi";this.distance=e.distance||5;this.toString=function(){return String.format("{0}{1} {2} {3},{4} {5}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue(),this.distance,this.unit)}};e.prototype=new b;e.prototype.constructor=h;var l=function(c){c=c||"";if(!c.geoCoords||
0===c.geoCoords.length)throw Error("polygon filter needs array of Appacitive.GeoCoord objects as argument");if(3>c.geoCoords.length)throw Error("polygon filter needs atleast 3 Appacitive.GeoCoord objects as arguments");b.call(this,c);this.value=c.geoCoords;var e=function(b){var c="";b.forEach(function(b){c=0===c.length?b.toString():c+(" | "+b.toString())});return c};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,e(this.value))}};
l.prototype=new b;l.prototype.constructor=h;var q=function(b){k.call(this);b=b||{};if(!b.tags||!f.isArray(b.tags)||0===b.tags.length)throw Error("Specify valid tags");this.tags=b.tags;this.operator=b.operator;this.toString=function(){return String.format("{0}('{1}')",this.operator,this.tags.join(","))}};q.prototype=new k;q.prototype.constructor=q;var t=function(b,c){if(!c||!c.length||2>c.length)throw Error("Provide valid or atleast 2 filters");this.operator=b;this.innerFilters=[];for(var e=0;e<c.length;e+=
1){if(!(c[e]instanceof k))throw Error("Invalid filter provided");this.innerFilters.push(c[e])}this.toString=function(){var b=this.operator,c="(";this.innerFilters.forEach(function(e){c=1===c.length?c+(" "+e.toString()):c+String.format(" {0} {1} ",b,e.toString())});return c+=")"}};t.prototype=new k;t.prototype.constructor=t;var p={isEqualTo:"==",notEqualTo:"<>",isGreaterThan:">",isGreaterThanEqualTo:">=",isLessThan:"<",isLessThanEqualTo:"<=",like:"like",match:"match",between:"between",withinCircle:"within_circle",
withinPolygon:"within_polygon",or:"or",and:"and",taggedWithAll:"tagged_with_all",taggedWithOneOrMore:"tagged_with_one_or_more",isNull:"is null",containedIn:"in",isNotNull:"is not null",notIn:"not in"},r=function(b,e){if(null===b||void 0===b||0===b.length)throw Error("Specify value");this.value=b;this.type=e?e:typeof this.value;if("number"===this.type&&!f.isNumeric(this.value))throw Error("Value should be numeric for filter expression");this.getValue=function(){return"number"===this.type||f.isBoolean(this.value)||
f.isNumber(this.value)?this.value:"object"===this.type&&f.isDate(this.value)?"datetime('"+c.Date.toISOString(this.value)+"')":"object"==this.type&&this.value instanceof c.GeoCoord?this.value.toString():"'"+this.value.toString()+"'"}},u=function(c,q,f){f||(f=this);f.type=c;f.name=q;f.equalTo=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.isEqualTo})};f.notEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.notEqualTo})};
f.greaterThan=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.isGreaterThan})};f.greaterThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.isGreaterThanEqualTo})};f.lessThan=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.isLessThan})};f.lessThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c),operator:p.isLessThanEqualTo})};f.like=function(c){return new b({field:this.name,
fieldType:this.type,value:new r("*"+c+"*"),operator:p.like})};f.match=function(c){return new b({field:this.name,fieldType:this.type,value:new r("*"+c+"*"),operator:p.match})};f.startsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new r(c+"*"),operator:p.like})};f.endsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new r("*"+c),operator:p.like})};f.contains=function(b){return new g({field:this.name,fieldType:this.type,value:b,operator:p.isEqualTo})};
f.containedIn=function(b){return new m({field:this.name,fieldType:this.type,value:b,operator:p.containedIn})};f.isNull=function(){return new d({field:this.name,fieldType:this.type,operator:p.isNull})};f.notIn=function(b){return new m({field:this.name,fieldType:this.type,value:b,operator:p.notIn})};f.isNotNull=function(){return new d({field:this.name,fieldType:this.type,operator:p.isNotNull})};f.between=function(b,c){return new h({field:this.name,fieldType:this.type,val1:new r(b),val2:new r(c),operator:p.between})};
f.withinCircle=function(b,c,l){return new e({field:this.name,fieldType:this.type,geoCoord:b,distance:c,unit:l,operator:p.withinCircle})};f.withinPolygon=function(b){return new l({field:this.name,fieldType:this.type,geoCoords:b,operator:p.withinPolygon})}},x=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;u("property",b,this);return this},y=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new u("aggregate",b);this.equalTo=function(b){return c.equalTo(b)};
this.notEqualTo=function(b){return c.notEqualTo(b)};this.greaterThan=function(b){return c.greaterThan(b)};this.greaterThanEqualTo=function(b){return c.greaterThanEqualTo(b)};this.lessThan=function(b){return c.lessThan(b)};this.lessThanEqualTo=function(b){return c.lessThanEqualTo(b)};this.between=function(b,e){return c.between(b,e)};this.contains=function(b){return c.contains(b)};return this},z=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new u("attribute",b);
this.like=function(b){return c.like(b)};this.match=function(b){return c.match(b)};this.startsWith=function(b){return c.startsWith(b)};this.endsWith=function(b){return c.endsWith(b)};this.equalTo=function(b){return c.equalTo(b)};this.notEqualTo=function(b){return c.notEqualTo(b)};this.contains=function(b){return c.contains(b)};this.containedIn=function(b){return c.containedIn(b)};this.notIn=function(b){return c.notIn(b)};this.isNull=function(){return c.isNull()};this.isNotNull=function(){return c.isNull()};
return this};c.Filter={Property:function(b){return new x(b)},Aggregate:function(b){return new y(b)},Attribute:function(b){return new z(b)},Or:function(){return new t(p.or,arguments)},And:function(){return new t(p.and,arguments)},taggedWithOneOrMore:function(b){return new q({tags:b,operator:p.taggedWithOneOrMore})},taggedWithAll:function(b){return new q({tags:b,operator:p.taggedWithAll})}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend;c.Queries={};var b=function(b){b=b||{};this._pageNumber=1;this._pageSize=null;this.isPageDefault=!0;this.pageNumber(b.pageNumber);this.pageSize(b.pageSize)};b.prototype.pageNumber=function(){return 1!=arguments.length||f.isNullOrUndefined(arguments[0])?this._pageNumber:(this._pageNumber=arguments[0]||1,this.isPageDefault=!1,this)};b.prototype.pageSize=function(){return 1!=arguments.length||f.isNullOrUndefined(arguments[0])?this._pageSize:
(this._pageSize=arguments[0],this.isPageDefault=!1,this)};b.prototype.resetPaging=function(){this._pageSize=null;this._pageNumber=1;this.isPageDefault=!0;return this};b.prototype.pageString=function(){return"pnum="+this._pageNumber+(this._pageSize?"&psize="+this._pageSize:"")};var g=function(b){b=b||{};this._isAscending=!1;this._order=[];this.isSortSet=!1;f.isNullOrUndefined(b.isAscending)||this.isAscending(b.isAscending);this.orderBy(b.orderBy);b.ascending&&this.ascending(b.ascending);b.descending&&
this.descending(b.descending)};g.prototype.orderBy=function(){return 1===arguments.length&&f.isString(arguments[0])?(this._order=[{orderBy:arguments[0],isAscending:this._isAscending}],this.isSortSet=!0,this):this._order[0]?this._order[0].orderBy:null};g.prototype.isAscending=function(){if(1===arguments.length){var b=void 0===arguments[0]||null==arguments[0]?!1:arguments[0];this._order.forEach(function(c){c.isAscending=b});this._isAscending=b;this.isSortSet=!0;return this}return 0<this._order.length?
order[0].isAscending:this._isAscending};g.prototype.resetSorting=function(){this._order=[];this.isSortSet=this._isAscending=!1;return this};g.prototype._setSorting=function(b,c){if(arguments.length){var e=this;b.forEach(function(b){Array.isArray(b)&&(b=b.join());b.replace(/\s/g,"").split(",").forEach(function(b){var l=e._order.findWhere({orderBy:b.toLowerCase()});l?l.isAscending=c:e._order.push({orderBy:b.toLowerCase(),isAscending:c})})});this.isSortSet=!0}return this};g.prototype.ascending=function(){return this._setSorting(Array.prototype.slice.call(arguments),
!0)};g.prototype.descending=function(){return this._setSorting(Array.prototype.slice.call(arguments),!1)};g.prototype.sortString=function(){return this._order&&0<this._order.length?"orderBy="+this._order.map(function(b){return b.orderBy+" "+(b.isAscending?"asc":"desc")}).join(","):""};n=function(){};n.prototype._setPaging=function(b){b&&(this.pageNumber(b.pagenumber),this.pageSize(b.pagesize),this.results=this.results||[],this.results.isLastPage=!1,this.results.total=b.totalrecords,this.results.pageNumber=
b.pagenumber,this.results.pageSize=b.pagesize,b.pagenumber*b.pagesize>=b.totalrecords&&(this.results.isLastPage=!0))};n.prototype.fields=function(){if(1===arguments.length){var b=arguments[0];f.isString(b)?this._fields=[b]:f.isArray(b)&&b.length&&(this._fields=b);return this}return this._fields};n.prototype._parse=function(b,h,e){b||(b=[]);var l="object"===this.type()?"Object":"Connection";return c[l]._parseResult(b,e.entity,h)};n.prototype.collection=function(b,h){h=h||{};f.isObject(b)&&(h=b,b=null);
b||(b=this.results?this.results:[]);var e=options.entity;!e&&0<b.length&&b[0]instanceof c.BaseObject&&(e="object"==b[0].type?"Object":"Connection",e=c[e]._getClass(b[0].className));e||(e="object"===_etype?"Object":"Connection",e=c[e]._getClass(this[e]));return new c.Collection(b,k(h,{model:e,query:this}))};n.prototype.fetchNext=function(b){var c=this.pageNumber();if(!c||0>=c)c=1;this.pageNumber(++c);return this.fetch(b)};n.prototype.fetchPrev=function(b){var c=this.pageNumber();--c;if(!c||0>=c)c=
1;this.pageNumber(c);return this.fetch(b)};n.prototype.count=function(b){var h=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){b=b||{};b=b.paginginfo;var c=0,c=b?b.totalrecords:0;h.fulfill(c)};b.promise=h;b.entity=this;return c.http.send(b)};var m=function(d){var h=d||{};b.call(this,d);g.call(this,d);var e="",l="",q=h.queryType||"BasicQuery",k=h.type||h.relation,p=h.relation?"connection":"object",r=this;this._fields=[];h.entity&&(this.entity=h.entity);this.type=function(){return p};
this.entityType=function(){return k};this.queryType=function(){return q};this.filter=function(){return 1===arguments.length?(e=arguments[0],this):e};this.freeText=function(){if(1===arguments.length){var b=arguments[0];f.isString(b)?l=arguments[0]:f.isArray(b)&&b.length&&(l=arguments[0].join(" "));return this}return l};this.filter(h.filter||"");this.freeText(h.freeText||"");this.fields(h.fields||[]);this.setFilter=function(b){this.filter(b)};this.setFreeText=function(b){this.freeText(b)};this.setFields=
function(b){this.fields(b)};this.extendOptions=function(c){for(var e in c)h[e]=c[e];b.call(this,h);g.call(this,h);return this};this.getQueryString=function(){var b=this.pageString(),c=this.sortString();c&&(b+="&"+c);this.filter()&&(c=encodeURIComponent(this.filter().toString()),0<c.trim().length&&(b+="&query="+c));this.freeText()&&0<this.freeText().trim().length&&(b+="&freetext="+encodeURIComponent(this.freeText())+"&language=en");this._fields&&0<this._fields.length&&(b+="&fields="+this._fields.join(","));
return b};this.toUrl=function(){return{url:c.config.apiBaseUrl+p+"/"+k+"/find/all?"+this.getQueryString(),description:"FindAll "+k+" "+p+"s"}};this.toRequest=function(b){var e=new c.HttpRequest,l=this.toUrl();e.url=l.url;e.options=b;e.description=l.description;e.method="get";return e};this.getOptions=function(){var b={},c;for(c in this)this.hasOwnProperty(c)&&!f.isFunction(this[c])&&(b[c]=this[c]);return b};this.fetch=function(b){var e=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){r.results=
r._parse(b[p+"s"],b.__meta,h);r._setPaging(b.paginginfo);e.fulfill(r.results,b.paginginfo)};b.promise=e;b.entity=this;return c.http.send(b)};this.fetch=function(b){var e=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){r.results=r._parse(b[p+"s"],b.__meta,h);r._setPaging(b.paginginfo);e.fulfill(r.results,b.paginginfo)};b.promise=e;b.entity=this;return c.http.send(b)}};k(m.prototype,n.prototype,g.prototype,b.prototype);c.Queries.FindAllQuery=function(b){b=b||{};if(!b.type&&!b.relation)throw Error("Specify either type or relation for basic filter query");
b.queryType="FindAllQuery";m.call(this,b);return this};c.Queries.FindAllQuery.prototype=new m;c.Queries.FindAllQuery.prototype.constructor=c.Queries.FindAllQuery;c.Query=c.Queries.FindAllQuery;c.Queries.ConnectedObjectsQuery=function(b){b=b||{};if(!b.relation)throw Error("Specify relation for connected objects query");if(!b.objectId)throw Error("Specify objectId for connected objects query");if(!b.type)throw Error("Specify type of object id for connected objects query");var h=b.type;delete b.type;
b.queryType="ConnectedObjectsQuery";m.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.type=h;b.object instanceof c.Object&&(this.object=b.object);this.returnEdge=!0;void 0===b.returnEdge||null===b.returnEdge||b.returnEdge||(this.returnEdge=!1);this.label="";var e=this;f.isString(b.label)&&0<b.label.length&&(this.label="&label="+b.label);this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/"+this.type+"/"+this.objectId+"/find?"+this.getQueryString()+
this.label+"&returnEdge="+this.returnEdge,description:"GetConnectedObjects for relation "+this.relation+" of type "+this.type+" for object "+this.objectId}};var l=function(b,l,d,h){var f=[];b.forEach(function(b){var e=b.__edge;delete b.__edge;var q=c.Object._create(k({__meta:d},b),!0);e&&(e.__endpointa=l,e.__endpointb={objectid:b.__id,label:e.__label,type:b.__type},delete e.label,q.connection=c.Connection._create(k({__meta:h},e),!0));f.push(q)});e.object&&(e.object.children[e.relation]=f);return f};
this.fetch=function(f){var g=c.Promise.buildPromise(f);f=this.toRequest(f);f.onSuccess=function(c){e.results=l(c.nodes?c.nodes:[],{objectid:b.objectId,type:h,label:c.parent},c.__nodemeta,c.__edgemeta);e._setPaging(c.paginginfo);g.fulfill(e.results,c.paginginfo)};f.promise=g;f.entity=this;return c.http.send(f)};return this};c.Queries.ConnectedObjectsQuery.prototype=new m;c.Queries.ConnectedObjectsQuery.prototype.constructor=c.Queries.ConnectedObjectsQuery;c.Queries.GetConnectionsQuery=function(b){b=
b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsQuery query");if(!b.objectId)throw Error("Specify objectId for GetConnectionsQuery query");if(!b.label||0===b.label.trim().length)throw Error("Specify label for GetConnectionsQuery query");b.type&&delete b.type;b.queryType="GetConnectionsQuery";m.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.label=b.label;this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/find/all?"+this.getQueryString()+
"&objectid="+this.objectId+"&label="+this.label,description:"FindAllConnections for relation "+this.relation+" from object id "+this.objectId}};return this};c.Queries.GetConnectionsQuery.prototype=new m;c.Queries.GetConnectionsQuery.prototype.constructor=c.Queries.GetConnectionsQuery;c.Queries.GetConnectionsBetweenObjectsQuery=function(b,h){b=b||{};delete b.entity;if(!b.objectAId||!f.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for GetConnectionsBetweenObjectsQuery query");
if(!b.objectBId||!f.isString(b.objectBId)||0===b.objectBId.length)throw Error("Specify objectBId for GetConnectionsBetweenObjectsQuery query");b.type&&delete b.type;b.queryType=h||"GetConnectionsBetweenObjectsQuery";m.call(this,b);this.objectAId=b.objectAId;this.objectBId=b.objectBId;this.label="GetConnectionsBetweenObjectsForRelationQuery"===this.queryType()&&b.label&&f.isString(b.label)&&0<b.label.length?"&label="+b.label:"";this.relation=b.relation&&f.isString(b.relation)&&0<b.relation.length?
b.relation+"/":"";this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"find/"+this.objectAId+"/"+this.objectBId+"?"+this.getQueryString()+this.label,description:"FindConnectionBetween for relation "+this.relation+" between object ids "+this.objectAId+" and "+this.objectBId}};return this};c.Queries.GetConnectionsBetweenObjectsQuery.prototype=new m;c.Queries.GetConnectionsBetweenObjectsQuery.prototype.constructor=c.Queries.GetConnectionsBetweenObjectsQuery;c.Queries.GetConnectionsBetweenObjectsForRelationQuery=
function(b){b=b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsBetweenObjectsForRelationQuery query");var h=new c.Queries.GetConnectionsBetweenObjectsQuery(b,"GetConnectionsBetweenObjectsForRelationQuery");h.fetch=function(e){var l=c.Promise.buildPromise(e);e=this.toRequest(e);e.onSuccess=function(e){h.results=e.connection?[c.Connection._create(k({__meta:e.__meta},e.connection),!0,b.entity)]:null;l.fulfill(h.results?h.results[0]:null)};e.promise=l;e.entity=this;return c.http.send(e)};
return h};c.Queries.InterconnectsQuery=function(b){b=b||{};delete b.entity;if(!b.objectAId||!f.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for InterconnectsQuery query");if(!(b.objectBIds&&f.isArray(b.objectBIds)&&0<b.objectBIds.length))throw Error("Specify list of objectBIds for InterconnectsQuery query");b.type&&delete b.type;b.queryType="InterconnectsQuery";m.call(this,b);this.objectAId=b.objectAId;this.objectBIds=b.objectBIds;this.toRequest=function(b){var e=
new c.HttpRequest,l=this.toUrl();e.url=l.url;e.options=b;e.description=l.description;e.method="post";e.data={object1id:this.objectAId,object2ids:this.objectBIds};return e};this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/interconnects?"+this.getQueryString(),description:"GetInterConnections between objects"}};return this};c.Queries.InterconnectsQuery.prototype=new m;c.Queries.InterconnectsQuery.prototype.constructor=c.Queries.InterconnectsQuery;c.Queries.GraphQuery=function(d,h,e){f.isObject(d)&&
(e=d,e.returnObjects=d.returnObjects||e.returnObjects,h=e.placeholders||{},d=e.name);if(!d||0===d.length)throw Error("Specify name of filter query");e=e||{};this.placeholders=h||{};this.returnObjects=e.returnObjects;b.call(this,e);g.call(this,e);this.name=d;this.queryType="GraphQuery";this.fields(e.fields||[]);var l=this;this.type=function(){return"object"};this.toRequest=function(b){var e=new c.HttpRequest,l=this.toUrl();e.url=l.url;e.options=b;e.description=l.description;e.method="post";this.data=
{};if(this.placeholders){this.data.placeholders=this.placeholders;for(var d in this.data.placeholders)this.data.placeholders[d]=this.data.placeholders[d]}e.data=this.data;return e};this.getQueryString=function(){var b=[];this.isPageDefault||b.push(this.pageString());this.isSortSet&&b.push(this.sortString());this._fields&&0<this._fields.length&&b.push("fields="+this._fields.join(","));return b.join("&")};this.toUrl=function(){return{url:c.config.apiBaseUrl+"search/"+this.name+"/"+(this.returnObjects?
"graphquery":"filter")+"?"+this.getQueryString(),description:"Filter Query with name "+this.name}};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){var c;l.returnObjects?(l.results=l._parse(b.objects,b.__meta,e),c=l.results):this.results=c=b.ids?b.ids:[];b.paginginfo&&l._setPaging(b.paginginfo);d.fulfill(c,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)}};k(c.Queries.GraphQuery.prototype,n.prototype,g.prototype,b.prototype);c.Queries.GraphAPI=
function(b,h,e){if(!b||0===b.length)throw Error("Specify name of project query");if(!h||!h.length)throw Error("Specify ids to project");this.name=b;this.data={ids:h};this.queryType="GraphApi";var l=this;if(e){this.data.placeholders=e;for(var q in this.data.placeholders)this.data.placeholders[q]=this.data.placeholders[q]}this.toRequest=function(b){var e=new c.HttpRequest,l=this.toUrl();e.url=l.url;e.description=l.description;e.method="post";e.data=this.data;e.options=b;return e};this.toUrl=function(){return{url:c.config.apiBaseUrl+
"search/"+this.name+"/project",description:"Project Query with name "+this.name}};var g=function(b){var e,l;for(l in b)if("status"!==l){e=b[l];break}var d=function(b,e,l,h,f){var q=[];b.forEach(function(b){var g=b.__children;delete b.__children;var p=b.__edge;delete b.__edge;b=c.Object._create(k({__meta:h},b),!0);b.children={};for(var r in g)b.children[r]=[],b.children[r]=d(g[r].values,g[r].parent,b.id,g[r].__nodemeta,g[r].__edgemeta);p&&(p.__endpointa={objectid:l,label:e},p.__endpointb={objectid:b.id,
label:p.__label},delete p.__label,b.connection=c.Connection._create(k({__meta:f},p),!0));q.push(b)});return q};return d(e.values,null,null,e.__nodemeta)};this.collection=function(b,e){e=e||{};f.isObject(b)&&(e=b,b=null);b||(b=this.results?ths.results:[]);var l;0<b.length&&b[0]instanceof c.BaseObject&&(l=c.Object._getClass(b[0].className));return new c.Collection(b,k(e,{model:l,query:this}))};this.fetch=function(b){var e=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){l.results=
g(b);e.fulfill(l.results)};b.promise=e;b.entity=this;return c.http.send(b)}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend,b={__utcdatecreated:"datetime",__utclastupdateddate:"datetime"},g=function(b){return f.isString(b)||f.isNumber(b)||f.isBoolean(b)},m=function(b){return b instanceof c.GeoCoord},d=function(b){b=b||{};var c={},e;for(e in b.__meta)b.__meta[e].forEach(function(b){c[b]=e});return c},h={integer:function(b){if(b){var c=parseInt(b);if(!isNaN(c))return c}return b},decimal:function(b){if(b){var c=parseFloat(b);if(!isNaN(c))return c}return b},
"boolean":function(b){return f.isBoolean(b)?b:void 0!==b&&null!==b&&("true"===b.toString().toLowerCase()||!0===b||0<b)?!0:!1},date:function(b){if(f.isDate(b))return b;if(b){var e=c.Date.parseISODate(b);if(e)return e}return b},datetime:function(b){if(f.isDate(b))return b;if(b){var e=c.Date.parseISODate(b);if(e)return e}return b},time:function(b){if(f.isDate(b))return b;if(b){var e=c.Date.parseISOTime(b);if(e)return e}return b},string:function(b){return b?b.toString():b},geocode:function(b){if(m(b))return b;
if(!f.isString(b)||0==b.trim().length)return!1;b=b.split(",");return 2!==b.length?!1:new c.GeoCoord(b[0],b[1])}};h["long"]=h.integer;h.geography=h.geocode;h.text=h.string;h.bool=h["boolean"];c.utils._cast=h;c.utils._cast.isString=g;c.utils._cast.isGeocode=m;var e=function(b){return f.isNullOrUndefined(b)?null:g(b)?b+"":f.isDate(b)?c.Date.toISOString(b):f.isObject(b)?m(b)?b.toString():b.getObject?b.getObject():b:b};c.utils._encode=function(b){var c={},d;for(d in b){var h=b[d];f.isArray(h)?(c[d]=[],
h.forEach(function(b){(b=e(b))&&c[d].push(b)})):c[d]=e(b[d])}return c};c.utils._decode=function(c){var e={},g=k({},b,d(c));delete c.__meta;for(var p in c)f.isArray(c[p])?(e[p]=[],c[p].forEach(function(b){b=g[p]?h[g[p]](b):b;e[p].push(b)})):f.isString(c[p])?e[p]=g[p]?h[g[p]](c[p]):c[p]:e[p]=c[p];return e}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend,b=c.utils._deepExtend,g=c.utils._cast,m=["__link","__endpointa","__endpointb"],d="__id __revision __endpointa __endpointb __createdby __lastmodifiedby __type __relationtype __typeid __relationid __utcdatecreated __utclastupdateddate __tags __authType __link __acls __meta".split(" "),h=function(b){return g.isString(b)||f.isDate(b)||g.isGeocode(b)};n=function(e,l){this._snapshot={};l=l||{};e=e||{};this.objectOptions=b({},e);this.meta=
{};this.objectOptions.__meta=k(this.meta,this.objectOptions.__meta);l&&l.parse&&(this.objectOptions=this.parse(this.objectOptions));this.defaults=c.utils._result(this,"defaults");f.isObject(this.defaults)&&!l.setSnapShot&&(this.objectOptions=b({},this._defaults,this.objectOptions));l&&l.collection&&(this.collection=l.collection);this.objectOptions=c.utils._decode(e);this.cid=parseInt(1E8*Math.random(),10);this.idAttribute="__id";this._atomicProps={};this._multivaluedProps={};this._setOps={};var d=
{};this._copy(this.objectOptions,d);l.setSnapShot&&this._copy(d,this._snapshot);!this._snapshot[this.idAttribute]&&d[this.idAttribute]&&(this._snapshot[this.idAttribute]=d[this.idAttribute]);this.id=this._snapshot[this.idAttribute];d.__type?(d.__type=d.__type.toLowerCase(),this.entityType="type",this.type="object",this.className=d.__type,this.base=c.Object.prototype):d.__relationtype&&(d.__relationtype=d.__relationtype.toLowerCase(),this.entityType="relation",this.type="connection",this.className=
d.__relationtype,this.base=c.Connection.prototype);"object"==this.type&&(this._destroyWithConnections=function(b){return this.destroy(k({deleteConnections:!0},b))});d.__attributes||(d.__attributes={});this._snapshot.__attributes||(this._snapshot.__attributes={});this._removeTags=[];d.__tags||(d.__tags=[]);this._snapshot.__tags||(this._snapshot.__tags=[]);this.attributes=this._object=d;this._fields="";this._mergePrivateFields(this.attributes)};k(n.prototype,{_copy:function(e,l){e.__meta=k(this.meta,
e.__meta);this.meta=e.__meta;this._mergePrivateFields(e);var d=c.utils._decode(e),g;for(g in d)g==this.idAttribute&&(this.id=d[g]),this._atomicProps[g]&&delete this._atomicProps[g],this._multivaluedProps[g]&&delete this._multivaluedProps[g],this._setOps[g]&&delete this._setOps[g],h(d[g])?l[g]=d[g]:f.isObject(d[g])?l[g]=b({},l[g],d[g]):f.isArray(d[g])?(l[g]=[],d[g].forEach(function(b){if(h(b)||"__link"==g)l[g].push(b);else throw Error("Multivalued property cannot add object or array as property of object");
})):l[g]=d[g]},_mergePrivateFields:function(b,l){var d={id:"id",__id:"id",__utclastupdateddate:"lastUpdatedAt",__utcdatecreated:"createdAt",__createdby:"createdBy",__updatedby:"lastUpdatedBy"},h=this;"id __id __utclastupdateddate __utcdatecreated __createdby __updatedby".split(" ").forEach(function(g){b[g]&&("__utcdatecreated"!==g&&"__utclastupdateddate"!==g||f.isDate(b[g])?h[d[g]]=b[g]:h[d[g]]=c.Date.parseISODate(b[g]),l&&delete b[g])})},_getOutpuStatus:function(b){b=b||{};b.message=b.message||"Server error";
b.code=b.code||"500";return b},getObject:function(){var e=c.utils._encode(b({__meta:this.meta},this._object));"connection"==this.type&&(e.__endpointa=this._object.__endpointa.toJSON(),e.__endpointb=this._object.__endpointb.toJSON());this.hasOwnProperty("id")&&(e.__id=this.id);return e},toJSON:function(c){if(c&&"object"==this.type){var l=function(b){var c=[];b.forEach(function(b){var e=b.toJSON();if(b.children&&!Object.isEmpty(b.children)){e.children={};for(var d in b.children)f.isArray(b.children[d])?
e[d]=l(b.children[d]):e[d]=l([b.children[d]])[0],e.children[d]=e[d]}b.connection&&(e.__connection=b.connection.toJSON());c.push(e)});return c};return l([this])[0]}c=b({__meta:this.meta},this._object);"connection"==this.type&&(this._object.__endpointa=this._object.__endpointa.toJSON(),this._object.__endpointb=this._object.__endpointb.toJSON());this.hasOwnProperty("id")&&this.id&&(c.__id=this.id);return c},properties:function(){var c=b({},this.attributes);delete c.__attributes;delete c.__tags;return c},
attr:function(){if(0===arguments.length)return this._object.__attributes||(this._object.__attributes={}),this._object.__attributes;if(1===arguments.length)return this._object.__attributes||(this._object.__attributes={}),this._object.__attributes[arguments[0]];if(2===arguments.length){if(!f.isString(arguments[1])&&null!==arguments[1])throw Error("only string values can be stored in attributes.");this._object.__attributes||(this._object.__attributes={});this._object.__attributes[arguments[0]]=arguments[1]}else throw Error(".attr() called with an incorrect number of arguments. 0, 1, 2 are supported.");
this.triggerChangeEvent("__attributes");return this._object.__attributes},getChangedAttributes:function(){if(this._object.__attributes){if(!this._snapshot.__attributes)return this._object.__attributes;var b=!1,c=JSON.parse(JSON.stringify(this._snapshot.__attributes)),d;for(d in this._object.__attributes)null==this._object.__attributes[d]||void 0==this._object.__attributes[d]?(c[d]=null,b=!0):this._object.__attributes[d]!=this._snapshot.__attributes[d]?(c[d]=this._object.__attributes[d],b=!0):this._object.__attributes[d]==
this._snapshot.__attributes[d]&&delete c[d];return b?c:void 0}},aggregate:function(){var b={},c;for(c in this._object){if(!this._object.hasOwnProperty(c))return;"$"==c[0]&&(b[c.substring(1)]=this._object[c])}if(0===arguments.length)return b;if(1==arguments.length)return b[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");},tags:function(){return this._object.__tags?this._object.__tags:[]},addTag:function(b){if(!b||!f.isString(b)||!b.length)return this;
this._object.__tags||(this._object.__tags=[]);this._object.__tags.push(b);this._object.__tags=Array.distinct(this._object.__tags);if(!_removeTags||!_removeTags.length)return this.triggerChangeEvent("__tags"),this;b=_removeTags.indexOf(b);-1!=b&&_removeTags.splice(b,1);this.triggerChangeEvent("__tags");return this},removeTag:function(b){if(!b||!f.isString(b)||!b.length)return this;this._removeTags.push(b);this._removeTags=Array.distinct(this._removeTags);if(!this._object.__tags||!this._object.__tags.length)return this.triggerChangeEvent("__tags"),
this;b=this._object.__tags.indexOf(b);-1!=b&&this._object.__tags.splice(b,1);this.triggerChangeEvent("__tags");return this},getChangedTags:function(){if(this._object.__tags){if(!this._snapshot.__tags)return this._object.__tags;var b=[],c=this;this._object.__tags.forEach(function(d){-1==c._snapshot.__tags.indexOf(d)&&b.push(d)});return 0<b.length?b:void 0}},getRemovedTags:function(){return this._removetags},_setMutliItems:function(b,c,d,g){if(!b||!f.isString(b)||0===b.length||0==b.trim().indexOf("__")||
0===b.trim().indexOf("$")||void 0==c||null==c)return this;b=b.toLowerCase();var k=this;try{var m=function(c){if(!h(c))throw Error("Multivalued property cannot have values of property as an object");if(k._object[b]&&f.isArray(k._object[b]))if("additems"==d)k._object[b].push(c);else if("adduniqueitems"==d){var l=-1;k._object[b].find(function(b,e){return f.isEqual(b,c)?(l=e,!0):!1});-1==l&&k._object[b].push(c)}else"removeitems"==d&&k._object[b].removeAll(c);else k._object[b]="removeitems"==d?[]:[c];
k._multivaluedProps[b]||(k._multivaluedProps[b]={additems:[],adduniqueitems:[],removeitems:[]});k._multivaluedProps[b][d].push(c)};f.isArray(c)?c.forEach(function(b){m(b)}):m(c);this.triggerChangeEvent(b,g)}catch(n){throw Error("Unable to add item to "+b);}return this},add:function(b,c,d){return this._setMutliItems(b,c,"additems",d)},addUnique:function(b,c,d){return this._setMutliItems(b,c,"adduniqueitems",d)},remove:function(b,c,d){return this._setMutliItems(b,c,"removeitems",d)},_hasChanged:function(b,
c,d,h){var g=void 0;f.isEqual(d,c)||("__tags"==b?(b=this.getChangedTags())&&0<b.length&&(g=b):"__attributes"==b?(b=this.getChangedAttributes(),Object.isEmpty(b)||(g=b)):f.isArray(d)?this._multivaluedProps[b]&&!this._setOps[b]?g=h?this._multivaluedProps[b]:d:d.equals(c)||(g=d):g=this._atomicProps[b]&&!this._setOps[b]?h?{incrementby:this._atomicProps[b].value}:d:d);return g},_getChanged:function(e){var l=!1,h=b({},this._snapshot),g;for(g in h)"$"==g[0]&&delete h[g];for(var f in this._object)g=this._hasChanged(f,
h[f],this._object[f],e),void 0===g?delete h[f]:(l=!0,h[f]=g);try{d.forEach(function(b){h[b]&&delete h[b]})}catch(k){}e&&(h=c.utils._encode(h));f=this.getChangedTags();e?(f&&0<f.length&&(h.__addtags=f,l=!0),this._removeTags&&0<this._removeTags.length&&(h.__removetags=this._removeTags,l=!0)):f&&0<f.length&&(h.__tags=f,l=!0);(e=this.getChangedAttributes())&&!Object.isEmpty(e)?(h.__attributes=e,l=!0):delete h.__attributes;"object"==this.type&&this._aclFactory&&(e=this._aclFactory.getChanged())&&(l=!0,
h.__acls=e);return l&&!Object.isEmpty(h)?h:!1},changed:function(){return this.isNew()?this.toJSON():this._getChanged()},hasChanged:function(){return this.isNew()?!0:0===arguments.length?Object.isEmpty(this._getChanged(!0))?!1:!0:1==arguments.length&&f.isString(arguments[0])&&0<arguments[0].length?void 0==this._hasChanged(arguments[0],this._snapshot[arguments[0]],this._object[arguments[0]])?!1:!0:!1},changedAttributes:function(){if(this.isNew())return this.toJSON();if(0===arguments.length)return this._getChanged();
if(1==arguments.length&&f.isArray(arguments[0])&&arguments[0].length){var b={},c=this;arguments[0].forEach(function(d){d=c._hasChanged(d,c._snapshot[d],c._object[d]);void 0!=d&&b.push(d)});return b}return!1},previous:function(){return this.isNew()?null:1==arguments.length&&f.isString(arguments[0])&&arguments[0].length?this._snapshot[arguments[0]]:null},previousAttributes:function(){return this.isNew()?null:k({},this._snapshot)},fields:function(){if(1==arguments.length){var b=arguments[0];f.isString(b)?
this._fields=b:f.isArray(b)&&(this._fields=b.join(","));return this}return this._fields},get:function(b,c){if(b){if(c&&g[c.toLowerCase()]){if(g[c.toLowerCase()])return g[c.toLowerCase()](this._object[b]);throw Error('Invalid cast-type "'+c+'"" provided for get "'+b+'"');}return this._object[b]}},tryGet:function(b,c,d){b=this.get(b,d);return void 0!==b?b:c},triggerChangeEvent:function(b,c){if(c&&!c.silent){var h=this._hasChanged(b,this._snapshot[b],this._object[b]);if(void 0!=h[b]||-1!=d.indexOf(b))this.trigger("change:"+
b,this,h[b]||this._object[b],{}),c.ignoreChange||this.trigger("change",this,c)}},triggerDestroy:function(b){b&&!b.silent&&this.trigger("destroy",this,this.collection,b)},_triggerError:function(b,c){b.silent||this.trigger("error",this,c,b)},_set:function(b,c,d){if(!b||!f.isString(b)||0===b.length||0===b.trim().indexOf("$"))return this;var g=this;b=b.toLowerCase();try{if(f.isNullOrUndefined(c))this._object[b]=null;else if(h(c))this._object[b]=c;else if(f.isObject(c))if(-1!==m.indexOf(b))this._object[b]=
c;else throw Error("Property cannot have value as an object");else f.isArray(c)&&(this._object[b]=[],c.forEach(function(c){if(h(c))g._object[b].push(c);else throw Error("Multivalued property cannot have values of property as an object");}));delete this._atomicProps[b];delete this._multivaluedProps[b];delete this._setOps[b];f.isEqual(this._object[b],this._snapshot[b])||(this._setOps[b]=!0);b==this.idAttribute&&(this.id=c);return this}catch(k){throw Error("Unable to set "+b);}},set:function(b,c,h){var f,
g;if(null==b)return this;null==b||"object"===typeof b?(g=b,h=c):(g={})[b]=c;h||(h={});if(!this._validate(g,h))return!1;this.idAttribute in g&&(this.id=g[this.idAttribute]);this._mergePrivateFields(g);var m=!1;for(f in g)c=g[f],this._set(f,c,k({},h,{ignoreChange:!0}));if(h&&!h.silent)for(f in g)if(void 0!=this._hasChanged(f,this._snapshot[f],this._object[f])||-1!=d.indexOf(f))m=!0,this.trigger("change:"+b,this,this._object[b],{});m&&this.trigger("change",this,h);return this},unset:function(b,c){if(!b||
!f.isString(b)||0===b.length||0===b.indexOf("__"))return this;b=b.toLowerCase();delete this._object[b];this.triggerChangeEvent(b,c);return this},_validate:function(b,c){if(!c.validate||!this.validate||!f.isFunction(this.validate))return!0;b=k({},this.attributes,b);var d=this.validationError=this.validate(b,c)||null;if(!d)return!0;this.trigger("invalid",this,d,k(c,{validationError:d}));return!1},isValid:function(b){return this._validate({},k(b||{},{validate:!0}))},has:function(b){return b&&f.isString(b)&&
0!==b.length?this._object[b]&&!f.isUndefined(this._object[b])?!0:!1:!1},isNew:function(){return!(!f.isNullOrUndefined(this.id)||this.has(this.idAttribute))},clone:function(){return"object"==this.type?c.Object._create(b({__meta:this.meta},this.getObject())):c.Connection._create(b({__meta:this.meta},this.getObject()))},copy:function(b,c){b&&(this._copy(b,this._object),c&&this._copy(b,this._snapshot));return this},mergeWithPrevious:function(){this._copy(this._object,this._snapshot);this._aclFactory&&
this._aclFactory.merge();this._mergePrivateFields(this._snapshot);this._removeTags=[];this._atomicProps={};this._multivaluedProps={};this._setOps={};return this},_merge:function(){this._copy(this._snapshot,this._object);this._aclFactory&&this._aclFactory.merge();this._mergePrivateFields(this._object);this._removeTags=[];this._atomicProps={};this._multivaluedProps={};this._setOps={}},rollback:function(){this._object=this.raw={};this._merge();return this},_atomic:function(b,c,d,h){if(!b||!f.isString(b)||
0===b.length||0===b.indexOf("__"))return this;b=b.toLowerCase();if(f.isObject(this._object[b])||f.isArray(this._object[b]))throw Error("Cannot increment/decrement array/object");try{f.isObject(c)?(h=c,c=d):c=!c||isNaN(Number(c))?d:Number(c)*d,this._object[b]=isNaN(Number(this._object[b]))?c:Number(this._object[b])+c,this.isNew()||(this._atomicProps[b]={value:(this._atomicProps[b]?this._atomicProps[b].value:0)+c})}catch(g){throw Error("Cannot perform increment/decrement operation");}this.triggerChangeEvent(b,
h);return this},increment:function(b,c,d){return this._atomic(b,c,1,d)},decrement:function(b,c,d){return this._atomic(b,c,-1,d)},_findUnsavedChanges:function(){var b={object:null,isNested:!1};if(this.id)b.object=this._getChanged(!0);else{var c=this.getObject();delete c.__meta;for(var d in c)"$"==d[0]&&delete c[d];c.__revision&&delete c.__revision;"object"==this.type&&this._aclFactory&&(d=this._aclFactory.getChanged())&&(c.__acls=d);c.__tags&&0==c.__tags.length&&delete c.__tags;Object.isEmpty(c.__attributes)&&
delete c.__attributes;"connection"==this.type&&(c.__endpointa.objectid&&delete c.__endpointa.object,c.__endpointb.objectid&&delete c.__endpointb.object);b.object=c}return b},getType:function(){var b=this.type;!this._object.__type||"user"!=this._object.__type.toLowerCase()&&"device"!=this._object.__type.toLowerCase()||(b=this._object.__type.toLowerCase());return b},_parseOutput:function(b,d){var h=this.getType(),f;b=b||{};if(d&&d[h]){b&&b.parse&&(d[h]=this.parse(d[h]));var g=this.isNew(),m=!1;"connection"==
this.type&&this._object.__endpointa&&d[h].__endpointa.label!=this._object.__endpointa.label&&(m=d[h].__endpointa,d[h].__endpointa=d[h].__endpointb,d[h].__endpointb=m,m=!0);this._snapshot=c.utils._decode(k({__meta:k(this.meta,d.__meta)},d[h]));this.id=this._object[this.idAttribute]=d[h][this.idAttribute];this._merge();g?("connection"==this.type&&(b._batch||(m?(this._object.__endpointa.object&&d.__bmeta&&(this._object.__endpointa.object.__meta=d.__bmeta),this._object.__endpointb.object&&d.__ameta&&
(this._object.__endpointb.object.__meta=d.__ameta)):(this._object.__endpointa.object&&d.__ameta&&(this._object.__endpointa.object.__meta=d.__ameta),this._object.__endpointb.object&&d.__bmeta&&(this._object.__endpointb.object.__meta=d.__bmeta))),this.parseConnection(b._batch)),this.trigger("change:__id",this,this.id,{}),c.eventManager.fire(this.entityType+"."+h+".created",this,{object:this}),this.created=!0):c.eventManager.fire(this.entityType+"."+h+"."+this.id+".updated",this,{object:this});b.silent||
this.trigger("sync",this,d[h],b)}else d=d||{},d.status=d.status||{},f=this._getOutpuStatus(d.status),this._triggerError(b,new c.Error(f)),this.isNew()?c.eventManager.fire(this.entityType+"."+h+".createFailed",this,{error:f}):c.eventManager.fire(this.entityType+"."+h+"."+this.id+".updateFailed",this,{object:f});return f},_save:function(){return this.id?this._update(arguments):this._create(arguments)},_create:function(b){b=b||{};var d=this.getType(),h=this._findUnsavedChanges(),f=this,g=new c._Request({method:"PUT",
type:d,op:"getCreateUrl",args:[this.className,this._fields],data:h.object,options:b,entity:f,onSuccess:function(c){(c=f._parseOutput(b,c))?g.promise.reject(c,f):g.promise.fulfill(f)}});return g.send()},_update:function(b,d){c.Promise.is(d)||(d=c.Promise.buildPromise(b));var h=this._findUnsavedChanges(),f=this;b=b||{};if(Object.isEmpty(h.object))d.fulfill(this);else{var g=this.type,k=[this.className,this.id,this._fields];this._object&&this._object.__type&&("user"==this._object.__type.toLowerCase()||
"device"==this._object.__type.toLowerCase())&&(g=this._object.__type.toLowerCase(),k.splice(0,1));var m=new c._Request({method:"POST",type:g,op:"getUpdateUrl",args:k,data:h.object,options:b,entity:this,onSuccess:function(c){(c=f._parseOutput(b,c))?m.promise.reject(c,f):m.promise.fulfill(f)}});return m.send()}return d},_fetch:function(b){if(!this.id)throw Error("Please specify id for get operation");b=b||{};var d=this.getType(),h=this,f=new c._Request({method:"GET",type:d,op:"getGetUrl",args:[this.className,
this.id,this._fields],options:b,entity:h,onSuccess:function(g){g&&g[d]?(b&&b.parse&&(g[d]=h.parse(g[d])),h._snapshot=c.utils._decode(k({__meta:k(h.meta,g.__meta)},g[d])),h._copy(h._snapshot,h._object),h._mergePrivateFields(h._object),h._aclFactory&&h._aclFactory._rollback(),g.connection&&(h.endpoints||h.endpointA&&h.endpointB||h.setupConnection(h._object.__endpointa,h._object.__endpointb)),b.silent||h.trigger("sync",h,g[d],b),c.eventManager.fire(h.entityType+"."+d+"."+h.id+".fetched",h,{object:h}),
f.promise.fulfill(h)):(g=g||{},g.status=g.status||{},g.status=_getOutpuStatus(g.status),h._triggerError(b,new c.Error(g.status)),f.promise.reject(g.status,h))}});return f.send()},_destroy:function(b){b=b||{};var d=b.deleteConnections,h=this;f.isBoolean(b)&&(d=b,b={});b.wait||this.triggerDestroy(b);if(!this.id)return(new c.Promise.buildPromise(b)).fulfill();var g=this.getType(),k=new c._Request({method:"DELETE",type:g,op:"getDeleteUrl",args:[this.className,this.id,d],options:b,entity:this,onSuccess:function(d){d&&
d.status?(h._object={},h._snapshot={},b.wait&&h.triggerDestroy(b),k.promise.fulfill(d.status)):(d=d||{},d.status=d.status||{},d.status=h._getOutpuStatus(d.status),h._triggerError(b,new c.Error(d.status)),k.promise.reject(d.status,h))}});return k.send()},save:function(){return this._save.apply(this,arguments)},fetch:function(){return this._fetch.apply(this,arguments)},destroy:function(){return this._destroy.apply(this,arguments)},destroyWithConnections:function(){return this._destroyWithConnections.apply(this,
arguments)},toString:function(){return JSON.stringify(this.getObject())},parse:function(b,c){return b},escape:function(b){return _.escape(this.get(b))}});c.BaseObject=n;c.BaseObject._saveAll=function(b,d,h){var g=new c.Batch;d=d||{};if(!f.isArray(b))throw Error("Provide an array of objects for Object.saveAll");b.forEach(function(b){b instanceof c.BaseObject||!f.isObject(b)||(b=new c[this.className||h](b));g.add(b)});return g.execute(d)};n.prototype.del=n.prototype._destroy;c.Events.mixin(c.BaseObject.prototype)})(global);
(function(n){var c=function(){return Math.floor(65536*Math.random()).toString(16)};n.Appacitive.GUID=function(){var f=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c(),k="",b,g,m,d,h,e,l=0,f=f.replace(/\r\n/g,"\n");g="";for(m=0;m<f.length;m++)d=f.charCodeAt(m),128>d?g+=String.fromCharCode(d):(127<d&&2048>d?g+=String.fromCharCode(d>>6|192):(g+=String.fromCharCode(d>>12|224),g+=String.fromCharCode(d>>6&63|128)),g+=String.fromCharCode(d&63|128));for(f=g;l<f.length;)b=f.charCodeAt(l++),g=f.charCodeAt(l++),
m=f.charCodeAt(l++),d=b>>2,b=(b&3)<<4|g>>4,h=(g&15)<<2|m>>6,e=m&63,isNaN(g)?h=e=64:isNaN(m)&&(e=64),k=k+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);return k.toString()}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=["allow","deny"],b=["create","read","update","delete","manageaccess"],g=function(c){var d=[];c.forEach(function(c){f.isString(c)&&-1!=b.indexOf(c.toLowerCase())&&d.push(c.toLowerCase())});return d};c._Acl=function(m,d){var h=m||[];f.isArray(h)||(h=[]);var e={};d&&(e=JSON.parse(JSON.stringify(h)));this.acls=h=JSON.parse(JSON.stringify(h));var l=[],q=function(b,e,d,f){if(!d)throw Error("Specify valid user or usergroup");d instanceof c.Object&&"user"==
d.typeName&&!d.isNew()&&(d=d.id);var m=h.filter(function(b){return b.sid==d&&b.type==e});m&&0!=m.length?m=m[0]:(m={sid:d,type:e,deny:[],allow:[]},h.push(m));m.allow||(m.allow=[]);m.deny||(m.deny=[]);f=g(f);var q=l.filter(function(b){return b.sid==d&&b.type==e});q&&0!=q.length?q=q[0]:(q={sid:d,type:e},l.push(q));f.forEach(function(c){for(var e=0;e<k.length;e+=1){var d=m[k[e]].indexOf(c);if(-1!=d){m[k[e]].splice(d,1);break}}"dontcare"!=b&&m[b].push(c);q[c]=b});return this},n=function(b,c,e,d){if(!e)throw Error("Please provide valid id or name for setting acls");
if(!d)throw Error("Please provide valid access permissions for setting acls");f.isArray(d)||(d=[d]);f.isArray(e)?e.forEach(function(e){q(b,c,e,d)}):q(b,c,e,d);return this},p=function(){h.allowUser=function(b,c){return n.apply(this,["allow","user",b,c])};h.allowGroup=function(b,c){return n.apply(this,["allow","usergroup",b,c])};h.denyUser=function(b,c){return n.apply(this,["deny","user",b,c])};h.denyGroup=function(b,c){return n.apply(this,["deny","usergroup",b,c])};h.resetUser=function(b,c){return n.apply(this,
["dontcare","user",b,c])};h.resetGroup=function(b,c){return n.apply(this,["dontcare","usergroup",b,c])};h.allowAnonymous=function(b){return n.apply(this,["allow","usergroup",["anonymous"],b])};h.denyAnonymous=function(b){return n.apply(this,["deny","usergroup",["anonymous"],b])};h.resetAnonymous=function(b){return n.apply(this,["dontcare","usergroup",["anonymous"],b])};h.allowLoggedIn=function(b){return n.apply(this,["allow","usergroup",["anonymous"],b])};h.denyLoggedIn=function(b){return n.apply(this,
["deny","usergroup",["anonymous"],b])};h.resetLoggedIn=function(b){return n.apply(this,["dontcare","usergroup",["anonymous"],b])}};this._rollback=function(){l=[];h=JSON.parse(JSON.stringify(e));p();return this};this.toJSON=this.getChanged=function(){var c=[];l.forEach(function(e){var d={sid:e.sid,type:e.type,allow:[],deny:[],dontcare:[]};b.forEach(function(b){e[b]&&d[e[b]].push(b)});k.forEach(function(b){0==d[b].length&&delete d[b]});0==d.dontcare.length&&delete d.dontcare;c.push(d)});return 0==c.length?
null:c};this.merge=function(){l=[];return this};p();return this};c.Group=new function(){var b=function(b,h,e,g){if(!h||!f.isString(h)||0===h.length)throw Error("Please specify valid groupname");f.isArray(e)||(e=[e]);var k={};k[b]=[];e.forEach(function(e){e&&(e instanceof c.Object&&"user"==e.typeName&&!e.isNew()?k[b].push(e.id):f.isString(e)&&k[b].push(e))});if(0==k[b].length)throw Error("Please specify valid members as second argument");var m=new c._Request({method:"POST",type:"usergroup",op:"getUpdateUrl",
args:[h],data:k,entity:this,options:g,onSuccess:function(b){m.promise.fulfill(b)}});return m.send()};this.addMembers=function(c,h,e){return b("add",c,h)};this.removeMembers=function(c,h,e){return b("remove",c,h)}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend;c.Object=function(b,h){b=b||{};h=h||{};this.className&&(b.__type=this.className);f.isString(b)&&(b={__type:b});if(!b.__type)throw Error("Cannot set object without __type");f.isBoolean(h)&&(h={setSnapShot:!0});c.BaseObject.call(this,b,h);this.type="object";this.getObject=this.getObject;this.children={};this.typeName=b.__type;this._aclFactory=new c._Acl(h.__acls,h.setSnapShot);this.acls=this._aclFactory.acls;f.isFunction(this.initialize)&&
this.initialize.apply(this,[b]);return this};c.Object.prototype=new c.BaseObject;c.Object.prototype.constructor=c.Object;c.Object.extend=function(d,h,e){f.isObject(d)&&(e=h,h=d,d=h.typeName);if(!f.isString(d)||0==d.length)throw Error("Appacitive.Object.extend's first argument should be the type-name.");var g=null;h=h||{};h.className=d;g=c.utils.classExtend(c.Object,h,e);delete g.extend;g.className=d;g.type=d;return b[d]=g};var b={},g=function(d){if(!f.isString(d))throw"_getClass requires a string argument.";
var h=b[d];h||(h=c.Object.extend(d),b[d]=h);return h};c.Object._getClass=g;c.Object._create=function(b,c,e){return(new (this.className?this:e?e:g(b.__type))(b)).copy(b,c)};var m=function(b,h,e){var g=[];b.forEach(function(b){b=c.Object._create(k(b,{__meta:e}),!0,h);g.push(b)});return g};c.Object._parseResult=m;c.Object.multiDelete=function(b,h){b=b||{};h=h||{};var e=[];this.className&&(b.type=this.className);f.isArray(b)&&0<b.length&&(b[0]instanceof c.Object?(e=b,b={type:e[0].className,ids:e.map(function(b){return b.id}).filter(function(b){return b})}):
b={type:this.className,ids:b});if(!b.type||!f.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if("user"===b.type.toLowerCase()||"device"===b.type.toLowerCase())throw Error("Cannot delete user and devices using multidelete");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var g=new c._Request({method:"POST",data:{idlist:b.ids},type:"object",op:"getMultiDeleteUrl",args:[b.type],options:h,onSuccess:function(b){h&&!h.silent&&e.forEach(function(b){b.trigger("destroy",
b,b.collection,h)});g.promise.fulfill()}});return g.send()};c.Object.multiGet=function(b,h){b=b||{};h=h||{};f.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Object?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type||!f.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var e=new c._Request({method:"GET",type:"object",op:"getMultiGetUrl",
args:[b.type,b.ids.join(","),b.fields],options:h,onSuccess:function(c){e.promise.fulfill(m(c.objects,b.entity,c.__meta))}});return e.send()};c.Object.get=function(b,h){b=b||{};f.isString(b)&&this.className&&(b={id:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type)throw Error("Specify type");if(!b.id)throw Error("Specify id to fetch");var e=c.Object._create({__type:b.type,__id:b.id});e.fields=b.fields;return e.fetch(h)};c.Object.prototype.getConnections=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");
b.objectId=this.get("__id");return new c.Queries.GetConnectionsQuery(b)};c.Object.prototype.getConnectedObjects=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");b=b||{};f.isString(b)&&(b={relation:b});b.type=this.get("__type");b.objectId=this.get("__id");b.object=this;return new c.Queries.ConnectedObjectsQuery(b)};c.Object.prototype.fetchConnectedObjects=c.Object.prototype.getConnectedObjects;c.Object.findAll=c.Object.findAllQuery=function(b){b=b||{};this.className&&
(b.type=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Object.saveAll=function(b,h){return c.BaseObject._saveAll(b,h,"Object")}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend,b=function(b,d,h){var g={label:b.label};b.objectid&&(g.objectid=b.objectid);if(b.object)b.object instanceof c.Object?b.object.id&&(b.objectid=g.objectid=b.object.id):f.isObject(b.object)&&(b.object.__id&&(b.objectid=g.objectid=b.object.__id),b.object=c.Object._create(b.object)),g.object=b.object.getObject();else if(!g.objectid&&!g.object)throw Error("Incorrectly configured endpoints provided to parseConnection");g.toJSON=function(){var c=
k({},this);if(c.object&&(c.object=b.object.toJSON(),b.object._aclFactory)){var d=b.object._aclFactory.toJSON();d&&(c.object.__acls=d)}delete c.toJSON;return c};h["endpoint"+d]=b;return g},g=function(b,d,h,g){b.object&&f.isObject(b.object)?(g||(h["endpoint"+d]?h["endpoint"+d]&&h["endpoint"+d].object&&h["endpoint"+d].object instanceof c.Object?h["endpoint"+d].object.copy(b.object,!0):h["endpoint"+d].object=c.Object._create(b.object,!0):(h["endpoint"+d]={},h["endpoint"+d].object=c.Object._create(b.object,
!0)),h["endpoint"+d]._aclFactory&&h["endpoint"+d]._aclFactory.merge(),g=h["endpoint"+d].object,g.trigger("change:__id",g,g.id,{})),h["endpoint"+d].objectid=b.objectid||b.object.__id,h["endpoint"+d].label=b.label,h["endpoint"+d].type=b.type):h["endpoint"+d]=b;b.toJSON=function(){var b=k({},this);if(b.object&&(b.object=h["endpoint"+d].object.toJSON(),h["endpoint"+d].object._aclFactory)){var c=h["endpoint"+d].object._aclFactory.toJSON();c&&(b.object.__acls=c)}delete b.toJSON;return b}};c.Connection=
function(b,d){b=b||{};d=d||{};this.className&&(b.__relationtype=this.className);f.isString(b)&&(b={__relationtype:b});if(!b.__relationtype&&!b.relation)throw Error("Cannot set connection without relation");b.relation&&(b.__relationtype=b.relation,delete b.relation);f.isBoolean(d)&&(d={setSnapShot:!0});b.endpoints&&2===b.endpoints.length&&(b.__endpointa=b.endpoints[0],b.__endpointb=b.endpoints[1],delete b.endpoints);c.BaseObject.call(this,b,d);this.type="connection";this.getConnection=this.getObject;
this.parseConnection=function(c){var d="A",h="B";b.__endpointa.label.toLowerCase()!==this.get("__endpointb").label.toLowerCase()||b.__endpointa.label.toLowerCase()==b.__endpointb.label.toLowerCase()||b.__endpointa.objectid!=this.get("__endpointb").objectid&&b.__endpointa.objectid||(d="B",h="A");g(this.get("__endpointa"),d,this,c);g(this.get("__endpointb"),h,this,c);this.endpoints=function(){if(1===arguments.length&&f.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;
if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b};return this};d.setSnapShot?this.parseConnection(b):b.__endpointa&&b.__endpointb&&this.setupConnection(this.get("__endpointa"),this.get("__endpointb"));this.relationName=b.__relationtype;f.isFunction(this.initialize)&&this.initialize.apply(this,[b]);return this};c.Connection.prototype=new c.BaseObject;c.Connection.prototype.constructor=
c.Connection;c.Connection.extend=function(b,d,h){f.isObject(b)&&(h=d,d=b,b=d.relationName);if(!f.isString(b))throw Error("Appacitive.Connection.extend's first argument should be the relationName.");var g=null;d=d||{};d.className=b;g=c.utils.classExtend(c.Connection,d,h);delete g.extend;g.className=b;g.relation=b;return m[b]=g};var m={},d=function(b){if(!f.isString(b))throw"_getClass requires a string argument.";var d=m[b];d||(d=c.Connection.extend(b),m[b]=d);return d};c.Connection._getClass=d;c.Connection._create=
function(b,c,h){return(new (this.className?this:h?h:d(b.__relationtype))(b)).copy(b,c)};var h=function(b,d,h){var g=[];b||(b=[]);b.forEach(function(b){g.push(c.Connection._create(k(b,{__meta:h}),!0,d))});return g};c.Connection._parseResult=h;c.Connection.prototype.setupConnection=function(c,d){if(!(c&&(c.objectid||c.object)&&c.label&&d&&(d.objectid||d.object)&&d.label))throw Error("Incorrect endpoints configuration passed.");this.set("__endpointa",b(c,"A",this),{silent:!0});this.set("__endpointb",
b(d,"B",this),{silent:!0});this.endpoints=function(){if(1===arguments.length&&f.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b}};c.Connection.get=function(b,d){b=b||{};f.isString(b)&&this.className&&(b={id:b});this.className&&(b.relation=this.className,
b.entity=this);if(!b.relation)throw Error("Specify relation");if(!b.id)throw Error("Specify id to fetch");var h=c.Connection._create({__relationtype:b.relation,__id:b.id});h.fields=b.fields;return h.fetch(d)};c.Connection.multiGet=function(b,d){b=b||{};d=d||{};f.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Connection?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.relation=this.className,b.entity=this);if(!b.relation||!f.isString(b.relation)||0===b.relation.length)throw Error("Specify valid relation");
if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var g=new c._Request({method:"GET",type:"connection",op:"getMultiGetUrl",args:[b.relation,b.ids.join(","),b.fields],options:d,onSuccess:function(c){g.promise.fulfill(h(c.connections,b.entity,c.__meta))}});return g.send()};c.Connection.multiDelete=function(b,d){b=b||{};d=d||{};var h=[];this.className&&(b.relation=this.className);f.isArray(b)&&0<b.length&&(b[0]instanceof c.Connection?(h=b,b={relation:h[0].className,ids:h.map(function(b){return b.id}).filter(function(b){return b})}):
b={relation:this.className,ids:b});if(!b.relation||!f.isString(b.relation)||0===b.relation.length)throw Error("Specify valid relation");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var g=new c._Request({method:"POST",data:{idlist:b.ids},type:"connection",op:"getMultiDeleteUrl",args:[b.relation],options:d,onSuccess:function(b){d&&!d.silent&&h.forEach(function(b){b.trigger("destroy",b,b.collection,d)});g.promise.fulfill()}});return g.send()};c.Connection.findAll=c.Connection.findAllQuery=
function(b){b=b||{};this.className&&(b.relation=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Connection.interconnectsQuery=c.Connection.getInterconnects=function(b){return new c.Queries.InterconnectsQuery(b)};c.Connection.betweenObjectsQuery=c.Connection.getBetweenObjects=function(b){return new c.Queries.GetConnectionsBetweenObjectsQuery(b)};c.Connection.betweenObjectsForRelationQuery=c.Connection.getBetweenObjectsForRelation=function(b){b=b||{};this.className&&(b.relation=
this.className,b.entity=this);return new c.Queries.GetConnectionsBetweenObjectsForRelationQuery(b)};c.Connection.saveAll=function(b,d){return c.BaseObject._saveAll(b,d,"Connection")}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend,b=function(b,d){b=b||{};b.__type="user";c.Object.call(this,b,d);return this},g=null;b.currentUser=b.current=function(){return g};var m=function(b,d){var g=this.get("__id");if(!this.get("__id"))return this.set("__link",b),c.Promise.buildPromise(d).fulfill(this);var k=this,m=new c._Request({method:"POST",type:"user",op:"getLinkAccountUrl",args:[g],options:d,data:b,entity:this,onSuccess:function(c){c=k.get("__link");f.isArray(c)||(c=c?
[c]:[]);c.push(b);k.copy({__link:c},!0);m.promise.fulfill(k)}});return m.send()};b.setCurrentUser=function(b,d,f){if(!b)throw Error("Cannot set null object as user");var k=b;if(k instanceof c.User)if(k.get("__id")&&0!==k.get("__id").length)b=k.getObject();else throw Error("Specify user __id");else k=new c.User(b,!0);c.LocalStorage.set("Appacitive-User",b);f||(f=864E5);g=k;d&&c.Session.setUserAuthHeader(d,f);g.logout=function(b){return c.Users.logout(b)};c.eventManager.clearAndSubscribe("type.user."+
k.get("__id")+".updated",function(b,d){c.LocalStorage.set("Appacitive-User",d.object.getObject())});return g};b.prototype.updatePassword=function(b,d,g){var k=this.get("__id");if(!k||!f.isString(k)||0===k.length)throw Error("Please specify valid userid");if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid oldPassword");if(!d||!f.isString(d)||0===d.length)throw Error("Please specify valid newPassword");var m=this,n=new c._Request({method:"POST",type:"user",op:"getUpdatePasswordUrl",
args:[k],options:g,data:{oldpassword:b,newpassword:d},entity:this,onSuccess:function(b){n.promise.fulfill(m)}});return n.send()};b.prototype.linkedAccounts=function(){var b=this.get("__link");b?f.isArray(b)||(b=[b]):b=[];return b};b.prototype.getAllLinkedAccounts=function(b){var d=this.get("__id");if(!d||!f.isString(d)||0===d.length)return c.Promise.buildPromise(b).fulfill(this.linkedAccounts(),this);var g=this,k=new c._Request({method:"GET",type:"user",op:"getGetAllLinkedAccountsUrl",args:[d],options:b,
entity:this,onSuccess:function(){var b=a.identities||[];0<b.length?g.set("__link",b):g.set("__link",null);k.promise.fulfill(b,g)}});return k.send()};b.prototype.checkin=function(b,d){var g=this.get("__id");g&&f.isString(g)&&0!==g.length||onSuccess&&f.isFunction(onSuccess)&&onSuccess();if(!(b&&b instanceof c.GeoCoord))throw Error("Invalid coordinates provided");var k=this,m=new c._Request({method:"POST",type:"user",op:"getCheckinUrl",args:[g,b.lat,b.lngerId],options:d,entity:this,onSuccess:function(){m.promise.fulfill(k)}});
return m.send()};b.prototype.linkFacebook=function(b,c){if(!b||!f.isString(b))throw Error("Please provide accessToken");return m.apply(this,[{authtype:"facebook",accesstoken:b,name:"facebook"},c])};b.prototype.linkTwitter=function(b,c){if(!f.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var d={authtype:"twitter",oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret};b.consumerKey&&b.consumerSecret&&(d.consumersecret=b.consumerSecret,
d.consumerkey=b.consumerKey);return m.apply(this,[d,c])};b.prototype.unlink=function(b,d){if(!_.isString(b))throw Error("Specify aouth account type for unlinking");var g=this.get("__id");if(!this.get("__id"))return this.set("__link",null),promise.fulfill(this),promise;var k=this,m=new c._Request({method:"POST",type:"user",op:"getDelinkAccountUrl",args:[g,b],options:d,entity:this,onSuccess:function(c){(c=k.get("__link"))?f.isArray(c)||(c=[c]):c=[];if(0<=c.length){var d=null;c.forEach(function(c,e){c.name==
b.toLowerCase()&&(d=e)});null!=d&&c.splice(d,1);k.copy({__link:c},!0)}else k.copy({__link:[]},!0);m.promise.fulfill(k)}});return m.send()};b.prototype.clone=function(){return new c.User(this.getObject())};c.User=c.Object.extend("user",b.prototype);delete c.User._create;delete c.User._parseResult;delete c.User.multiDelete;b.deleteUser=function(b,d){if(!b)throw Error("Specify userid for user delete");return(new c.Object({__type:"user",__id:b})).destroyWithConnections(d)};b.deleteCurrentUser=function(b){var d=
c.Promise.buildPromise(b);if(null===g)return c.Session.removeUserAuthHeader(),d.fulfill(),d;b=g.get("__id");this.deleteUser(b).then(function(){g=null;c.Session.removeUserAuthHeader();d.fulfill()},function(){d.reject.apply(d,arguments)});return d};b.createNewUser=function(b,d){b=b||{};b.__type="user";if(!b.username||!b.password||!b.firstname||0===b.username.length||0===b.password.length||0===b.firstname.length)throw Error("username, password and firstname are mandatory");return(new c.User(b)).save(d)};
b.createUser=b.createNewUser;b.signup=function(b,d){var g=this,f=c.Promise.buildPromise(d);this.createUser(b).then(function(){g.login(b.username,b.password).then(function(){f.fulfill.apply(f,arguments)},function(b){f.reject.apply(f,arguments)})},function(){f.reject.apply(f,arguments)});return f};b.authenticateUser=function(b,d,l){d=d||{};b.expiry||(b.expiry=864E5);var m=this,t;f.isString(l)&&f.isObject(d.user)&&(b.user=d.user instanceof n.Appacitive.User?d.user.toJSON():d.user,delete b.user.__meta,
t=d.user);var p=new c._Request({method:"POST",type:"user",op:"getAuthenticateUserUrl",options:d,data:b,onSuccess:function(d){d&&d.user?(l&&(d.user.__authType=l),k(d.user,{__meta:d.__meta}),t instanceof n.Appacitive.User&&(d.user=t.copy(d.user,!0)),m.setCurrentUser(d.user,d.token,b.expiry),c.User.trigger("login",g,g,d.token),p.promise.fulfill({user:g,token:d.token})):p.promise.reject(d.status)}});return p.send()};b.login=function(b,c,d){if(!b||!c||0==b.length||0==c.length)throw Error("Please specify username and password");
return this.authenticateUser({username:b,password:c,expiry:864E5},d,"BASIC")};b.loginWithFacebook=function(b,c){if(!b||!f.isString(b))throw Error("Please provide accessToken");c=c||{};var d=!0;0==c.create&&(d=!1);return this.authenticateUser({accesstoken:b,type:"facebook",expiry:864E5,createnew:d},c,"FB")};b.loginWithTwitter=function(b,c){if(!f.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var d=!0;0==c.create&&(d=!1);d={type:"twitter",
oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret,expiry:864E5,createnew:d};b.consumerKey&&b.consumerSecret&&(d.consumersecret=b.consumerSecret,d.consumerkey=b.consumerKey);return this.authenticateUser(d,c,"TWITTER")};b.validateCurrentUser=function(b,d){var g=c.Promise.buildPromise({success:d});d&&f.isBoolean(d)&&(b=d,d=function(){});var k=this,m=function(c){if(c)if(b)g.fulfill(!0);else try{k.getUserByToken(c).then(function(b){k.setCurrentUser(b,c);g.fulfill(!0)},function(){g.fulfill(!1)})}catch(d){g.fulfill(!1)}else g.fulfill(!1)};
c.runtime.isReactNative?c.LocalStorage.get("Appacitive-UserToken").then(function(b){m(b)}):m(c.LocalStorage.get("Appacitive-UserToken"));return g};var d=function(b,d,g){g=g||{};var f=new c._Request({method:"GET",type:"user",op:b,options:g,args:d,onSuccess:function(b){b&&b.user?f.promise.fulfill(new c.User(k(b.user,{__meta:b.__meta}),k(g,{setSnapShot:!0}))):f.promise.reject(b.status)}});return f.send()};b.getUserByToken=function(b,e){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid token");
c.Session.setUserAuthHeader(b,0,!0);return d("getUserByTokenUrl",[b],e)};b.getUserByUsername=function(b,c){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid username");return d("getUserByUsernameUrl",[b],c)};b.logout=function(b,d){g=null;return c.Session.removeUserAuthHeader(b,d)};b.sendResetPasswordEmail=function(b,d,g){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid username");if(!d||!f.isString(d)||0===d.length)throw Error("Plase specify subject for email");
b={username:b,subject:d};g=g||{};f.isString(g.templateName)&&(b.templatename=g.templateName);f.isString(g.resetLink)&&(b.resetlink=g.resetLink);var k=new c._Request({method:"POST",type:"user",op:"getSendResetPasswordEmailUrl",options:g,data:b,onSuccess:function(){k.promise.fulfill()}});return k.send()};b.resetPassword=function(b,d,g){if(!b)throw Error("Please specify token");if(!d||0===d.length)throw Error("Please specify password");var f=new c._Request({method:"POST",type:"user",op:"getResetPasswordUrl",
options:g,data:{newpassword:d},args:[b],onSuccess:function(){f.promise.fulfill()}});return f.send()};b.validateResetPasswordToken=function(b,d){if(!b)throw Error("Please specify token");d=d||{};var g=new c._Request({method:"POST",type:"user",op:"getValidateResetPasswordUrl",options:d,data:{},args:[b],onSuccess:function(b){g.promise.fulfill(new c.User(k(b.user,{__meta:b.__meta}),k(d,{setSnapShot:!0})))}});return g.send()};c.Users=c.User;c.Events.mixin(c.User)})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend;c.Collection=function(b,c){c||(c={});c.model&&(this.model=c.model);if(!this.model)throw Error("Please specify model for collection");void 0!==c.comparator&&(this.comparator=c.comparator);c.query&&this.query(c.query);this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0})};c.Events.mixin(c.Collection.prototype);k(c.Collection.prototype,{models:[],initialize:function(){},_query:null,toJSON:function(b){return this.models.map(function(c){return c.toJSON(b)})},
getObject:function(b){return this.models.map(function(c){return c.getObject(b)})},add:function(b,c){c=c||{};var k,d,h,e,l,n={},t={},p=[],r=c.sort,u;b=f.isArray(b)?b.slice():[b];k=0;for(d=b.length;k<d;k++){b[k]=this._prepareModel(b[k]);h=b[k];if(!h)throw Error("Can't add an invalid model to a collection");e=h.cid;if(n[e]||this._byCid[e])throw Error("Duplicate cid: can't add the same model to a collection twice");(l=h.id)&&((u=t[l])||(u=this._byId[l]))?(u.copy(h.getObject(),c.setSnapShot),u.children=
h.children):(t[l]=h,n[e]=h,p.push(h),this._addReference(h,c))}this.models.splice.apply(this.models,[null!=c.at?c.at:this.models.length,0].concat(p));r&&this.comparator&&this.sort({silent:!0});this.length=this.models.length;if(c.silent)return this;k=0;for(d=p.length;k<d;k++)h=p[k],c.index=k,h.trigger("add",h,this,c);return this},remove:function(b,c){var k,d,h,e;c=c||{};b=f.isArray(b)?b.slice():[b];k=0;for(d=b.length;k<d;k++)if(e=this.getByCid(b[k])||this.get(b[k]))delete this._byId[e.id],delete this._byCid[e.cid],
h=this.models.indexOf(e),this.models.splice(h,1),this.length--,c.silent||(c.index=h,e.trigger("remove",e,this,c)),this._removeReference(e);return this},push:function(b,c){return this.add(b,k({at:this.length},c))},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,c){return this.add(b,k({at:0},c))},shift:function(b){var c=this.at(0);this.remove(c,b);return c},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(b){return b&&
this._byId[b instanceof c.BaseObject?b.id:b]},query:function(b){if(b)return this._query=b,this;this._query||(this._query=new c.Query(this.model));return this._query},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b,c){return Object.isEmpty(b)?c?void 0:[]:this.models[c?"find":"filter"](function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},findWhere:function(b){return this.where(b,!0)},sort:function(b){b=b||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");
1===this.comparator.length?this.models=this.models.sortBy(this.comparator):this.models.sort(this.comparator.bind(this.models));b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return this.models.map(function(c){return c.get(b)})},first:function(){return 0<this.length?this.models[0]:null},last:function(){return 0<this.length?this.models[this.length-1]:null},reset:function(b,c){c||(c={});for(var f=0,d=this.models.length;f<d;f++)this._removeReference(this.models[f],c);this._reset();
this.add(b,k({silent:!0},c));c.silent||this.trigger("reset",this,c);return this},fetch:function(b){b=c.utils._clone(b)||{};var g=this,f=this.query()||new c.Query(this.model),d=c.Promise.buildPromise(b);f.fetch(b).then(function(c){0==b.reset?g.add(c,k({setSnapShot:!0},b)):g.reset(c,b);d.fulfill(g)},function(){d.reject.apply(d,arguments)});return d},fetchNext:function(b){var c=this.query().pageNumber();this.query().pageNumber(++c);return this.fetch(b)},fetchPrev:function(b){var c=this.query().pageNumber();
--c;0>=c&&(c=1);this.query().pageNumber(c);return this.fetch(b)},mutiGet:function(b){b=c.utils._clone(b)||{};var g=this,k=c.Promise.buildPromise(b);b=b||{};f.isArray(b)&&(b[0]instanceof c.Object?(models=b,b={ids:models.map(function(b){return b.id}).filter(function(b){return b})}):b={ids:b});var d=b.ids||[];if(0==d.length)return k.fulfill(g);this.model.multiGet({ids:d,fields:b.fields}).then(function(c){b.add?g.add(c,b):g.reset(c,b);k.fulfill(g)},function(){k.reject.apply(k,arguments)});return k},saveAll:function(b){return this.model.saveAll(this.models,
k({},b))},save:function(b){return this.model.saveAll(this.models,k({},b))},create:function(b,g){var f=this;g=g?c.utils._clone(g):{};if(!(b=this._prepareModel(b,g)))return!1;g.wait||this.add(b,g);var d=g.success;g.success=function(){g.wait&&f.add(b,k({setSnapShot:!0},g));d&&d(b,f)};b.save(g);return b},_reset:function(b){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(b){b instanceof c.BaseObject||(b=new this.model(b));b.collection||(b.collection=this);return b},_addReference:function(b){this._byId[b.cid]=
b;null!=b.id&&(this._byId[b.id]=b);b.collection||(b.collection=this);b.on("all",this._onModelEvent,this)},_removeReference:function(b){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,f,d){if("add"!==b&&"remove"!==b||f===this)"destroy"===b&&this.remove(c,d),c&&"change:__id"===b&&(delete this._byId[c.previous(c.idAttribute)],null!=c.id&&(this._byId[c.id]=c)),this.trigger.apply(this,arguments)}});c.Collection.extend=function(b,f){b&&b.query&&
(b._query=b.query,delete b.query);var k=c.utils.classExtend(this,b,f);k.extend=this.extend;return k};"forEach each map find filter every some indexOf lastIndexOf isEmpty difference without reduce".split(" ").each(function(b){c.Collection.prototype[b]=function(){var c=Array.prototype.slice.call(arguments);return Array.prototype[b].apply(this.models,c)}})})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.utils._extend;c.Batch=function(){this.objects=[];this.connections=[];this.objectDeletions=[];this.edgeDeletions=[]};var b=function(b){-1==this.connections.indexOf(b)&&this.connections.push(b)},g=function(b){-1==this.objects.indexOf(b)&&this.objects.push(b)},m=function(b,d,e){var g;if(f.isString(b)){if(g=b,!f.isString(d)&&0<d.trim().length)throw Error("Specify typename as second argument to Batch.removeObjects");}else if(f.isObject(b)&&b instanceof
c.Object){if(b.isNew())return;g=b.id;e=d;d=b.typeName}else throw Error("Batch.removeObjects accepts only Appacitive.Object or ids with typeName");this.objectDeletions.find(function(b){return g==b.id})||this.objectDeletions.push({type:d,id:g,deleteconnections:e})},d=function(b,d){var e;if(f.isString(b)){if(e=b,!f.isString(d)&&0<d.trim().length)throw Error("Specify relationName as second argument to Batch.removeConnections");}else if(f.isObject(b)&&b instanceof c.Connection){if(b.isNew())return;e=b.id;
d=b.relationName}else throw Error("Batch.removeConnection accepts only Appacitive.Connection or ids with relationName");this.edgeDeletions.find(function(b){return e==b.id})||this.edgeDeletions.push({type:d,id:e})},h=function(d){if(f.isObject(d)){if(d instanceof c.Object)return g.apply(this,[d]);if(d instanceof c.Connection)return b.apply(this,[d])}throw Error("Batch accepts only Appacitive.Object and Appacitive.Connection instances");},e=function(){var b=[];this.objects.forEach(function(c,d){var e=
c._findUnsavedChanges();if(e.object){e.object.__type=c.className;var f=b.find(function(b){return c.id&&c.id==b.object.__id||c.cid==b.name});f&&(f.object=e.object,e=f);delete e.isNested;c.isNew()?e.name=""+c.cid:e.object.__id=c.id;f||b.push(e)}});return b},l=function(){var b=this,c=[];this.connections.forEach(function(d){var e=d._findUnsavedChanges().object;e&&(e.__relationtype=d.className,e.__endpointa&&delete e.__endpointa.object,e.__endpointb&&delete e.__endpointb.object);var g=d.endpointA.object;
f.isObject(g)&&(d.isNew()&&(g.isNew()?e.__endpointa.name=""+d.endpointA.object.cid:e.__endpointa.objectid=d.endpointA.object.id),h.apply(b,[g]));g=d.endpointB.object;f.isObject(g)&&(d.isNew()&&(g.isNew()?e.__endpointb.name=""+d.endpointB.object.cid:e.__endpointb.objectid=d.endpointB.object.id),h.apply(b,[g]));if(e){var g=c.find(function(b){return d.id&&d.id==b.connection.__id||d.cid==b.name}),k={connection:e};g&&(g.connection=e,k=g);d.isNew()?k.name=""+d.cid:k.connection.__id=d.id;g||c.push(k)}});
return c};c.Batch.prototype.add=function(){var b=this;f.isArray(arguments[0])?arguments[0].forEach(function(c){h.apply(b,[c])}):h.apply(this,arguments);return this};c.Batch.prototype.removeObjects=function(){var b=this,c=arguments;f.isArray(c[0])?arguments[0].forEach(function(d){m.apply(b,[d,c[1],c[2]])}):m.apply(this,c);return this};c.Batch.prototype.removeConnections=function(){var b=this,c=arguments;f.isArray(c[0])?arguments[0].forEach(function(e){d.apply(b,[e,c[1],c[2]])}):d.apply(this,c);return this};
c.Batch.prototype.toJSON=function(){var b={nodes:[],edges:[],edgedeletions:[],nodedeletions:[]};b.edges=l.apply(this,[]);b.nodes=e.apply(this,[]);b.nodedeletions=this.objectDeletions;b.edgedeletions=this.edgeDeletions;return b};var q=function(b,c,d){var e=this;b.forEach(function(b){var g=b.object;e.objects.forEach(function(e){if(e.cid==b.name||e.id==g.__id||e.get("__id")==g.__id){var f={__meta:c[e.className]};f[e.getType()]=g;e._parseOutput(d,f)}})})},t=function(b,c,d){var e=this;b.forEach(function(b){var g=
b.connection;e.connections.forEach(function(e){if(e.cid==b.name||e.id==g.__id||e.get("__id")==g.__id){var f={__meta:c[e.className]};f[e.getType()]=g;e._parseOutput(d,f)}})})},p=function(b,d){var e;b&&b.edges&&b.nodes&&0<=b.edges.length&&0<=b.nodes.length?(q.call(this,b.nodes,b.__meta.__type,d),t.call(this,b.edges,b.__meta.__rel,d),d.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},d)):(b=b||{},b.status=b.status||{},e=(e=b.status)||{},e.message=e.message||"Server error",
e.code=e.code||"500",this._triggerError(d,new c.Error(e)));return e};c.Batch.prototype._triggerError=function(b,c){b.silent||this.trigger("error",this,c,b)};c.Batch.prototype.execute=function(b){var d=this.toJSON();b=k({_batch:!0},b);if(0==d.nodes.length&&0==d.edges.length&&0==d.edgedeletions.length&&0==d.nodedeletions.length)return b.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},b),(new c.Promise).fulfill(this);var e=this,g=new c._Request({method:"PUT",type:"multi",
op:"getBatchUrl",data:d,options:b,entity:this,onSuccess:function(c){(c=p.apply(e,[c,b]))?g.promise.reject(c,e):g.promise.fulfill(e)}});return g.send()};c.Events.mixin(c.Batch.prototype)})(global);
(function(n){var c=n.Appacitive;c.Facebook=new function(){var f=null,k=!0;this.initialize=function(b){if(!FB)throw"Facebook SDK needs be loaded before calling initialize.";if(!b.appId)throw Error("Please provide appid");FB.init(b);k=!0};this.requestLogin=function(b){b=b||{};if(!k)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");var g=c.Promise.buildPromise(b);b.scope||(b.scope="email");FB.login(function(b){b&&"connected"===b.status&&b.authResponse?(f=b.authResponse.accessToken,
g.fulfill(b.authResponse)):g.reject()},b);return g};this.getCurrentUserInfo=function(b){if(!k)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");b=b||{};var g=c.Promise.buildPromise(b);FB.api("/me",function(b){b&&!b.error?(f=FB.getAuthResponse().accessToken,g.fulfill(b)):g.reject()});return g};this.accessToken=function(){return 1===arguments.length?(f=arguments[0],this):f};this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=
function(b){f=null;b=b||{};var g=c.Promise.buildPromise(b);try{FB.logout(function(){c.Users.logout();g.fulfill()})}catch(k){g.reject(k.message)}return g}}})(global);
(function(n){var c=n.Appacitive;c.Email=new function(){var f={smtp:{username:null,password:null,host:"smtp.gmail.com",port:465,enablessl:!0},from:null,replyto:null};this.getConfig=function(){return f};var k=function(b,g){var f=new c._Request({method:"POST",type:"email",op:"getSendEmailUrl",options:g,data:b,entity:b,onSuccess:function(b){f.promise.fulfill(b.email)}});return f.send()};this.setupEmail=function(b){b=b||{};f.smtp.username=b.username||f.smtp.username;f.from=b.from||f.from;f.smtp.password=
b.password||f.smtp.password;f.smtp.host=b.smtp.host||f.smtp.host;f.smtp.port=b.smtp.port||f.smtp.port;f.smtp.enablessl=b.enableSSL||f.smtp.enablessl;f.replyto=b.replyTo||f.replyto};this.sendTemplatedEmail=function(b,c){if(!b||!b.to||!b.to.length||0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");
if(!b.templateName)throw Error("template name is mandatory to send an email");var m={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{templatename:b.templateName||"",data:b.data||{},ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){m.smtp=f.smtp;if(!b.from&&!f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");m.from=b.from||f.from;m.replyto=b.replyTo||f.replyto}return k(m,c)};this.sendRawEmail=function(b,c){if(!b||!b.to||!b.to.length||
0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");if(!b.body)throw Error("body is mandatory to send an email");var m={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{content:b.body||"",ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){m.smtp=
f.smtp;if(!b.from&&!f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");m.from=b.from||f.from;m.replyto=b.replyTo||f.replyto}return k(m,c)}}})(global);
(function(n){var c=n.Appacitive;c.Push=new function(){this.send=function(f,k){if(!f)throw Error("Please specify push options");var b=new c._Request({method:"POST",type:"push",op:"getPushUrl",options:k,data:f,entity:f,onSuccess:function(c){b.promise.fulfill(c.id)}});return b.send()};this.getNotification=function(f,k){if(!f)throw Error("Please specify notification id");var b=new c._Request({method:"GET",type:"push",op:"getGetNotificationUrl",args:[f],options:k,onSuccess:function(c){b.promise.fulfill(c.pushnotification)}});
return b.send()};this.getAllNotifications=function(f,k){f?(f.pnum=f.pnum||1,f.psize=f.psize||20):f={pnum:1,psize:20};var b=new c._Request({method:"GET",type:"push",op:"getGetAllNotificationsUrl",args:[f],options:k,onSuccess:function(c){b.promise.fulfill(c.pushnotifications,c.paginginfo)}});return b.send()}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type;c.File=function(k){k=k||{};this.fileId=k.fileId;this.contentType=k.contentType;this.fileData=k.fileData;var b=this,g=function(d,f,g,h,k){var m=new c.HttpRequest;m.url=d;m.method="GET";m.description=h;m.onSuccess=f;m.promise=g;m.entity=b;m.options=k;c.http.send(m)},m=function(d,f,g,h,k){var m=new c.HttpRequest;m.url=d;m.method="PUT";m.log=!1;m.description="Upload file";m.data=f;m.headers.push({key:"Content-Type",value:g});m.send().then(h,function(c){k.reject(c,
b)})};this.save=function(b,c){"number"!==typeof b&&(c=b,b=-1);return this.fileId&&f.isString(this.fileId)&&0<this.fileId.length?h(b,c):d(b,c)};var d=function(d,h){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(k){}b.contentType&&f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var n=c.Promise.buildPromise(h),p=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(b.contentType,b.fileId?b.fileId:
"");g(p,function(c){m(c.url,b.fileData,b.contentType,function(){b.fileId=c.id;b.getDownloadUrl(d,h).then(function(c){return n.fulfill(c,b)},function(b){return n.reject(b)})},n)},n," Get upload url for file ",h);return n},h=function(d,h){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(k){}b.contentType&&f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var n=c.Promise.buildPromise(h),p=c.config.apiBaseUrl+
c.storage.urlFactory.file.getUpdateUrl(b.fileId,b.contentType);g(p,function(c){m(c.url,b.fileData,b.contentType,function(){b.getDownloadUrl(d,h).then(function(c){n.fulfill(c,b)},function(b){n.reject(b)})},n)},n," Get update url for file "+b.fileId,h);return n};this.destroy=function(d){if(!this.fileId)throw Error("Please specify fileId to delete");var f=c.Promise.buildPromise(d),g=new c.HttpRequest;g.url=c.config.apiBaseUrl+c.storage.urlFactory.file.getDeleteUrl(this.fileId);g.method="DELETE";g.description=
"Delete file with id "+this.fileId;g.onSuccess=function(b){f.fulfill()};g.promise=f;g.entity=b;g.options=d;return c.http.send(g)};this.getDownloadUrl=function(d,f){if(!this.fileId)throw Error("Please specify fileId to download");"number"!==typeof d&&(f=d,d=-1);var h=c.Promise.buildPromise(f),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getDownloadUrl(this.fileId,d);g(k,function(c){b.url=c.uri;h.fulfill(c.uri)},h," Get download url for file "+this.fileId,f);return h};this.getUploadUrl=function(d){b.contentType&&
f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var h=c.Promise.buildPromise(d),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(this.contentType,this.fileId?this.fileId:"");g(k,function(c){b.url=c.url;h.fulfill(c.url,b)},h," Get upload url for file "+this.fileId,d);return h}}})(global);
(function(n){var c=n.Appacitive;c.Date={};var f=function(c){return 10>c?"0"+c:c};c.Date.parse=function(c){var b,f=0,m=[1,4,5,6,7,10,11];if(b=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}|\d{7}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(c)){c=0;for(var d;d=m[c];++c)b[d]=+b[d]||0;b[2]=(+b[2]||1)-1;b[3]=+b[3]||1;"Z"!==b[8]&&void 0!==b[9]?(f=60*b[10]+b[11],"+"===b[9]&&(f=0-f)):"Z"==b[8]&&(b[7]=b[7].toString().substring(0,3));b=Date.UTC(b[1],b[2],b[3],b[4],
b[5]+f,b[6],b[7])}else b=Date.parse?Date.parse(c):NaN;return b};c.Date.parseISODate=function(f){try{return new Date(c.Date.parse(f))}catch(b){return null}};c.Date.toISOString=function(c){try{return c=c.toISOString(),c=c.replace("Z","0000Z")}catch(b){return null}};c.Date.toISODate=function(c){if(c instanceof Date)return String.format("{0}-{1}-{2}",c.getFullYear(),f(c.getMonth()+1),f(c.getDate()));throw Error("Invalid date provided Appacitive.Date.toISODate method");};c.Date.toISOTime=function(c){var b=
function(b){return 10>b?b+"000000":100>b?b+"00000":1E3>b?b+"0000":1E4>b?b+"000":1E5>b?b+"00":1E6>b?b+"0":b};if(c instanceof Date)return String.format("{0}:{1}:{2}.{3}",f(c.getHours()),f(c.getMinutes()),f(c.getSeconds()),b(c.getMilliseconds()));throw Error("Invalid date provided Appacitive.Date.toISOTime method");};c.Date.parseISOTime=function(c){try{var b=new Date,f=c.split("T");1===f.length&&f.push(f[0]);if(!/^([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z?$/.exec(f[1]))return null;var m=f[1].split("Z")[0].split(":"),
d=m[2].split("."),h=Number(m[0]);1<f.length?(b.setUTCHours(Number(h)),b.setUTCMinutes(Number(m[1])),b.setUTCSeconds(Number(d[0])),d[1]&&b.setUTCMilliseconds(Number(d[1].substring(0,3)))):(b.setHours(Number(h)),b.setMinutes(Number(m[1])),b.setSeconds(Number(d[0])),d[1]&&b.setMilliseconds(Number(d[1].substring(0,3))));return b}catch(e){return null}}})(global);
(function(n){var c=n.Appacitive,f=c.utils._type,k=c.runtime.isBrowser&&"object"==typeof window.localStorage&&f.isFunction(window.localStorage.getItem);c.LocalStorage=new function(){var b=k?window.localStorage:{};this.set=function(g,k){k=k||"";if(!f.isString(g))return this;if(f.isObject(k)||f.isArray(k))try{k=JSON.stringify(k)}catch(d){}var h=c.getAppPrefix(g);b[h]=k;return this};this.get=function(g){if(!f.isString(g))return promise.fulfill(null,g);g=c.getAppPrefix(g);(g=k?b.getItem(g):b[g])||(g=null);
if(g&&"{"===g[0])try{g=JSON.parse(g)}catch(m){}return g};this.multiGet=function(){var b=this,c=Array.prototype.slice.call(arguments);if(1<arguments.length){var d={};c.forEach(function(c){Array.isArray(c)&&(c=c.join());c.replace(/\s/g,"").split(",").forEach(function(c){d[c]=b.get(c)})});return d}throw Error("Appacitive.LocalStorage.multiGet requires atleast one argument");};this.remove=function(g){if(!f.isString(g))return this;g=c.getAppPrefix(g);try{delete b[g]}catch(k){}}}})(global);
(function(n){var c=n.Appacitive;n=c.utils._type;"undefined"!=typeof document&&n.isString(document.cookie)&&(c.Cookie=new function(){this.setCookie=function(f,k,b,g){f=c.getAppPrefix(f);var m="";b&&(m=new Date,m.setTime(m.getTime()+6E4*b),m.toGMTString());m=g?"; expires=Thu, 01-Jan-1970 00:00:01 GMT":c.Session.persistUserToken?"; expires="+(new Date("2020-12-31")).toGMTString():"";b="domain="+window.location.hostname;"localhost"==window.location.hostname&&(b="");document.cookie=f+"="+k+m+"; path=/;"+
b};this.readCookie=function(f){f=c.getAppPrefix(f);f+="=";for(var k=document.cookie.split(";"),b=0;b<k.length;b++){for(var g=k[b];" "==g.charAt(0);)g=g.substring(1,g.length);if(0===g.indexOf(f))return g.substring(f.length,g.length)}return null};this.eraseCookie=function(c){this.setCookie(c,"",-1,!0)}})})(global);"object"===typeof module&&module.exports&&"function"===typeof require&&(module.exports=global.Appacitive);
