/*
 * AppacitiveSDK.js vappacitive-js-sdk-v1.0.6 - Javascript SDK to integrate applications using Appacitive
 * Copyright (c) 2015 Appacitive Software Pvt Ltd
 * MIT license  : http://www.apache.org/licenses/LICENSE-2.0.html
 * Project      : https://github.com/chiragsanghvi/JavascriptSDK
 * Contact      : support@appacitive.com | csanghvi@appacitive.com
 * Build time 	: Wed Oct 21 15:09:42 IST 2015
 */
var global={};
(function(){global.Appacitive={runtime:{}};"undefined"!==typeof process&&process.versions&&process.versions.node?global.Appacitive.runtime.isNode=!0:"undefined"!==typeof window&&(global=window,global.Appacitive={runtime:{isBrowser:!0}});var m=global.Appacitive;m.initialize=function(c){c=c||{};var g=new m.Promise;if(m.Session.initialized)return g.fulfill(m);c.masterKey&&0<c.masterKey.length&&m.Session.setMasterKey(c.masterKey);if(!c.apikey||0===c.apikey.length)if(c.masterKey)c.apikey=c.masterKey;else throw Error("apikey is mandatory");
if(!c.appId||0===c.appId.length)throw Error("appId is mandatory");m.Session.setApiKey(c.apikey);m.Session.environment(c.env||"sandbox");m.useApiKey=!0;m.appId=c.appId;m.Session.persistUserToken=c.persistUserToken;c.debug&&(m.config.debug=!0);m.utils._type.isFunction(c.apiLog)&&(m.logs.apiLog=c.apiLog);m.utils._type.isFunction(c.apiErrorLog)&&(m.logs.apiErrorLog=c.apiErrorLog);m.utils._type.isFunction(c.exceptionLog)&&(m.logs.exceptionLog=c.exceptionLog);if(c.userToken)-1==c.expiry?c.expiry=null:c.expiry||
(c.expiry=845E4),m.Session.setUserAuthHeader(c.userToken,c.expiry),c.user&&m.Users.setCurrentUser(c.user);else if(m.runtime.isBrowser){var h=m.LocalStorage.multiGet("Appacitive-UserToken","Appacitive-UserTokenExpiry","Appacitive-UserTokenDate","Appacitive-User");c=h["Appacitive-UserToken"];var b=h["Appacitive-UserTokenExpiry"],e=h["Appacitive-User"],h=h["Appacitive-User"];if(c){b||(b=-1);if(e&&0<b&&new Date(e+1E3*b)<new Date)return;-1==b&&(b=null);h&&m.Users.setCurrentUser(h,c,b)}}m.Session.initialized=
!0;g.fulfill(m.User.current());return g}})(this);
(function(m){var c=m.Appacitive,g=function(b){var e=c.Promise.buildPromise({success:b.onSuccess,error:b.onError}),k=new XDomainRequest;k.onload=function(){var b=k.responseText,h=k.contentType||"";if("application/json"==h.toLowerCase()||"application/javascript"==h.toLowerCase()||"application/json; charset=utf-8"==h.toLowerCase()||"application/json; charset=utf-8;"==h.toLowerCase())try{h=b,c.runtime.isBrowser||"{"!=h[0]&&(h=h.substr(1,h.length-1)),b=JSON.parse(h)}catch(f){return e.reject(k,new c.Error(c.Error.InvalidJson,
"Error while parsing received json "+b))}e.fulfill(b,this)};k.onerror=k.ontimeout=function(){k.responseData="IE's XDomainRequest does not supply error info.";k.status=c.Error.XDomainRequest;e.reject(k,new c.Error(c.Error.XDomainRequest,k.responseData,"Unknown"))};k.onprogress=function(){};-1===b.url.indexOf("?")?b.url+="?ua=ie":b.url+="&ua=ie";k.open(b.method,b.url,b.sync?!1:!0);k.send(b.data);return e},h=c.runtime.isBrowser?XMLHttpRequest:require("xmlhttprequest-with-globalagent").XMLHttpRequest;
c._Http=function(b){if(!b.url)throw Error("Please specify request url");b.method||(b.method="GET");b.headers||(b.headers=[]);var e={};b.onSuccess&&"function"==typeof b.onSuccess||(b.onSuccess=function(){});b.onError&&"function"==typeof b.onError||(b.onError=function(){});var k=c.Promise.buildPromise({success:b.onSuccess,error:b.onError}),d=!0;b.headers.forEach(function(b){"content-type"==b.key.toLowerCase()&&(d=!0,"application/json"==b.value.toLowerCase()||"application/javascript"==b.value.toLowerCase()||
"application/json; charset=utf-8"==b.value.toLowerCase()||"application/json; charset=utf-8;"==b.value.toLowerCase())&&(d=!1)});if(d)e=b.data;else if(b.data&&(e=b.data,"object"==typeof b.data))try{e=JSON.stringify(e)}catch(r){}var f=b.url.split("/")[2]||"";if(m.navigator&&_type.isObject(m.navigator.userAgent)&&_type.isFunction(m.navigator.userAgent.indexOf)&&-1!=m.navigator.userAgent.indexOf("MSIE 9")&&m.location&&m.location.host&&f!==m.location.host.toLowerCase())return b.data=e,new g(b);var l=new h;
l.onreadystatechange=function(){if(4==l.readyState)if(200<=l.status&&300>l.status||304==l.status){var b=l.responseText,d=l.getResponseHeader("content-type")||l.getResponseHeader("Content-Type")||"";if("application/json"==d.toLowerCase()||"application/javascript"==d.toLowerCase()||"application/json; charset=utf-8"==d.toLowerCase()||"application/json; charset=utf-8;"==d.toLowerCase())try{d=b,c.runtime.isBrowser||"{"!=d[0]&&(d=d.substr(1,d.length-1)),b=JSON.parse(d)}catch(f){return k.reject(l,new c.Error(c.Error.InvalidJson,
"Error while parsing received json "+b))}k.fulfill(b,l)}else k.reject(l,new c.Error(c.Error.ConnectionFailed,l.responseText,"Unknown"))};l.open(b.method,b.url,b.sync?!1:!0);for(f=0;f<b.headers.length;f+=1)l.setRequestHeader(b.headers[f].key,b.headers[f].value);c.runtime.isBrowser||l.setRequestHeader("User-Agent","Appacitive-NodeJSSDK");l.send(e);return k}})(global);
(function(m){var c=m.Appacitive,g=function(b){if(b&&b.send&&"function"==typeof b.send)b.onResponse=this.onResponse;else throw Error("No applicable httpTransport class found");var k=[],d={},h=0,f={},l=0;this.addProcessor=function(b){b&&(b.pre=b.pre||function(){},b.post=b.post||function(){},g(b.pre),q(b.post))};var g=function(b){h+=1;d[h]=b;return h},q=function(b){l+=1;f[l]=b;return l};this.enqueueRequest=function(b){k.push(b)};this.changeRequestForCors=function(b){var d={m:b.method.toUpperCase()};
b.headers.forEach(function(b){d[b.key]=b.value});b.prevHeaders=b.headers;b.headers=[];b.headers.push({key:"Content-Type",value:"text/plain; charset=utf-8"});b.method="POST";b.data&&(d.b=b.data);delete b.data;c.config.debug&&(-1===b.url.indexOf("?")?b.url+="?debug=true":b.url+="&debug=true");c.config.metadata&&(-1===b.url.indexOf("?")?b.url+="?metadata=true":b.url+="&metadata=true");try{b.data=JSON.stringify(d)}catch(f){}return b};this.notify=function(){if(0!==k.length){var c=[],l;for(l in f)f.hasOwnProperty(l)&&
c.push(f[l]);for(;0<k.length;){var h=k.shift(),r=[];for(l in d)d.hasOwnProperty(l)&&r.push(d[l](h));this.changeRequestForCors(h);b.send(h,c,r)}}};this.onResponse=function(b){console.dir(b)}},h=function(){var b=function(){throw Error("Not Implemented Exception");};this.inOnline=this.send=b;this.onResponse=function(c,d){b()};this.onError=function(c){b()}},b=function(){var b=new h;b.isOnline=function(){return!0};var k=function(d,k,f){d.options=d.options||{};new c._Http({method:d.method,url:d.url,headers:d.headers,
data:d.data,sync:d.options.sync,onSuccess:function(c,h){if(c){try{c=JSON.parse(c)}catch(q){}var g=c;if(k.length!=f.length)throw Error("Callback length and state length mismatch!");for(var t=0;t<k.length;t+=1)k[t].apply({},[g,f[t]]);if(200<=c.code&&300>=c.code||c.status&&200<=c.status.code&&300>=c.status.code)b.onResponse(d,c);else c=c||{},c=c.status||c,c.message=c.message||"Bad Request",c.code=c.code||"400",b.onError(d,{responseText:c})}else b.onError(d,{responseText:{code:"400",message:"Invalid request"}})},
onError:function(f,k){var h={};k?h=c.Error.toJSON(k):(h.message=f.responseData||f.responseText||"Bad Request",h.code=f.status||"400");b.onError(d,{responseText:h})}})};b.send=function(b,e,f){if(!c.Session.initialized)throw Error("Initialize Appacitive SDK");"function"==typeof b.beforeSend&&b.beforeSend(b);k(b,e,f)};return b};c.http=new function(){var e=new b,k=new g(e),d=!1;this.pause=function(){d=!0};this.unpause=function(){d=!1};this.addProcessor=function(b){var d=Error('Must provide a processor object with either a "pre" function or a "post" function.');
if(!b)throw d;if(!b.pre&&!b.post)throw d;k.addProcessor(b)};this.send=function(b){b.promise=c.Promise.is(b.promise)?b.promise:new c.Promise.buildPromise({error:b.onError});k.enqueueRequest(b);e.isOnline()&&!1===d&&k.notify();return b.promise};this.flush=function(b){b?k.notify():e.isOnline()&&k.notify()};this.onError=function(b,d){var e=d.responseText;c.logs.logRequest(b,e,e,"error");b.entity&&b.entity._triggerError&&b.entity._triggerError(b.options,new c.Error(e));b.promise.reject(new c.Error(e),
b.entity)};e.onError=this.onError;this.onResponse=function(b,d){if(b.onSuccess)if(b.context)b.onSuccess.apply(b.context,[d]);else b.onSuccess(d);c.logs.logRequest(b,d,d?d.status:null,"successful")};e.onResponse=this.onResponse};c.HttpRequest=function(b){b=b||{};this.url=b.url||"";this.data=b.data||{};this.headers=b.headers||[];this.method=b.method||"GET";this.onSuccess=b.onSuccess||function(){};this.onError=b.onError||function(){};this.send=function(b){return new c._Http(this,b)}};(function(b){var c=
b.Appacitive;c&&c.http&&(c.http.addProcessor({pre:function(b){return b},post:function(b,e){try{var f=c.Session.isSessionValid(b);f.status?b&&(b.status&&b.status.code&&("19036"==b.status.code||"421"==b.status.code)||b.code&&("19036"==b.code||"421"==b.code))?c.Users.logout():c.Session.incrementExpiry():f.isSession&&(null!==c.Session.get()&&c.Session.resetSession(),c.http.send(e))}catch(l){}}}),c.http.addProcessor({pre:function(b){return{start:(new Date).getTime(),request:b}},post:function(b,c){c.request.timeTakenInMilliseconds=
(new Date).getTime()-c.start}}))})(m)})(global);var _type=function(m){if(null===m)return"null";if("undefined"===typeof m||"undefined"===m)return"undefined";if(m&&(1===m.nodeType||9===m.nodeType))return"element";var c=Object.prototype.toString.call(m).match(/\[object (.*?)\]/)[1].toLowerCase();if("number"===c){if(isNaN(m))return"nan";if(!isFinite(m))return"infinity"}return c};
(function(m){"bind"in Function.prototype||(Function.prototype.bind=function(b){var d=this;if(1>=arguments.length)return function(){return d.apply(b,arguments)};var c=Array.prototype.slice.call(arguments,1);return function(){return d.apply(b,0===arguments.length?c:c.concat(Array.prototype.slice.call(arguments)))}});"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});"indexOf"in Array.prototype||(Array.prototype.indexOf=function(b,d){void 0===
d&&(d=0);0>d&&(d+=this.length);0>d&&(d=0);for(var c=this.length;d<c;d++)if(d in this&&this[d]===b)return d;return-1});"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(b,d){void 0===d&&(d=this.length-1);0>d&&(d+=this.length);d>this.length-1&&(d=this.length-1);for(d++;0<d--;)if(d in this&&this[d]===b)return d;return-1});"forEach"in Array.prototype||(Array.prototype.forEach=function(b,d){for(var c=0,f=this.length;c<f;c++)c in this&&b.call(d,this[c],c,this)});"map"in Array.prototype||
(Array.prototype.map=function(b,d){for(var c=Array(this.length),f=0,e=this.length;f<e;f++)f in this&&(c[f]=b.call(d,this[f],f,this));return c});"filter"in Array.prototype||(Array.prototype.filter=function(b,d){for(var c=[],f,e=0,h=this.length;e<h;e++)e in this&&b.call(d,f=this[e],e,this)&&c.push(f);return c});"every"in Array.prototype||(Array.prototype.every=function(b,d){for(var c=0,f=this.length;c<f;c++)if(c in this&&!b.call(d,this[c],c,this))return!1;return!0});"some"in Array.prototype||(Array.prototype.some=
function(b,d){for(var c=0,f=this.length;c<f;c++)if(c in this&&b.call(d,this[c],c,this))return!0;return!1});"find"in Array.prototype||(Array.prototype.find=function(b,d){var c=this.length;if(0!==c)for(var f=0,e;f<c&&f in this;f++)if(e=this[f],b.call(d,e,f,this))return e});"where"in Array.prototype||(Array.prototype.where=function(b,d){return 0===this.length?void 0:Object.isEmpty(b)?d?void 0:[]:this[d?"find":"filter"](function(d){for(var c in b)if(b[c]!==d[c])return!1;return!0})},Array.prototype.findWhere=
function(b){return this.where(b,!0)});"each"in Array.prototype||(Array.prototype.each=function(b,d){for(var c=0;c<this.length;c++)b.apply(d,[this[c]])});"difference"in Array.prototype||(Array.prototype.difference=function(b){return this.filter(function(d){return 0>b.indexOf(d)})});"without"in Array.prototype||(Array.prototype.without=function(){return this.difference(Array.prototype.slice.call(arguments,0))});"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(b){if(null===
this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof b)throw new TypeError(b+" is not a function");var d=Object(this),c=d.length>>>0,f=0,e;if(2<=arguments.length)e=arguments[1];else{for(;f<c&&!f in d;)f++;if(f>=c)throw new TypeError("Reduce of empty array with no initial value");e=d[f++]}for(;f<c;f++)f in d&&(e=b(e,d[f],f,d));return e});var c=function(b,d){return null==b?_.identity:_.isFunction(b)?d?function(){return b.apply(d,
arguments)}:b:function(d){return d[b]}};Array.prototype.pluck=function(b){var d=[];this.each(function(c){d.push(c[b])});return d};Array.prototype.sortBy=function(b,d){b=c(b,d);return this.map(function(c,f){return{value:c,criteria:b.call(d,c,f,this)}},this).sort(function(b,d){var c=b.criteria,e=d.criteria;return c<e?-1:c>e?1:0}).pluck("value")};Array.prototype.removeAll=function(b){for(var d=null,c=0;c<this.length;c++)for(;this[c]===b;)d=this.splice(c,1)[0];return d};Array.prototype.compare=function(b){if(!b||
this.length!=b.length)return!1;for(var d=0,c=this.length;d<c;d++)if(this[d]instanceof Array&&b[d]instanceof Array){if(!this[d].compare(b[d]))return!1}else if(this[d]!=b[d])return!1;return!0};Array.prototype.equals=function(b,d){if(!b)return!1;1==arguments.length&&(d=!1);if(this.length!=b.length)return!1;for(var c=0;c<this.length;c++)if(this[c]instanceof Array&&b[c]instanceof Array){if(!this[c].equals(b[c],d))return!1}else{if(d&&!_type.isEqual(this[c],b[c]))return!1;if(!d)return this.sort().equals(b.sort(),
!0)}return!0};Date.prototype.toISOString||function(){function b(c){c=String(c);1===c.length&&(c="0"+c);return c}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}();String.addSlashes=function(b){if(!b)return b;b=b.replace(/\\/g,"\\\\");b=b.replace(/\'/g,"\\'");b=b.replace(/\"/g,
'\\"');return b=b.replace(/\0/g,"\\0")};String.stripSlashes=function(b){if(!b)return b;b=b.replace(/\\'/g,"'");b=b.replace(/\\"/g,'"');b=b.replace(/\\0/g,"\x00");return b=b.replace(/\\\\/g,"\\")};if("undefined"===typeof console||null===console)console={log:function(){},dir:function(){}};for(var g="Null Undefined Object Array String Number Boolean Function RegExp Element NaN Infinite".split(" "),h=function(b){_type["is"+b]=function(c){return _type(c)===b.toLowerCase()}},b=0;b<g.length;b++)h(g[b]);
_type.isNullOrUndefined=function(b){return"null"==_type(b)||"undefined"==_type(b)};_type.isNumeric=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};_type.isDate=function(b){return b instanceof Date};var e=function(b,c,h,f){var l=Object.prototype.toString;if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;var g=l.call(b);if(g!=l.call(c))return!1;switch(g){case "[object String]":return b==String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==
+c}if("object"!=typeof b||"object"!=typeof c)return!1;if(b instanceof m.Appacitive.GeoCoord&&c instanceof m.Appacitive.GeoCoord)return b.toString()==c.toString();for(l=h.length;l--;)if(h[l]==b)return f[l]==c;var l=b.constructor,q=c.constructor;if(l!==q&&!(_types.isFunction(l)&&l instanceof l&&_types.isFunction(q)&&q instanceof q)&&"constructor"in b&&"constructor"in c)return!1;h.push(b);f.push(c);l=0;q=!0;if("[object Array]"==g){if(l=b.length,q=l==c.length)for(;l--&&(q=e(b[l],c[l],h,f)););}else{for(var u in b)if(Object.prototype.hasOwnProperty.call(b,
u)&&(l++,!(q=Object.prototype.hasOwnProperty.call(c,u)&&e(b[u],c[u],h,f))))break;if(q){for(u in c)if(Object.prototype.hasOwnProperty.call(c,u)&&!l--)break;q=!l}}h.pop();f.pop();return q};_type.isEqual=function(b,c){return e(b,c,[],[])};m.Appacitive.utils=m.Appacitive.utils||{};m.Appacitive.utils._type=_type})(global);
(function(m){var c=Array.prototype,g=Object.prototype,h=m.Appacitive;h.utils._each=function(b,h,d){if(null!=b)if(c.forEach&&b.forEach===c.forEach)b.forEach(h,d);else if(b.length===+b.length)for(var r=0,f=b.length;r<f&&h.call(d,b[r],r,b)!=={};r++);else for(r in b)if(g.hasOwnProperty.call(b,r)&&h.call(d,b[r],r,b)==={})break};h.utils._extend=function(b){h.utils._each(c.slice.call(arguments,1),function(c){if(c)for(var d in c)b[d]=c[d]});return b};h.utils._reject=function(b,c){return b.filter(function(b){return!c(b)})};
h.utils._deepExtend=function(b){h.utils._each(Array.prototype.slice.call(arguments,1),function(c){for(var d in c)h.utils._type.isArray(c[d])?(h.utils._type.isArray(b[d])||(b[d]=[]),b[d]=h.utils._reject(h.utils._extend(b[d],c[d]),function(b){return h.utils._type.isNull(b)})):!h.utils._type.isObject(c[d])||c[d]instanceof h.Object||c[d]instanceof h.Connection||c[d]instanceof h.GeoCoord?b[d]=c[d]:(h.utils._type.isObject(b[d])||(b[d]={}),b[d]=h.utils._extend(b[d],c[d]))});return b};var b=function(b,c){var d=
this,g;g=h.utils._type.isObject(b)&&b.hasOwnProperty("constructor")?b.constructor:function(){return d.apply(this,arguments)};h.utils._extend(g,d,c);var f=function(){this.constructor=g};f.prototype=d.prototype;g.prototype=new f;b&&h.utils._extend(g.prototype,b);g.__super__=d.prototype;return g};h.utils.classExtend=function(c,h,d){return b.apply(c,[h,d])};h.utils._result=function(b,c,d){c=null==b?void 0:b[c];void 0===c&&(c=d);return h.utils._type.isFunction(c)?c.call(b):c};h.clone=h.utils._clone=function(b){return h.utils._type.isObject(b)?
h.utils._type.isArray(b)?b.slice():h.utils._extend({},b):b}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type;c.logs={};var h=function(b,c){setTimeout(function(){try{b.call({},c)}catch(h){}},0)};c.logs.logRequest=function(b,e,k,d){e=e||{};k=k||{};var r={};try{r=JSON.parse(b.data),g.isObject(r)||(r={})}catch(f){}var l={status:d,referenceId:k.referenceid,date:(new Date).toISOString(),method:r.m,url:decodeURIComponent(b.url),responseTime:b.timeTakenInMilliseconds,headers:{},request:null,response:e,description:b.description};b.headers&&b.headers.forEach(function(b){l.headers[b.key]=
b.value});b.prevHeaders&&b.prevHeaders.forEach(function(b){l.headers[b.key]=b.value});"GET"!==l.method&&(l.request=r.b);"error"==d&&(c.runtime.isBrowser&&console.dir(l),g.isFunction(c.logs.apiErrorLog)&&h(c.logs.apiErrorLog,l));g.isFunction(c.logs.apiLog)&&h(c.logs.apiLog,l)};c.logs.logException=function(b){g.isFunction(c.logs.exceptionLog)&&h(c.logs.exceptionLog,b)}})(global);
(function(m){var c=m.Appacitive;String.format=function(c,h){if(1>=arguments.length)return c;for(var b=arguments.length-2,e=0;e<=b;e++)c=c.replace(new RegExp("\\{"+e+"\\}","gi"),arguments[e+1]);return c};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(c){var h=new RegExp("^"+c),b=this;h.test(b)&&(b=b.slice(1,b.length));h=new RegExp(c+"$");h.test(b)&&(b=b.slice(0,-1));return b};String.toSearchString=function(c){"undefined"===
typeof c&&(c="");for(var h="",b=0;b<c.length;b+=1)-1===" .,;#".indexOf(c[b])&&(h+=c[b]);return h=h.toLowerCase()};String.contains=function(c,h){return-1!==c.indexOf(h)};String.startsWith=function(c,h){return 0===c.indexOf(h)};Array.distinct=function(c){var h=[],b=c.length,e,k,d;for(k=0;k<b;k++){e=void 0;for(d=0;d<h.length;d++)if(c[k].toLowerCase()===h[d].toLowerCase()){e=!0;break}e||h.push(c[k])}return h};Object.isEmpty=function(c){if(!c)return!0;var h=!0,b;for(b in c){h=!1;break}return h};m.dateFromWcf=
function(c,h){var b=/Date\(([^)]+)\)/.exec(c);if(2!=b.length){if(!h)return s;throw Error(s+" is not .net json date.");}return new Date(parseFloat(b[1]))};c.storage=c.storage||{};c.storage.urlFactory=new function(){c.bag=c.bag||{};var g=function(c){"object"===typeof c&&0<c.length&&("string"===typeof c[0]||"number"===typeof c[0])&&(c=c.join(","));c||(c="");return c};this.application={applicationServiceUrl:"application",getSessionCreateUrl:function(){return String.format("{0}/session",this.applicationServiceUrl)}};
this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(c,b){return String.format("{0}/create?fields={1}",this.userServiceUrl,g(b))},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getGetUrl:function(c,b,e){return String.format("{0}/{1}?fields={2}",c,b,g(e))},getUserByTokenUrl:function(c){return String.format("{0}/me?useridtype=token&token={1}",
this.userServiceUrl,c)},getUserByUsernameUrl:function(c){return String.format("{0}/{1}?useridtype=username",this.userServiceUrl,c)},getUpdateUrl:function(c,b,e){return e?String.format("{0}/{1}?fields={2}&revision={3}",this.userServiceUrl,c,g(b),e):String.format("{0}/{1}?fields={2}",this.userServiceUrl,c,g(b))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}?deleteconnections=true",this.userServiceUrl,b):String.format("{0}/{1}",this.userServiceUrl,b)},getGetAllLinkedAccountsUrl:function(c){return String.format("{0}/{1}/linkedaccounts",
this.userServiceUrl,c)},getValidateTokenUrl:function(c){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,c)},getInvalidateTokenUrl:function(c){return String.format("{0}/invalidate?userToken={1}",this.userServiceUrl,c)},getSendResetPasswordEmailUrl:function(){return String.format("{0}/sendresetpasswordemail",this.userServiceUrl)},getUpdatePasswordUrl:function(c){return String.format("{0}/{1}/changepassword",this.userServiceUrl,c)},getLinkAccountUrl:function(c){return String.format("{0}/{1}/link",
this.userServiceUrl,c)},getDelinkAccountUrl:function(c,b){return String.format("{0}/{1}/{2}/delink",this.userServiceUrl,c,b)},getCheckinUrl:function(c,b,e){return String.format("{0}/{1}/chekin?lat={2}&lng={3}",this.userServiceUrl,c,b,e)},getResetPasswordUrl:function(c){return String.format("{0}/resetpassword?token={1}",this.userServiceUrl,c)},getValidateResetPasswordUrl:function(c){return String.format("{0}/validateresetpasswordtoken?token={1}",this.userServiceUrl,c)}};this.device={deviceServiceUrl:"device",
getCreateUrl:function(c,b){return String.format("{0}/register?fields={1}",this.deviceServiceUrl,g(b))},getGetUrl:function(c,b,e){return String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,b,g(e))},getUpdateUrl:function(c,b,e){return e?String.format("{0}/{1}?fields={2}&revision={3}",this.deviceServiceUrl,c,g(b),e):String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,c,g(b))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}?deleteconnections=true",this.deviceServiceUrl,b):String.format("{0}/{1}",
this.deviceServiceUrl,b)}};this.object={objectServiceUrl:"object",getSearchAllUrl:function(c,b,e){var g="",g=String.format("{0}/search/{1}/all",this.objectServiceUrl,c),g=e?g+"?psize="+e:g+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(c=0;c<b.length;c+=1)0!==b[c].trim().length&&(g=g+"&"+b[c]);return g},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.objectServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/search/{1}/all?properties={2}",
this.objectServiceUrl,c,b)},getMultiGetUrl:function(c,b,e){return String.format("{0}/{1}/multiGet/{2}?fields={3}",this.objectServiceUrl,c,b,g(e))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.objectServiceUrl,c,g(b))},getGetUrl:function(c,b,e){return String.format("{0}/{1}/{2}?fields={3}",this.objectServiceUrl,c,b,g(e))},getUpdateUrl:function(c,b,e,k){return k?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.objectServiceUrl,c,b,g(e),k):String.format("{0}/{1}/{2}?fields={3}",
this.objectServiceUrl,c,b,g(e))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}/{2}?deleteconnections=true",this.objectServiceUrl,c,b):String.format("{0}/{1}/{2}",this.objectServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",this.objectServiceUrl,c)}};this.connection={connectionServiceUrl:"connection",getGetUrl:function(c,b,e){return String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,g(e))},getMultiGetUrl:function(c,b,e){return String.format("{0}/{1}/multiGet/{2}?fields={3}",
this.connectionServiceUrl,c,b,g(e))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.connectionServiceUrl,c,g(b))},getUpdateUrl:function(c,b,e,k){return k?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.connectionServiceUrl,c,b,g(e),k):String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,g(e))},getDeleteUrl:function(c,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",
this.connectionServiceUrl,c)},getSearchByArticleUrl:function(c,b,e,g){var d="",d=String.format("{0}/{1}/find/all?label={2}&objectid={3}",this.connectionServiceUrl,c,e,b);if("undefined"!==typeof g&&0<g.length)for(c=0;c<g.length;c+=1)d=d+"&"+g[c];return d},getConnectedArticles:function(c,b,e){var g="",g=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,c,b);if(e&&e.length&&0<e.length)for(c=0;c<e.length;c+=1)g=0===c?g+("?"+e[c]):g+("&"+e[c]);return g},getInterconnectsUrl:function(){return String.format("{0}/interconnects",
this.connectionServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/{1}/find/all?properties=",this.connectionServiceUrl,c,b)}};this.cannedList={cannedListServiceUrl:"list",getGetListItemsUrl:function(c){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,c)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",this.pushServiceUrl)},getGetNotificationUrl:function(c){return String.format("{0}/notification/{1}",this.pushServiceUrl,
c)},getGetAllNotificationsUrl:function(c){return String.format("{0}/getAll?psize={1}&pnum={2}",this.pushServiceUrl,c.psize,c.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(c,b){return b&&0<b.length?String.format("{0}/uploadurl?contenttype={1}&expires=20&filename={2}",this.fileServiceUrl,escape(c),escape(b)):String.format("{0}/uploadurl?contenttype={1}&expires=20",this.fileServiceUrl,escape(c))},getUpdateUrl:function(c,b){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",
this.fileServiceUrl,c,escape(b))},getDownloadUrl:function(c,b){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,c,b)},getDeleteUrl:function(c){return String.format("{0}/delete/{1}",this.fileServiceUrl,c)}};this.query={params:function(c){var b=[];return""===location.search||-1===location.search.indexOf("?")?b:c?(c=c.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(e,g){var d=g.split("="),r=d[1];2<d.length&&d.forEach(function(b,c){0!==b&&1!==b&&(r=r+"="+
d[b])});d[0].toLowerCase()===c&&(b=[d[0],r])}),b):location.search.split("?")[1].split("=")}};this.usergroup={usergroupServiceUrl:"usergroup",getUpdateUrl:function(c){return String.format("{0}/{1}/members",this.usergroupServiceUrl,c)}};this.ping={pingServiceUrl:"ping",getPingUrl:function(){return String.format("{0}/",this.pingServiceUrl)}};this.multi={multiServiceUrl:"multi",getBatchUrl:function(){return String.format("{0}/",this.multiServiceUrl)}}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h;h=c.runtime.isNode?process.nextTick:setTimeout;var b=function(){if(!(this instanceof b))return new b;this.calls=[]};b.prototype.isResolved=function(){return 1===this.state?!0:!1};b.prototype.isRejected=function(){return 2===this.state?!0:!1};b.prototype.isFulfilled=function(){return 1===this.state||2===this.state?!0:!1};b.prototype.done=function(){var e,g,d=this.state,h=this.value;if(!d)return this;for(;e=this.calls.shift();)if(g=e[0],"function"===
typeof e[d]){try{h=2===d?e[d].call(g,this.value):e[d].apply(g,this.value)}catch(f){c.logs.logException({name:f.name,message:f.message,stack:f.stack});if(0==g.calls.length)throw f;g.reject(f)}h instanceof b||h&&"function"===typeof h.then?h.then(function(b){g.fulfill(b)},function(b){g.reject(b)}):1===d?g.fulfill(h):g.reject(h)}else 1===d?g.fulfill(h):g.reject(h)};b.prototype.fulfill=function(b){if(this.state)return this;this.state=1;this.reason=this.value=[].slice.call(arguments);this.done();return this};
b.prototype.resolve=b.prototype.fulfill;b.prototype.reject=function(b){if(this.state)return this;this.state=2;this.reason=this.value=b;this.done();return this};b.prototype.then=function(c,g){var d=this,r=new b;this.calls[this.calls.length]=[r,c,g];this.state&&h(function(){d.done()});return r};b.when=function(c){var k=[],d=[],r,f=0,l=new b;if(!c||g.isArray(c)&&0==c.length)return l.fulfill(k),l;var v=function(){f+=1;f==r&&(l.state||(0<d.length?l.reject(d,k?k:[]):l.fulfill(k?k:[])))},q=function(f){var l=
c[f];l instanceof b||l&&"function"===typeof l.then?h(function(){l.then(function(b){k[f]=b;v()},function(b){d[f]=b;v()})}):h(function(){try{k[f]=l.call()}catch(b){d[f]=b}v()})};g.isArray(c)||(c=[c]);r=c.length;for(var u=0;u<r;u+=1)q(u);return l};b.is=function(c){return c instanceof b?!0:!1};b.buildPromise=function(c){var h=new b;g.isObject(c)&&h.then(c.success,c.error);return h};b._continueUntil=function(c,h){return g.isFunction(c)&&c()?h().then(function(){return b._continueUntil(c,h)}):(new b).fulfill()};
c.Promise=b})(global);
(function(m){m.Appacitive.eventManager=new function(){function c(){var c=function(){return Math.floor(65536*Math.random()).toString(16)};return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}var g={};this.subscribe=function(h,b){if("string"!=typeof h||"function"!=typeof b)throw Error("Incorrect subscription call");"undefined"==typeof g[h]&&(g[h]=[]);var e=c();g[h].push({callback:b,id:e});return e};this.unsubscribe=function(c){if(!c)return!1;var b=-1,e=null,k;for(k in g)for(var d=0;d<g[k].length;d+=
1)if(g[k][d].id==c){b=d;e=k;break}return-1!=b?(g[e].splice(b,1),!0):!1};this.fire=function(c,b,e){if("string"!=typeof c)throw Error("Incorrect fire call");if("undefined"==typeof e||null===e)e={};e.eventName=c;if("undefined"!=typeof g.all)for(var k=0;k<g.all.length;k+=1)g.all[k].callback(b,e);k=function(b,c,d){setTimeout(function(){b(c,d)},0)};if("undefined"!=typeof g[c])for(var d=0;d<g[c].length;d+=1)k(g[c][d].callback,b,e)};this.clearSubscriptions=function(c){if("string"!=typeof c)throw Error("Event Name must be string in EventManager.clearSubscriptions");
g[c]&&(g[c].length=0);return this};this.clearAndSubscribe=function(c,b){this.clearSubscriptions(c);this.subscribe(c,b)};this.dump=function(){console.dir(g)}}})(global);
(function(m){var c={},g=Array.prototype.forEach,h=Object.prototype.hasOwnProperty,b=Array.prototype.slice,e=0,k=function(){return{keys:Object.keys,uniqueId:function(b){var c=++e+"";return b?b+c:c},has:function(b,c){return h.call(b,c)},each:function(b,d,f){if(null!=b)if(g&&b.forEach===g)b.forEach(d,f);else if(b.length===+b.length)for(var l=0,e=b.length;l<e&&d.call(f,b[l],l,b)!==c;l++);else for(l in b)if(this.has(b,l)&&d.call(f,b[l],l,b)===c)break},once:function(b){var c=!1,d;return function(){if(c)return d;
c=!0;d=b.apply(this,arguments);b=null;return d}}}}(),d;d={on:function(b,c,d){if(!f(this,"on",b,[c,d])||!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:d,ctx:d||this});return this},once:function(b,c,d){if(!f(this,"once",b,[c,d])||!c)return this;var l=this,e=k.once(function(){l.off(b,e);c.apply(this,arguments)});e._callback=c;return this.on(b,e,d)},off:function(b,c,d){var l,e,g,h,r,m,w,z;if(!this._events||!f(this,"off",b,[c,d]))return this;
if(!b&&!c&&!d)return this._events={},this;h=b?[b]:k.keys(this._events);r=0;for(m=h.length;r<m;r++)if(b=h[r],g=this._events[b]){this._events[b]=l=[];if(c||d)for(w=0,z=g.length;w<z;w++)e=g[w],(c&&c!==e.callback&&c!==e.callback._callback||d&&d!==e.context)&&l.push(e);l.length||delete this._events[b]}return this},trigger:function(c){if(!this._events)return this;var d=b.call(arguments,1);if(!f(this,"trigger",c,d))return this;var e=this._events[c],g=this._events.all;e&&l(e,d);g&&l(g,arguments);return this},
stopListening:function(b,c,d){var f=this._listeners;if(!f)return this;var l=!c&&!d;"object"===typeof c&&(d=this);b&&((f={})[b._listenerId]=b);for(var e in f)f[e].off(c,d,this),l&&delete this._listeners[e];return this}};var r=/\s+/,f=function(b,c,d,f){if(!d)return!0;if("object"===typeof d){for(var l in d)b[c].apply(b,[l,d[l]].concat(f));return!1}if(r.test(d)){d=d.split(r);l=0;for(var e=d.length;l<e;l++)b[c].apply(b,[d[l]].concat(f));return!1}return!0},l=function(b,c){var d,f=-1,l=b.length,e=c[0],g=
c[1],h=c[2];switch(c.length){case 0:for(;++f<l;)(d=b[f]).callback.call(d.ctx);break;case 1:for(;++f<l;)(d=b[f]).callback.call(d.ctx,e);break;case 2:for(;++f<l;)(d=b[f]).callback.call(d.ctx,e,g);break;case 3:for(;++f<l;)(d=b[f]).callback.call(d.ctx,e,g,h);break;default:for(;++f<l;)(d=b[f]).callback.apply(d.ctx,c)}};k.each({listenTo:"on",listenToOnce:"once"},function(b,c){d[c]=function(c,d,f){var l=this._listeners||(this._listeners={}),e=c._listenerId||(c._listenerId=k.uniqueId("l"));l[e]=c;"object"===
typeof d&&(f=this);c[b](d,f,this);return this}});d.bind=d.on;d.unbind=d.off;d.mixin=function(b){k.each("on once off trigger stopListening listenTo listenToOnce bind unbind".split(" "),function(c){b[c]=this[c]},this);return b};m.Appacitive.Events=d})(global);
(function(m){m.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/v1.0/",metadata:!0};m.navigator&&_type.isObject(m.navigator.userAgent)&&_type.isFunction(m.navigator.userAgent.indexOf)&&(-1!=m.navigator.userAgent.indexOf("MSIE 8")||-1!=m.navigator.userAgent.indexOf("MSIE 9"))&&(m.Appacitive.config.apiBaseUrl=window.location.protocol+"//apis.appacitive.com/v1.0/")})(global);
(function(m){var c=m.Appacitive,g=c.utils._type;m=function(h){var b;if(!h||!g.isObject(h))throw Error("Please specify request options");this.promise=c.Promise.buildPromise(h.options);var e=this.request=new c.HttpRequest;b=c.storage.urlFactory[h.type];var k=h.op.replace("get","").replace("Url","")+" "+h.type;b=c.config.apiBaseUrl+b[h.op].apply(b,h.args||[]);e.url=b;e.description=k;e.method=h.method||"get";e.data=h.data||{};e.onSuccess=h.onSuccess;e.onError=h.onError;e.promise=this.promise;e.options=
h.options;h.entity&&(e.entity=h.entity);return this};m.prototype.send=function(){return c.http.send(this.request)};c._Request=m})(global);
(function(m){m=m.Appacitive;var c=m.utils._type,g=m.utils._extend;m.Error=function(g,b,e,k){if(c.isString(g)||c.isNumber(g))g={code:g,message:b,referenceId:e,additionalMessages:k};this.code=g.code||"400";this.message=g.message||"Unknown Error";g.referenceId&&(this.referenceId=g.referenceid||g.referenceId);g.additionalmessages&&(this.additionalMessages=g.additionalmessages||additionalMessages)};m.Error.toJSON=function(c){return{code:c.code,message:c.message,referenceId:c.referenceId,additionalmessages:c.additionalMessages}};
g(m.Error,{BadRequest:"400",AccessControl:"401",PaymentRequired:"402",UsageLimitReached:"403",NotFound:"404",Duplicate:"435",MvccFailure:"409",PreconditionFailed:"412",ApiAuthenticationError:"420",IdentityFailures:"421",IncorrectConfiguration:"436",InternalServerError:"500",DataAccessFailure:"512",UnknownCause:100,InvalidParameters:"400",ConnectionFailed:1001,MissingId:"404",InvalidJson:1007,DuplicateUsername:"435",DuplicateValue:"435",XDomainRequest:5E3})})(global);
(function(m){var c=m.Appacitive,g=c.utils._type;c.Session=new function(){this.initialized=!1;var h=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},b=null,e=null,k=null,d=!1,r;this.useApiKey=!0;this.useMasterKey=!1;this.onSessionCreated=function(){};this.recreate=function(b){return c.Session.create(b)};this.create=function(d){if(!this.initialized)throw Error("Initialize Appacitive SDK");var f=new h;f.apikey=e;var g=new c._Request({method:"PUT",type:"application",
op:"getSessionCreateUrl",options:d,data:f,onSuccess:function(d){b=d.session.sessionkey;c.Session.useApiKey=!1;g.promise.fulfill(d);c.Session.onSessionCreated()}});return g.send()};c.http.addProcessor({pre:function(f){f.options=f.options||{};if(c.Session.useApiKey){var h=e;(f.options.useMasterKey||c.useMasterKey&&!f.options.useMasterKey)&&g.isString(r)&&0<r.length?h=r:g.isString(f.options.apikey)&&(h=f.options.apikey);f.headers.push({key:"ak",value:h})}else f.headers.push({key:"as",value:b});h=g.isString(f.options.userToken)&&
0<f.options.userToken.length?f.options.userToken:!1;if(!0===d||h){var q=-1,u=f.headers.filter(function(b,c){return"ut"==b.key?(q=c,!0):!1});if(f.options.ignoreUserToken)-1!=q&&f.headers.splice(q,1);else{var t=h||k;1==u.length?f.headers.forEach(function(b){"ut"==b.key&&(b.value=t)}):f.headers.push({key:"ut",value:t})}}}});this.setUserAuthHeader=function(b,f,e){try{b&&(d=!0,k=b,e||(f||(f=-1),-1==f&&(f=null),c.LocalStorage.set("Appacitive-UserToken",b),c.LocalStorage.set("Appacitive-UserTokenExpiry",
f),c.LocalStorage.set("Appacitive-UserTokenDate",(new Date).getTime())))}catch(g){}};this.incrementExpiry=function(){try{c.runtime.isBrowser&&d&&c.LocalStorage.set("Appacitive-UserTokenDate",(new Date).getTime())}catch(b){}};this.removeUserAuthHeader=function(b,f){var e=c.Promise.buildPromise(f);b||c.User.trigger("logout",{});c.LocalStorage.remove("Appacitive-User");if(k&&b)try{var g=new c.HttpRequest(f);g.url=c.config.apiBaseUrl+c.storage.urlFactory.user.getInvalidateTokenUrl(k);g.method="POST";
g.data={};g.type="user";g.options=f;g.description="InvalidateToken user";g.onSuccess=g.onError=function(){d=!1;k=null;c.User.trigger("logout",{});c.LocalStorage.remove("Appacitive-UserToken");c.LocalStorage.remove("Appacitive-UserTokenExpiry");c.LocalStorage.remove("Appacitive-UserTokenDate");e.fulfill()};c.http.send(g);return e}catch(h){}else return d=!1,k=null,c.LocalStorage.remove("Appacitive-UserToken"),c.LocalStorage.remove("Appacitive-UserTokenExpiry"),c.LocalStorage.remove("Appacitive-UserTokenDate"),
e.fulfill()};this.isSessionValid=function(b){if(b.status){if(b.status.code&&("420"==b.status.code||"19027"==b.status.code||"19002"==b.status.code))return{status:!1,isSession:"19027"==b.status.code||"420"==b.status.code?!0:!1}}else if(b.code&&("420"==b.code||"19027"==b.code||"19002"==b.code))return{status:!1,isSession:"19027"==b.code||"420"==b.code?!0:!1};return{status:!0}};this.resetSession=function(){b=null;this.useApiKey=!0};this.get=function(){return b};this.setSession=function(c){c&&(b=c,this.useApiKey=
!1)};this.setApiKey=function(b){b&&(e=b,this.useApiKey=!0)};this.setMasterKey=function(b){r=b};this.reset=function(){this.removeUserAuthHeader();k=e=b=null;d=!1;r=null;this.useMasterKey=this.useApiKey=this.initialized=!1};var f="sandbox";this.environment=function(){if(1==arguments.length){var b=arguments[0];"sandbox"!=b&&"live"!=b&&(b="sandbox");f=b}return f}};c.getAppPrefix=function(g){return c.Session.environment()+"/"+c.appId+"/"+g};c.ping=function(g){if(!c.Session.initialized)throw Error("Initialize Appacitive SDK");
var b=new c._Request({method:"GET",type:"ping",op:"getPingUrl",options:g,onSuccess:function(c){return b.promise.fulfill(c.status)}});return b.send()};c.reset=function(){c.Session.reset()}})(global);(function(m){var c=m.Appacitive;c&&c.http&&(c.http.addProcessor({pre:function(g){var h=c.Session.environment();g.options=g.options||{};_type.isString(g.options.env)&&(h=g.options.env);g.headers.push({key:"e",value:h})}}),c.Events.mixin(c))})(global);
(function(m){var c=m.Appacitive,g=c.utils._type;c.GeoCoord=function(b,d){var f=function(b,c){if(isNaN(b)||isNaN(c))throw Error("Invalid Latitiude or longitiude provided");if(-90>b||90<b)throw Error("Latitude "+b+" should be in range of  -90.0 to 90.");if(-180>c||180<c)throw Error("Latitude "+c+" should be in range of  -180.0 to 180.");},e=function(b){if("string"!==typeof b||0==b.length)return!1;b=b.split(",");if(2!==b.length)return!1;try{return new c.GeoCoord(b[0],b[1])}catch(d){return!1}};if(g.isString(b)&&
!d&&(e=e(b)))return e;b&&d?(f(b,d),this.lat=b,this.lng=d):this.lng=this.lat=0;this.toJSON=function(){return{latitude:this.lat,longitude:this.lng}};this.getValue=function(){return String.format("{0},{1}",b,d)};this.toString=function(){return this.getValue()}};var h=function(){this.toString=function(){};this.Or=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new q(u.or,b)};this.And=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new q(u.and,
b)}},b=function(b){h.call(this);b=b||{};this.fieldType=b.fieldType;this.field=b.field||"";this.value=b.value;this.operator=b.operator;this.getFieldType=function(){switch(this.fieldType){case "property":return"*";case "attribute":return"@";case "aggregate":return"$";default:return"*"}};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue())}};b.prototype=new h;b.prototype.constructor=b;var e=function(d){d=d||"";
if(!g.isArray(d.value)||!d.value.length)throw Error("Specify field value as array");b.call(this,d);var f=function(b){return g.isString(b)?"'"+b+"'":g.isNumber(b)?b:g.isDate(b)?"datetime('"+c.Date.toISOString(b)+"')":"'"+b.toString()+"'"};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,f(this.value[c])));return"("+b.join(" or ")+")"}};e.prototype=new b;e.prototype.constructor=e;var k=
function(c){c=c||"";if(!g.isArray(c.value)||!c.value.length)throw Error("Specify field value as array");b.call(this,c);var d=function(b){return g.isString(b)?"'"+b+"'":g.isNumber(b)?b:b.toString()};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(d(this.value[c]));return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,b.join(","))}};k.prototype=new b;k.prototype.constructor=k;var d=function(c){b.call(this,c||"");this.toString=function(){return String.format("{0}{1} {2}",
this.getFieldType(),this.field.toLowerCase(),this.operator)}};d.prototype=new b;d.prototype.constructor=d;var r=function(c){c=c||"";if(!c.val1)throw Error("Specify field value1 ");if(!c.val2)throw Error("Specify field value2 ");this.val1=c.val1;this.val2=c.val2;b.call(this,c);delete this.value;this.toString=function(){return String.format("{0}{1} {2} ({3},{4})",this.getFieldType(),this.field.toLowerCase(),this.operator,this.val1.getValue(),this.val2.getValue())}};r.prototype=new b;r.prototype.constructor=
r;var f=function(d){d=d||"";if(!(d.geoCoord&&d.geoCoord instanceof c.GeoCoord))throw Error("withinCircle filter needs Appacitive.GeoCoord object as argument");b.call(this,d);this.value=d.geoCoord;this.unit=d.unit||"mi";this.distance=d.distance||5;this.toString=function(){return String.format("{0}{1} {2} {3},{4} {5}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue(),this.distance,this.unit)}};f.prototype=new b;f.prototype.constructor=r;var l=function(c){c=c||"";if(!c.geoCoords||
0===c.geoCoords.length)throw Error("polygon filter needs array of Appacitive.GeoCoord objects as argument");if(3>c.geoCoords.length)throw Error("polygon filter needs atleast 3 Appacitive.GeoCoord objects as arguments");b.call(this,c);this.value=c.geoCoords;var d=function(b){var c="";b.forEach(function(b){c=0===c.length?b.toString():c+(" | "+b.toString())});return c};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,d(this.value))}};
l.prototype=new b;l.prototype.constructor=r;var v=function(b){h.call(this);b=b||{};if(!b.tags||!g.isArray(b.tags)||0===b.tags.length)throw Error("Specify valid tags");this.tags=b.tags;this.operator=b.operator;this.toString=function(){return String.format("{0}('{1}')",this.operator,this.tags.join(","))}};v.prototype=new h;v.prototype.constructor=v;var q=function(b,c){if(!c||!c.length||2>c.length)throw Error("Provide valid or atleast 2 filters");this.operator=b;this.innerFilters=[];for(var d=0;d<c.length;d+=
1){if(!(c[d]instanceof h))throw Error("Invalid filter provided");this.innerFilters.push(c[d])}this.toString=function(){var b=this.operator,c="(";this.innerFilters.forEach(function(d){c=1===c.length?c+(" "+d.toString()):c+String.format(" {0} {1} ",b,d.toString())});return c+=")"}};q.prototype=new h;q.prototype.constructor=q;var u={isEqualTo:"==",notEqualTo:"<>",isGreaterThan:">",isGreaterThanEqualTo:">=",isLessThan:"<",isLessThanEqualTo:"<=",like:"like",match:"match",between:"between",withinCircle:"within_circle",
withinPolygon:"within_polygon",or:"or",and:"and",taggedWithAll:"tagged_with_all",taggedWithOneOrMore:"tagged_with_one_or_more",isNull:"is null",containedIn:"in",isNotNull:"is not null",notIn:"not in"},t=function(b,d){if(null===b||void 0===b||0===b.length)throw Error("Specify value");this.value=b;this.type=d?d:typeof this.value;if("number"===this.type&&!g.isNumeric(this.value))throw Error("Value should be numeric for filter expression");this.getValue=function(){return"number"===this.type||g.isBoolean(this.value)||
g.isNumber(this.value)?this.value:"object"===this.type&&g.isDate(this.value)?"datetime('"+c.Date.toISOString(this.value)+"')":"object"==this.type&&this.value instanceof c.GeoCoord?this.value.toString():"'"+this.value.toString()+"'"}},B=function(c,g,q){q||(q=this);q.type=c;q.name=g;q.equalTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isEqualTo})};q.notEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.notEqualTo})};
q.greaterThan=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isGreaterThan})};q.greaterThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isGreaterThanEqualTo})};q.lessThan=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isLessThan})};q.lessThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isLessThanEqualTo})};q.like=function(c){return new b({field:this.name,
fieldType:this.type,value:new t("*"+c+"*"),operator:u.like})};q.match=function(c){return new b({field:this.name,fieldType:this.type,value:new t("*"+c+"*"),operator:u.match})};q.startsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c+"*"),operator:u.like})};q.endsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new t("*"+c),operator:u.like})};q.contains=function(b){return new e({field:this.name,fieldType:this.type,value:b,operator:u.isEqualTo})};
q.containedIn=function(b){return new k({field:this.name,fieldType:this.type,value:b,operator:u.containedIn})};q.isNull=function(){return new d({field:this.name,fieldType:this.type,operator:u.isNull})};q.notIn=function(b){return new k({field:this.name,fieldType:this.type,value:b,operator:u.notIn})};q.isNotNull=function(){return new d({field:this.name,fieldType:this.type,operator:u.isNotNull})};q.between=function(b,c){return new r({field:this.name,fieldType:this.type,val1:new t(b),val2:new t(c),operator:u.between})};
q.withinCircle=function(b,c,d){return new f({field:this.name,fieldType:this.type,geoCoord:b,distance:c,unit:d,operator:u.withinCircle})};q.withinPolygon=function(b){return new l({field:this.name,fieldType:this.type,geoCoords:b,operator:u.withinPolygon})}},p=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;B("property",b,this);return this},O=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new B("aggregate",b);this.equalTo=function(b){return c.equalTo(b)};
this.notEqualTo=function(b){return c.notEqualTo(b)};this.greaterThan=function(b){return c.greaterThan(b)};this.greaterThanEqualTo=function(b){return c.greaterThanEqualTo(b)};this.lessThan=function(b){return c.lessThan(b)};this.lessThanEqualTo=function(b){return c.lessThanEqualTo(b)};this.between=function(b,d){return c.between(b,d)};this.contains=function(b){return c.contains(b)};return this},P=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new B("attribute",b);
this.like=function(b){return c.like(b)};this.match=function(b){return c.match(b)};this.startsWith=function(b){return c.startsWith(b)};this.endsWith=function(b){return c.endsWith(b)};this.equalTo=function(b){return c.equalTo(b)};this.notEqualTo=function(b){return c.notEqualTo(b)};this.contains=function(b){return c.contains(b)};this.containedIn=function(b){return c.containedIn(b)};this.notIn=function(b){return c.notIn(b)};this.isNull=function(){return c.isNull()};this.isNotNull=function(){return c.isNull()};
return this};c.Filter={Property:function(b){return new p(b)},Aggregate:function(b){return new O(b)},Attribute:function(b){return new P(b)},Or:function(){return new q(u.or,arguments)},And:function(){return new q(u.and,arguments)},taggedWithOneOrMore:function(b){return new v({tags:b,operator:u.taggedWithOneOrMore})},taggedWithAll:function(b){return new v({tags:b,operator:u.taggedWithAll})}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend;c.Queries={};var b=function(b){b=b||{};this._pageNumber=1;this._pageSize=null;this.isPageDefault=!0;this.pageNumber(b.pageNumber);this.pageSize(b.pageSize)};b.prototype.pageNumber=function(){return 1!=arguments.length||g.isNullOrUndefined(arguments[0])?this._pageNumber:(this._pageNumber=arguments[0]||1,this.isPageDefault=!1,this)};b.prototype.pageSize=function(){return 1!=arguments.length||g.isNullOrUndefined(arguments[0])?this._pageSize:
(this._pageSize=arguments[0],this.isPageDefault=!1,this)};b.prototype.resetPaging=function(){this._pageSize=null;this._pageNumber=1;this.isPageDefault=!0;return this};b.prototype.pageString=function(){return"pnum="+this._pageNumber+(this._pageSize?"&psize="+this._pageSize:"")};var e=function(b){b=b||{};this._isAscending=!1;this._order=[];this.isSortSet=!1;g.isNullOrUndefined(b.isAscending)||this.isAscending(b.isAscending);this.orderBy(b.orderBy);b.ascending&&this.ascending(b.ascending);b.descending&&
this.descending(b.descending)};e.prototype.orderBy=function(){return 1===arguments.length&&g.isString(arguments[0])?(this._order=[{orderBy:arguments[0],isAscending:this._isAscending}],this.isSortSet=!0,this):this._order[0]?this._order[0].orderBy:null};e.prototype.isAscending=function(){if(1===arguments.length){var b=void 0===arguments[0]||null==arguments[0]?!1:arguments[0];this._order.forEach(function(c){c.isAscending=b});this._isAscending=b;this.isSortSet=!0;return this}return 0<this._order.length?
order[0].isAscending:this._isAscending};e.prototype.resetSorting=function(){this._order=[];this.isSortSet=this._isAscending=!1;return this};e.prototype._setSorting=function(b,c){if(arguments.length){var f=this;b.forEach(function(b){Array.isArray(b)&&(b=b.join());b.replace(/\s/g,"").split(",").forEach(function(b){var d=f._order.findWhere({orderBy:b.toLowerCase()});d?d.isAscending=c:f._order.push({orderBy:b.toLowerCase(),isAscending:c})})});this.isSortSet=!0}return this};e.prototype.ascending=function(){return this._setSorting(Array.prototype.slice.call(arguments),
!0)};e.prototype.descending=function(){return this._setSorting(Array.prototype.slice.call(arguments),!1)};e.prototype.sortString=function(){return this._order&&0<this._order.length?"orderBy="+this._order.map(function(b){return b.orderBy+" "+(b.isAscending?"asc":"desc")}).join(","):""};m=function(){};m.prototype._setPaging=function(b){b&&(this.pageNumber(b.pagenumber),this.pageSize(b.pagesize),this.results=this.results||[],this.results.isLastPage=!1,this.results.total=b.totalrecords,this.results.pageNumber=
b.pagenumber,this.results.pageSize=b.pagesize,b.pagenumber*b.pagesize>=b.totalrecords&&(this.results.isLastPage=!0))};m.prototype.fields=function(){if(1===arguments.length){var b=arguments[0];g.isString(b)?this._fields=[b]:g.isArray(b)&&b.length&&(this._fields=b);return this}return this._fields};m.prototype._parse=function(b,e,f){b||(b=[]);var g="object"===this.type()?"Object":"Connection";return c[g]._parseResult(b,f.entity,e)};m.prototype.collection=function(b,e){e=e||{};g.isObject(b)&&(e=b,b=null);
b||(b=this.results?this.results:[]);var f=options.entity;!f&&0<b.length&&b[0]instanceof c.BaseObject&&(f="object"==b[0].type?"Object":"Connection",f=c[f]._getClass(b[0].className));f||(f="object"===_etype?"Object":"Connection",f=c[f]._getClass(this[f]));return new c.Collection(b,h(e,{model:f,query:this}))};m.prototype.fetchNext=function(b){var c=this.pageNumber();if(!c||0>=c)c=1;this.pageNumber(++c);return this.fetch(b)};m.prototype.fetchPrev=function(b){var c=this.pageNumber();--c;if(!c||0>=c)c=
1;this.pageNumber(c);return this.fetch(b)};m.prototype.count=function(b){var e=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){b=b||{};b=b.paginginfo;var c=0,c=b?b.totalrecords:0;e.fulfill(c)};b.promise=e;b.entity=this;return c.http.send(b)};var k=function(d){var h=d||{};b.call(this,d);e.call(this,d);var f="",l="",k=h.queryType||"BasicQuery",q=h.type||h.relation,u=h.relation?"connection":"object",t=this;this._fields=[];h.entity&&(this.entity=h.entity);this.type=function(){return u};
this.entityType=function(){return q};this.queryType=function(){return k};this.filter=function(){return 1===arguments.length?(f=arguments[0],this):f};this.freeText=function(){if(1===arguments.length){var b=arguments[0];g.isString(b)?l=arguments[0]:g.isArray(b)&&b.length&&(l=arguments[0].join(" "));return this}return l};this.filter(h.filter||"");this.freeText(h.freeText||"");this.fields(h.fields||[]);this.setFilter=function(b){this.filter(b)};this.setFreeText=function(b){this.freeText(b)};this.setFields=
function(b){this.fields(b)};this.extendOptions=function(c){for(var d in c)h[d]=c[d];b.call(this,h);e.call(this,h);return this};this.getQueryString=function(){var b=this.pageString(),c=this.sortString();c&&(b+="&"+c);this.filter()&&(c=encodeURIComponent(this.filter().toString()),0<c.trim().length&&(b+="&query="+c));this.freeText()&&0<this.freeText().trim().length&&(b+="&freetext="+encodeURIComponent(this.freeText())+"&language=en");this._fields&&0<this._fields.length&&(b+="&fields="+this._fields.join(","));
return b};this.toUrl=function(){return{url:c.config.apiBaseUrl+u+"/"+q+"/find/all?"+this.getQueryString(),description:"FindAll "+q+" "+u+"s"}};this.toRequest=function(b){var d=new c.HttpRequest,f=this.toUrl();d.url=f.url;d.options=b;d.description=f.description;d.method="get";return d};this.getOptions=function(){var b={},c;for(c in this)this.hasOwnProperty(c)&&!g.isFunction(this[c])&&(b[c]=this[c]);return b};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){t.results=
t._parse(b[u+"s"],b.__meta,h);t._setPaging(b.paginginfo);d.fulfill(t.results,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){t.results=t._parse(b[u+"s"],b.__meta,h);t._setPaging(b.paginginfo);d.fulfill(t.results,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)}};h(k.prototype,m.prototype,e.prototype,b.prototype);c.Queries.FindAllQuery=function(b){b=b||{};if(!b.type&&!b.relation)throw Error("Specify either type or relation for basic filter query");
b.queryType="FindAllQuery";k.call(this,b);return this};c.Queries.FindAllQuery.prototype=new k;c.Queries.FindAllQuery.prototype.constructor=c.Queries.FindAllQuery;c.Query=c.Queries.FindAllQuery;c.Queries.ConnectedObjectsQuery=function(b){b=b||{};if(!b.relation)throw Error("Specify relation for connected objects query");if(!b.objectId)throw Error("Specify objectId for connected objects query");if(!b.type)throw Error("Specify type of object id for connected objects query");var e=b.type;delete b.type;
b.queryType="ConnectedObjectsQuery";k.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.type=e;b.object instanceof c.Object&&(this.object=b.object);this.returnEdge=!0;void 0===b.returnEdge||null===b.returnEdge||b.returnEdge||(this.returnEdge=!1);this.label="";var f=this;g.isString(b.label)&&0<b.label.length&&(this.label="&label="+b.label);this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/"+this.type+"/"+this.objectId+"/find?"+this.getQueryString()+
this.label+"&returnEdge="+this.returnEdge,description:"GetConnectedObjects for relation "+this.relation+" of type "+this.type+" for object "+this.objectId}};var l=function(b,d,e,g){var l=[];b.forEach(function(b){var f=b.__edge;delete b.__edge;var k=c.Object._create(h({__meta:e},b),!0);f&&(f.__endpointa=d,f.__endpointb={objectid:b.__id,label:f.__label,type:b.__type},delete f.label,k.connection=c.Connection._create(h({__meta:g},f),!0));l.push(k)});f.object&&(f.object.children[f.relation]=l);return l};
this.fetch=function(g){var q=c.Promise.buildPromise(g);g=this.toRequest(g);g.onSuccess=function(c){f.results=l(c.nodes?c.nodes:[],{objectid:b.objectId,type:e,label:c.parent},c.__nodemeta,c.__edgemeta);f._setPaging(c.paginginfo);q.fulfill(f.results,c.paginginfo)};g.promise=q;g.entity=this;return c.http.send(g)};return this};c.Queries.ConnectedObjectsQuery.prototype=new k;c.Queries.ConnectedObjectsQuery.prototype.constructor=c.Queries.ConnectedObjectsQuery;c.Queries.GetConnectionsQuery=function(b){b=
b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsQuery query");if(!b.objectId)throw Error("Specify objectId for GetConnectionsQuery query");if(!b.label||0===b.label.trim().length)throw Error("Specify label for GetConnectionsQuery query");b.type&&delete b.type;b.queryType="GetConnectionsQuery";k.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.label=b.label;this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/find/all?"+this.getQueryString()+
"&objectid="+this.objectId+"&label="+this.label,description:"FindAllConnections for relation "+this.relation+" from object id "+this.objectId}};return this};c.Queries.GetConnectionsQuery.prototype=new k;c.Queries.GetConnectionsQuery.prototype.constructor=c.Queries.GetConnectionsQuery;c.Queries.GetConnectionsBetweenObjectsQuery=function(b,e){b=b||{};delete b.entity;if(!b.objectAId||!g.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for GetConnectionsBetweenObjectsQuery query");
if(!b.objectBId||!g.isString(b.objectBId)||0===b.objectBId.length)throw Error("Specify objectBId for GetConnectionsBetweenObjectsQuery query");b.type&&delete b.type;b.queryType=e||"GetConnectionsBetweenObjectsQuery";k.call(this,b);this.objectAId=b.objectAId;this.objectBId=b.objectBId;this.label="GetConnectionsBetweenObjectsForRelationQuery"===this.queryType()&&b.label&&g.isString(b.label)&&0<b.label.length?"&label="+b.label:"";this.relation=b.relation&&g.isString(b.relation)&&0<b.relation.length?
b.relation+"/":"";this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"find/"+this.objectAId+"/"+this.objectBId+"?"+this.getQueryString()+this.label,description:"FindConnectionBetween for relation "+this.relation+" between object ids "+this.objectAId+" and "+this.objectBId}};return this};c.Queries.GetConnectionsBetweenObjectsQuery.prototype=new k;c.Queries.GetConnectionsBetweenObjectsQuery.prototype.constructor=c.Queries.GetConnectionsBetweenObjectsQuery;c.Queries.GetConnectionsBetweenObjectsForRelationQuery=
function(b){b=b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsBetweenObjectsForRelationQuery query");var e=new c.Queries.GetConnectionsBetweenObjectsQuery(b,"GetConnectionsBetweenObjectsForRelationQuery");e.fetch=function(f){var g=c.Promise.buildPromise(f);f=this.toRequest(f);f.onSuccess=function(f){e.results=f.connection?[c.Connection._create(h({__meta:f.__meta},f.connection),!0,b.entity)]:null;g.fulfill(e.results?e.results[0]:null)};f.promise=g;f.entity=this;return c.http.send(f)};
return e};c.Queries.InterconnectsQuery=function(b){b=b||{};delete b.entity;if(!b.objectAId||!g.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for InterconnectsQuery query");if(!(b.objectBIds&&g.isArray(b.objectBIds)&&0<b.objectBIds.length))throw Error("Specify list of objectBIds for InterconnectsQuery query");b.type&&delete b.type;b.queryType="InterconnectsQuery";k.call(this,b);this.objectAId=b.objectAId;this.objectBIds=b.objectBIds;this.toRequest=function(b){var f=
new c.HttpRequest,d=this.toUrl();f.url=d.url;f.options=b;f.description=d.description;f.method="post";f.data={object1id:this.objectAId,object2ids:this.objectBIds};return f};this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/interconnects?"+this.getQueryString(),description:"GetInterConnections between objects"}};return this};c.Queries.InterconnectsQuery.prototype=new k;c.Queries.InterconnectsQuery.prototype.constructor=c.Queries.InterconnectsQuery;c.Queries.GraphQuery=function(d,h,f){g.isObject(d)&&
(f=d,f.returnObjects=d.returnObjects||f.returnObjects,h=f.placeholders||{},d=f.name);if(!d||0===d.length)throw Error("Specify name of filter query");f=f||{};this.placeholders=h||{};this.returnObjects=f.returnObjects;b.call(this,f);e.call(this,f);this.name=d;this.queryType="GraphQuery";this.fields(f.fields||[]);var l=this;this.type=function(){return"object"};this.toRequest=function(b){var f=new c.HttpRequest,d=this.toUrl();f.url=d.url;f.options=b;f.description=d.description;f.method="post";this.data=
{};if(this.placeholders){this.data.placeholders=this.placeholders;for(var e in this.data.placeholders)this.data.placeholders[e]=this.data.placeholders[e]}f.data=this.data;return f};this.getQueryString=function(){var b=[];this.isPageDefault||b.push(this.pageString());this.isSortSet&&b.push(this.sortString());this._fields&&0<this._fields.length&&b.push("fields="+this._fields.join(","));return b.join("&")};this.toUrl=function(){return{url:c.config.apiBaseUrl+"search/"+this.name+"/"+(this.returnObjects?
"graphquery":"filter")+"?"+this.getQueryString(),description:"Filter Query with name "+this.name}};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){var c;l.returnObjects?(l.results=l._parse(b.objects,b.__meta,f),c=l.results):this.results=c=b.ids?b.ids:[];b.paginginfo&&l._setPaging(b.paginginfo);d.fulfill(c,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)}};h(c.Queries.GraphQuery.prototype,m.prototype,e.prototype,b.prototype);c.Queries.GraphAPI=
function(b,e,f){if(!b||0===b.length)throw Error("Specify name of project query");if(!e||!e.length)throw Error("Specify ids to project");this.name=b;this.data={ids:e};this.queryType="GraphApi";var l=this;if(f){this.data.placeholders=f;for(var k in this.data.placeholders)this.data.placeholders[k]=this.data.placeholders[k]}this.toRequest=function(b){var f=new c.HttpRequest,d=this.toUrl();f.url=d.url;f.description=d.description;f.method="post";f.data=this.data;f.options=b;return f};this.toUrl=function(){return{url:c.config.apiBaseUrl+
"search/"+this.name+"/project",description:"Project Query with name "+this.name}};var q=function(b){var f,d;for(d in b)if("status"!==d){f=b[d];break}var e=function(b,f,d,g,l){var q=[];b.forEach(function(b){var t=b.__children;delete b.__children;var k=b.__edge;delete b.__edge;b=c.Object._create(h({__meta:g},b),!0);b.children={};for(var u in t)b.children[u]=[],b.children[u]=e(t[u].values,t[u].parent,b.id,t[u].__nodemeta,t[u].__edgemeta);k&&(k.__endpointa={objectid:d,label:f},k.__endpointb={objectid:b.id,
label:k.__label},delete k.__label,b.connection=c.Connection._create(h({__meta:l},k),!0));q.push(b)});return q};return e(f.values,null,null,f.__nodemeta)};this.collection=function(b,f){f=f||{};g.isObject(b)&&(f=b,b=null);b||(b=this.results?ths.results:[]);var d;0<b.length&&b[0]instanceof c.BaseObject&&(d=c.Object._getClass(b[0].className));return new c.Collection(b,h(f,{model:d,query:this}))};this.fetch=function(b){var f=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){l.results=
q(b);f.fulfill(l.results)};b.promise=f;b.entity=this;return c.http.send(b)}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend,b=c.utils._deepExtend,e=["__link","__endpointa","__endpointb"],k={__utcdatecreated:"datetime",__utclastupdateddate:"datetime"},d=function(b){return g.isString(b)||g.isNumber(b)||g.isBoolean(b)},r=function(b){return d(b)||g.isDate(b)||b instanceof c.GeoCoord},f=function(b){b=b||{};var c={},f;for(f in b.__meta)b.__meta[f].forEach(function(b){c[b]=f});return c},l={integer:function(b){if(b){var c=parseInt(b);if(!isNaN(c))return c}return b},
decimal:function(b){if(b){var c=parseFloat(b);if(!isNaN(c))return c}return b},"boolean":function(b){return g.isBoolean(b)?b:void 0!==b&&null!==b&&("true"===b.toString().toLowerCase()||!0===b||0<b)?!0:!1},date:function(b){if(g.isDate(b))return b;if(b){var f=c.Date.parseISODate(b);if(f)return f}return b},datetime:function(b){if(g.isDate(b))return b;if(b){var f=c.Date.parseISODate(b);if(f)return f}return b},time:function(b){if(g.isDate(b))return b;if(b){var f=c.Date.parseISOTime(b);if(f)return f}return b},
string:function(b){return b?b.toString():b},geocode:function(b){if(b instanceof c.GeoCoord)return b;if(!g.isString(b)||0==b.trim().length)return!1;b=b.split(",");return 2!==b.length?!1:new c.GeoCoord(b[0],b[1])}};l["long"]=l.integer;l.geography=l.geocode;l.text=l.string;l.bool=l["boolean"];c.cast=l;var v=function(b){return g.isNullOrUndefined(b)?null:d(b)?b+"":g.isDate(b)?c.Date.toISOString(b):g.isObject(b)?b instanceof c.GeoCoord?b.toString():b.getObject?b.getObject():b:b};c._encode=function(b){var c=
{},f;for(f in b){var d=b[f];g.isArray(d)?(c[f]=[],d.forEach(function(b){(b=v(b))&&c[f].push(b)})):c[f]=v(b[f])}return c};c._decode=function(b){var c={},d=h({},k,f(b));delete b.__meta;for(var e in b)g.isArray(b[e])?(c[e]=[],b[e].forEach(function(b){b=d[e]?l[d[e]](b):b;c[e].push(b)})):g.isString(b[e])?c[e]=d[e]?l[d[e]](b[e]):b[e]:c[e]=b[e];return c};m=function(f,d){var t={};d=d||{};f=f||{};f=b({},f);this.meta={};f.__meta=h(this.meta,f.__meta);d&&d.parse&&(f=this.parse(f));var k=c.utils._result(this,
"defaults");g.isObject(this.defaults)&&!d.setSnapShot&&(f=b({},k,f));d&&d.collection&&(this.collection=d.collection);f=c._decode(f);var p=this,v=function(f,d){f.__meta=h(p.meta,f.__meta);p.meta=f.__meta;m(f);var e=c._decode(f),l;for(l in e)l==p.idAttribute&&(p.id=e[l]),A[l]&&delete A[l],w[l]&&delete w[l],z[l]&&delete z[l],r(e[l])?d[l]=e[l]:g.isObject(e[l])?d[l]=b({},d[l],e[l]):g.isArray(e[l])?(d[l]=[],e[l].forEach(function(b){if(r(b)||"__link"==l)d[l].push(b);else throw Error("Multivalued property cannot add object or array as property of object");
})):d[l]=e[l]},m=function(b,f){var d={id:"id",__id:"id",__utclastupdateddate:"lastUpdatedAt",__utcdatecreated:"createdAt",__createdby:"createdBy",__updatedby:"lastUpdatedBy"};"id __id __utclastupdateddate __utcdatecreated __createdby __updatedby".split(" ").forEach(function(e){b[e]&&("__utcdatecreated"!==e&&"__utclastupdateddate"!==e||g.isDate(b[e])?p[d[e]]=b[e]:p[d[e]]=c.Date.parseISODate(b[e]),f&&delete b[e])})};this.base=c.Object.prototype;this.cid=parseInt(1E8*Math.random(),10);this.idAttribute=
"__id";var A={},w={},z={},x={};v(f,x);var n=x;d.setSnapShot&&v(n,t);!t[this.idAttribute]&&x[this.idAttribute]&&(t[this.idAttribute]=x[this.idAttribute]);this.id=t[this.idAttribute];x.__type?(x.__type=x.__type.toLowerCase(),this.entityType="type",this.type="object",this.className=x.__type):x.__relationtype&&(x.__relationtype=x.__relationtype.toLowerCase(),this.entityType="relation",this.type="connection",this.className=x.__relationtype);n.__attributes||(n.__attributes={});t.__attributes||(t.__attributes=
{});var y=[];n.__tags||(n.__tags=[]);t.__tags||(t.__tags=[]);this.attributes=n;var D="";m(this.attributes);var G="__id __revision __endpointa __endpointb __createdby __lastmodifiedby __type __relationtype __typeid __relationid __utcdatecreated __utclastupdateddate __tags __authType __link __acls __meta".split(" "),H=function(b){b=b||{};b.message=b.message||"Server error";b.code=b.code||"500";return b};this.getObject=function(){var f=c._encode(b({__meta:this.meta},n));"connection"==p.type&&(f.__endpointa=
n.__endpointa.toJSON(),f.__endpointb=n.__endpointb.toJSON());Object.prototype.hasOwnProperty("id")&&(f.__id=this.id);return f};var Q=function(){var c=b({__meta:this.meta},n);"connection"==p.type&&(n.__endpointa=n.__endpointa.toJSON(),n.__endpointb=n.__endpointb.toJSON());this.hasOwnProperty("id")&&this.id&&(c.__id=this.id);return c};this.toJSON=function(b){if(b&&"object"==this.type){var c=function(b){var f=[];b.forEach(function(b){var d=b.toJSON();if(b.children&&!Object.isEmpty(b.children)){d.children=
{};for(var e in b.children)g.isArray(b.children[e])?d[e]=c(b.children[e]):d[e]=c([b.children[e]])[0],d.children[e]=d[e]}b.connection&&(d.__connection=b.connection.toJSON());f.push(d)});return f};return c([this])[0]}return Q.apply(this)};this.properties=function(){var c=b({},this.attributes);delete c.__attributes;delete c.__tags;return c};this.attr=function(){if(0===arguments.length)return n.__attributes||(n.__attributes={}),n.__attributes;if(1===arguments.length)return n.__attributes||(n.__attributes=
{}),n.__attributes[arguments[0]];if(2===arguments.length){if(!g.isString(arguments[1])&&null!==arguments[1])throw Error("only string values can be stored in attributes.");n.__attributes||(n.__attributes={});n.__attributes[arguments[0]]=arguments[1]}else throw Error(".attr() called with an incorrect number of arguments. 0, 1, 2 are supported.");C("__attributes");return n.__attributes};var I=function(){if(n.__attributes){if(!t.__attributes)return n.__attributes;var b=!1,c=JSON.parse(JSON.stringify(t.__attributes)),
f;for(f in n.__attributes)null==n.__attributes[f]||void 0==n.__attributes[f]?(c[f]=null,b=!0):n.__attributes[f]!=t.__attributes[f]?(c[f]=n.__attributes[f],b=!0):n.__attributes[f]==t.__attributes[f]&&delete c[f];return b?c:void 0}};this.getChangedAttributes=I;this.aggregate=function(){var b={},c;for(c in n){if(!n.hasOwnProperty(c))return;"$"==c[0]&&(b[c.substring(1)]=n[c])}if(0===arguments.length)return b;if(1==arguments.length)return b[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");
};this.tags=function(){return n.__tags?n.__tags:[]};this.addTag=function(b){if(!b||!g.isString(b)||!b.length)return this;n.__tags||(n.__tags=[]);n.__tags.push(b);n.__tags=Array.distinct(n.__tags);if(!y||!y.length)return C("__tags"),this;b=y.indexOf(b);-1!=b&&y.splice(b,1);C("__tags");return this};this.removeTag=function(b){if(!b||!g.isString(b)||!b.length)return this;y.push(b);y=Array.distinct(y);if(!n.__tags||!n.__tags.length)return C("__tags"),this;b=n.__tags.indexOf(b);-1!=b&&n.__tags.splice(b,
1);C("__tags");return this};var J=function(){if(n.__tags){if(!t.__tags)return n.__tags;var b=[];n.__tags.forEach(function(c){-1==t.__tags.indexOf(c)&&b.push(c)});return 0<b.length?b:void 0}};this.getChangedTags=J;this.getRemovedTags=function(){return _removetags};var K=function(b,c,f,d){if(!b||!g.isString(b)||0===b.length||0==b.trim().indexOf("__")||0===b.trim().indexOf("$")||void 0==c||null==c)return this;b=b.toLowerCase();try{var e=function(c){if(!r(c))throw Error("Multivalued property cannot have values of property as an object");
if(n[b]&&g.isArray(n[b]))if("additems"==f)n[b].push(c);else if("adduniqueitems"==f){var d=-1;n[b].find(function(b,f){return g.isEqual(b,c)?(d=f,!0):!1});-1==d&&n[b].push(c)}else"removeitems"==f&&n[b].removeAll(c);else n[b]="removeitems"==f?[]:[c];w[b]||(w[b]={additems:[],adduniqueitems:[],removeitems:[]});w[b][f].push(c)};g.isArray(c)?c.forEach(function(b){e(b)}):e(c);C(b,d)}catch(l){throw Error("Unable to add item to "+b);}return p};this.add=function(b,c,f){return K.apply(this,[b,c,"additems",f])};
this.addUnique=function(b,c,f){return K.apply(this,[b,c,"adduniqueitems",f])};this.remove=function(b,c,f){return K.apply(this,[b,c,"removeitems",f])};var E=function(b,c,f,d){var e=void 0;g.isEqual(f,c)||("__tags"==b?(b=J())&&0<b.length&&(e=b):"__attributes"==b?(b=I(),Object.isEmpty(b)||(e=b)):g.isArray(f)?w[b]&&!z[b]?e=d?w[b]:f:f.equals(c)||(e=f):e=A[b]&&!z[b]?d?{incrementby:A[b].value}:f:f);return e},F=function(f){var d=!1,e=b({},t),g;for(g in e)"$"==g[0]&&delete e[g];for(var l in n)g=E(l,e[l],n[l],
f),void 0===g?delete e[l]:(d=!0,e[l]=g);try{G.forEach(function(b){e[b]&&delete e[b]})}catch(h){}f&&(e=c._encode(e));l=J();f?(l&&0<l.length&&(e.__addtags=l,d=!0),y&&0<y.length&&(e.__removetags=y,d=!0)):l&&0<l.length&&(e.__tags=l,d=!0);(f=I())&&!Object.isEmpty(f)?(e.__attributes=f,d=!0):delete e.__attributes;"object"==p.type&&p._aclFactory&&(f=p._aclFactory.getChanged())&&(d=!0,e.__acls=f);return d&&!Object.isEmpty(e)?e:!1};this.changed=function(){return this.isNew()?this.toJSON():F()};this.hasChanged=
function(){return this.isNew()?!0:0===arguments.length?Object.isEmpty(F(!0))?!1:!0:1==arguments.length&&g.isString(arguments[0])&&0<arguments[0].length?void 0==E(arguments[0],t[arguments[0]],n[arguments[0]])?!1:!0:!1};this.changedAttributes=function(){if(this.isNew())return this.toJSON();if(0===arguments.length)return F();if(1==arguments.length&&g.isArray(arguments[0])&&arguments[0].length){var b={};arguments[0].forEach(function(c){c=E(c,t[c],n[c]);void 0!=c&&b.push(c)});return b}return!1};this.previous=
function(){return this.isNew()?null:1==arguments.length&&g.isString(arguments[0])&&arguments[0].length?t[arguments[0]]:null};this.previousAttributes=function(){return this.isNew()?null:h({},t)};this.fields=function(){if(1==arguments.length){var b=arguments[0];g.isString(b)?D=b:g.isArray(b)&&(D=b.join(","));return this}return D};this.get=function(b,c){if(b){if(c&&l[c.toLowerCase()]){if(l[c.toLowerCase()])return l[c.toLowerCase()](n[b]);throw Error('Invalid cast-type "'+c+'"" provided for get "'+b+
'"');}return n[b]}};this.tryGet=function(b,c,f){b=this.get(b,f);return void 0!==b?b:c};var C=function(b,c){if(c&&!c.silent){var f=E(b,t[b],n[b]);if(void 0!=f[b]||-1!=G.indexOf(b))p.trigger("change:"+b,p,f[b]||n[b],{}),c.ignoreChange||p.trigger("change",p,c)}},L=function(b){b&&!b.silent&&p.trigger("destroy",p,p.collection,b)};this._triggerError=function(b,c){b.silent||p.trigger("error",p,c,b)};var R=function(b,c,f){if(!b||!g.isString(b)||0===b.length||0===b.trim().indexOf("$"))return this;b=b.toLowerCase();
try{if(g.isNullOrUndefined(c))n[b]=null;else if(r(c))n[b]=c;else if(g.isObject(c))if(-1!==e.indexOf(b))n[b]=c;else throw Error("Property cannot have value as an object");else g.isArray(c)&&(n[b]=[],c.forEach(function(c){if(r(c))n[b].push(c);else throw Error("Multivalued property cannot have values of property as an object");}));delete A[b];delete w[b];delete z[b];g.isEqual(n[b],t[b])||(z[b]=!0);b==p.idAttribute&&(p.id=c);return this}catch(d){throw Error("Unable to set "+b);}};this.set=function(b,
c,f){var d,e;if(null==b)return this;null==b||"object"===typeof b?(e=b,f=c):(e={})[b]=c;f||(f={});if(!this._validate(e,f))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);m(e);var g=!1;for(d in e)c=e[d],R.apply(this,[d,c,h({},f,{ignoreChange:!0})]);if(f&&!f.silent)for(d in e)if(void 0!=E(d,t[d],n[d])||-1!=G.indexOf(d))g=!0,p.trigger("change:"+b,p,n[b],{});g&&this.trigger("change",this,f);return this};this.unset=function(b,c){if(!b||!g.isString(b)||0===b.length||0===b.indexOf("__"))return this;
b=b.toLowerCase();delete n[b];C(b,c);return this};this._validate=function(b,c){if(!c.validate||!this.validate||!g.isFunction(this.validate))return!0;b=h({},this.attributes,b);var f=this.validationError=this.validate(b,c)||null;if(!f)return!0;this.trigger("invalid",this,f,h(c,{validationError:f}));return!1};this.isValid=function(b){return this._validate({},h(b||{},{validate:!0}))};this.has=function(b){return b&&g.isString(b)&&0!==b.length?n[b]&&!g.isUndefined(n[b])?!0:!1:!1};this.isNew=function(){return!(!g.isNullOrUndefined(this.id)||
this.has(this.idAttribute))};this.clone=function(){return"object"==this.type?c.Object._create(b({__meta:this.meta},this.getObject())):new c.connection._create(b({__meta:this.meta},this.getObject()))};this.copy=function(b,c){b&&(v(b,n),c&&v(b,t));return this};this.mergeWithPrevious=function(){v(n,t);p._aclFactory&&p._aclFactory.merge();m(t);y=[];A={};w={};z={};return this};var M=function(){v(t,n);p._aclFactory&&p._aclFactory.merge();m(n);y=[];A={};w={};z={}};this.rollback=function(){n=x={};M();return this};
var N=function(b,c,f,d){if(!b||!g.isString(b)||0===b.length||0===b.indexOf("__"))return this;b=b.toLowerCase();if(g.isObject(n[b])||g.isArray(n[b]))throw Error("Cannot increment/decrement array/object");try{g.isObject(c)?(d=c,c=f):c=!c||isNaN(Number(c))?f:Number(c)*f,n[b]=isNaN(Number(n[b]))?c:Number(n[b])+c,p.isNew()||(A[b]={value:(A[b]?A[b].value:0)+c})}catch(e){throw Error("Cannot perform increment/decrement operation");}C(b,d);return p};this.increment=function(b,c,f){return N(b,c,1,f)};this.decrement=
function(b,c,f){return N(b,c,-1,f)};this._findUnsavedChanges=function(){var b={object:null,isNested:!1};if(this.id)b.object=F(!0);else{var c=p.getObject();delete c.__meta;for(var f in c)"$"==f[0]&&delete c[f];c.__revision&&delete c.__revision;"object"==p.type&&p._aclFactory&&(f=p._aclFactory.getChanged())&&(c.__acls=f);c.__tags&&0==c.__tags.length&&delete c.__tags;Object.isEmpty(c.__attributes)&&delete c.__attributes;"connection"==p.type&&(c.__endpointa.objectid&&delete c.__endpointa.object,c.__endpointb.objectid&&
delete c.__endpointb.object);b.object=c}return b};this.getType=function(){var b=p.type;!n.__type||"user"!=n.__type.toLowerCase()&&"device"!=n.__type.toLowerCase()||(b=n.__type.toLowerCase());return b};this._parseOutput=function(b,f){var d=p.getType(),e;b=b||{};if(f&&f[d]){b&&b.parse&&(f[d]=this.parse(f[d]));var g=this.isNew(),l=!1;"connection"==p.type&&n.__endpointa&&f[d].__endpointa.label!=n.__endpointa.label&&(l=f[d].__endpointa,f[d].__endpointa=f[d].__endpointb,f[d].__endpointb=l,l=!0);t=c._decode(h({__meta:h(p.meta,
f.__meta)},f[d]));p.id=n[p.idAttribute]=f[d][p.idAttribute];M();g?("connection"==p.type&&(b._batch||(l?(n.__endpointa.object&&f.__bmeta&&(n.__endpointa.object.__meta=f.__bmeta),n.__endpointb.object&&f.__ameta&&(n.__endpointb.object.__meta=f.__ameta)):(n.__endpointa.object&&f.__ameta&&(n.__endpointa.object.__meta=f.__ameta),n.__endpointb.object&&f.__bmeta&&(n.__endpointb.object.__meta=f.__bmeta))),p.parseConnection(b._batch)),p.trigger("change:__id",p,p.id,{}),c.eventManager.fire(p.entityType+"."+
d+".created",p,{object:p}),p.created=!0):c.eventManager.fire(p.entityType+"."+d+"."+p.id+".updated",p,{object:p});b.silent||p.trigger("sync",p,f[d],b)}else f=f||{},f.status=f.status||{},e=H(f.status),p._triggerError(b,new c.Error(e)),p.isNew()?c.eventManager.fire(p.entityType+"."+d+".createFailed",p,{error:e}):c.eventManager.fire(p.entityType+"."+d+"."+p.id+".updateFailed",p,{object:e});return e};this._save=function(){return this.id?S.apply(this,arguments):T.apply(this,arguments)};var T=function(b){b=
b||{};var f=p.getType(),d=p._findUnsavedChanges(),e=new c._Request({method:"PUT",type:f,op:"getCreateUrl",args:[this.className,D],data:d.object,options:b,entity:p,onSuccess:function(c){(c=p._parseOutput(b,c))?e.promise.reject(c,p):e.promise.fulfill(p)}});return e.send()},S=function(b,f){c.Promise.is(f)||(f=c.Promise.buildPromise(b));var d=p._findUnsavedChanges();b=b||{};if(Object.isEmpty(d.object))f.fulfill(p);else{var e=p.type,g=[p.className,p.id,D];n&&n.__type&&("user"==n.__type.toLowerCase()||
"device"==n.__type.toLowerCase())&&(e=n.__type.toLowerCase(),g.splice(0,1));var l=new c._Request({method:"POST",type:e,op:"getUpdateUrl",args:g,data:d.object,options:b,entity:p,onSuccess:function(c){(c=p._parseOutput(b,c))?l.promise.reject(c,p):l.promise.fulfill(p)}});return l.send()}return f},U=function(b){if(!p.id)throw Error("Please specify id for get operation");b=b||{};var f=p.getType(),d=new c._Request({method:"GET",type:f,op:"getGetUrl",args:[this.className,p.id,D],options:b,entity:p,onSuccess:function(e){e&&
e[f]?(b&&b.parse&&(e[f]=p.parse(e[f])),t=c._decode(h({__meta:h(p.meta,e.__meta)},e[f])),v(t,n),m(n),p._aclFactory&&p._aclFactory._rollback(),e.connection&&(p.endpoints||p.endpointA&&p.endpointB||p.setupConnection(n.__endpointa,n.__endpointb)),b.silent||p.trigger("sync",p,e[f],b),c.eventManager.fire(p.entityType+"."+f+"."+p.id+".fetched",p,{object:p}),d.promise.fulfill(p)):(e=e||{},e.status=e.status||{},e.status=H(e.status),p._triggerError(b,new c.Error(e.status)),d.promise.reject(e.status,p))}});
return d.send()};this._fetch=function(b){return U.apply(this,[b])};this.del=this._destroy=function(b){b=b||{};var f=b.deleteConnections;g.isBoolean(b)&&(f=b,b={});b.wait||L(b);if(!p.id)return(new c.Promise.buildPromise(b)).fulfill();var d=p.getType(),e=new c._Request({method:"DELETE",type:d,op:"getDeleteUrl",args:[this.className,p.id,f],options:b,entity:this,onSuccess:function(f){f&&f.status?(n={},t={},b.wait&&L(b),e.promise.fulfill(f.status)):(f=f||{},f.status=f.status||{},f.status=H(f.status),p._triggerError(b,
new c.Error(f.status)),e.promise.reject(f.status,p))}});return e.send()};"object"==this.type&&(this._destroyWithConnections=function(b){return this.destroy(h({deleteConnections:!0},b))})};m.prototype.save=function(){return this._save.apply(this,arguments)};m.prototype.fetch=function(){return this._fetch.apply(this,arguments)};m.prototype.destroy=function(){return this._destroy.apply(this,arguments)};m.prototype.destroyWithConnections=function(){return this._destroyWithConnections.apply(this,arguments)};
c.BaseObject=m;c.BaseObject._saveAll=function(b,f,d){var e=new c.Batch;f=f||{};if(!g.isArray(b))throw Error("Provide an array of objects for Object.saveAll");b.forEach(function(b){b instanceof c.BaseObject||!g.isObject(b)||(b=new c[this.className||d](b));e.add(b)});return e.execute(f)};c.BaseObject.prototype.toString=function(){return JSON.stringify(this.getObject())};c.BaseObject.prototype.parse=function(b,c){return b};c.BaseObject.prototype.escape=function(b){return _.escape(this.get(b))};c.Events.mixin(c.BaseObject.prototype)})(global);
(function(m){var c=function(){return Math.floor(65536*Math.random()).toString(16)};m.Appacitive.GUID=function(){var g=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c(),h="",b,e,k,d,r,f,l=0,g=g.replace(/\r\n/g,"\n");e="";for(k=0;k<g.length;k++)d=g.charCodeAt(k),128>d?e+=String.fromCharCode(d):(127<d&&2048>d?e+=String.fromCharCode(d>>6|192):(e+=String.fromCharCode(d>>12|224),e+=String.fromCharCode(d>>6&63|128)),e+=String.fromCharCode(d&63|128));for(g=e;l<g.length;)b=g.charCodeAt(l++),e=g.charCodeAt(l++),
k=g.charCodeAt(l++),d=b>>2,b=(b&3)<<4|e>>4,r=(e&15)<<2|k>>6,f=k&63,isNaN(e)?r=f=64:isNaN(k)&&(f=64),h=h+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);return h.toString()}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=["allow","deny"],b=["create","read","update","delete","manageaccess"],e=function(c){var d=[];c.forEach(function(c){g.isString(c)&&-1!=b.indexOf(c.toLowerCase())&&d.push(c.toLowerCase())});return d};c._Acl=function(k,d){var r=k||[];g.isArray(r)||(r=[]);var f={};d&&(f=JSON.parse(JSON.stringify(r)));this.acls=r=JSON.parse(JSON.stringify(r));var l=[],v=function(b,f,d,g){if(!d)throw Error("Specify valid user or usergroup");d instanceof c.Object&&"user"==
d.typeName&&!d.isNew()&&(d=d.id);var k=r.filter(function(b){return b.sid==d&&b.type==f});k&&0!=k.length?k=k[0]:(k={sid:d,type:f,deny:[],allow:[]},r.push(k));k.allow||(k.allow=[]);k.deny||(k.deny=[]);g=e(g);var q=l.filter(function(b){return b.sid==d&&b.type==f});q&&0!=q.length?q=q[0]:(q={sid:d,type:f},l.push(q));g.forEach(function(c){for(var f=0;f<h.length;f+=1){var d=k[h[f]].indexOf(c);if(-1!=d){k[h[f]].splice(d,1);break}}"dontcare"!=b&&k[b].push(c);q[c]=b});return this},q=function(b,c,f,d){if(!f)throw Error("Please provide valid id or name for setting acls");
if(!d)throw Error("Please provide valid access permissions for setting acls");g.isArray(d)||(d=[d]);g.isArray(f)?f.forEach(function(f){v(b,c,f,d)}):v(b,c,f,d);return this},m=function(){r.allowUser=function(b,c){return q.apply(this,["allow","user",b,c])};r.allowGroup=function(b,c){return q.apply(this,["allow","usergroup",b,c])};r.denyUser=function(b,c){return q.apply(this,["deny","user",b,c])};r.denyGroup=function(b,c){return q.apply(this,["deny","usergroup",b,c])};r.resetUser=function(b,c){return q.apply(this,
["dontcare","user",b,c])};r.resetGroup=function(b,c){return q.apply(this,["dontcare","usergroup",b,c])};r.allowAnonymous=function(b){return q.apply(this,["allow","usergroup",["anonymous"],b])};r.denyAnonymous=function(b){return q.apply(this,["deny","usergroup",["anonymous"],b])};r.resetAnonymous=function(b){return q.apply(this,["dontcare","usergroup",["anonymous"],b])};r.allowLoggedIn=function(b){return q.apply(this,["allow","usergroup",["anonymous"],b])};r.denyLoggedIn=function(b){return q.apply(this,
["deny","usergroup",["anonymous"],b])};r.resetLoggedIn=function(b){return q.apply(this,["dontcare","usergroup",["anonymous"],b])}};this._rollback=function(){l=[];r=JSON.parse(JSON.stringify(f));m();return this};this.toJSON=this.getChanged=function(){var c=[];l.forEach(function(f){var d={sid:f.sid,type:f.type,allow:[],deny:[],dontcare:[]};b.forEach(function(b){f[b]&&d[f[b]].push(b)});h.forEach(function(b){0==d[b].length&&delete d[b]});0==d.dontcare.length&&delete d.dontcare;c.push(d)});return 0==c.length?
null:c};this.merge=function(){l=[];return this};m();return this};c.Group=new function(){var b=function(b,e,f,l){if(!e||!g.isString(e)||0===e.length)throw Error("Please specify valid groupname");g.isArray(f)||(f=[f]);var h={};h[b]=[];f.forEach(function(f){f&&(f instanceof c.Object&&"user"==f.typeName&&!f.isNew()?h[b].push(f.id):g.isString(f)&&h[b].push(f))});if(0==h[b].length)throw Error("Please specify valid members as second argument");var k=new c._Request({method:"POST",type:"usergroup",op:"getUpdateUrl",
args:[e],data:h,entity:this,options:l,onSuccess:function(b){k.promise.fulfill(b)}});return k.send()};this.addMembers=function(c,e,f){return b("add",c,e)};this.removeMembers=function(c,e,f){return b("remove",c,e)}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend;c.Object=function(b,e){b=b||{};e=e||{};this.className&&(b.__type=this.className);g.isString(b)&&(b={__type:b});if(!b.__type)throw Error("Cannot set object without __type");g.isBoolean(e)&&(e={setSnapShot:!0});c.BaseObject.call(this,b,e);this.type="object";this.getObject=this.getObject;this.children={};this.typeName=b.__type;this._aclFactory=new c._Acl(e.__acls,e.setSnapShot);this.acls=this._aclFactory.acls;g.isFunction(this.initialize)&&
this.initialize.apply(this,[b]);return this};c.Object.prototype=new c.BaseObject;c.Object.prototype.constructor=c.Object;c.Object.extend=function(d,e,f){g.isObject(d)&&(f=e,e=d,d=e.typeName);if(!g.isString(d)||0==d.length)throw Error("Appacitive.Object.extend's first argument should be the type-name.");var l=null;e=e||{};e.className=d;l=c.utils.classExtend(c.Object,e,f);delete l.extend;l.className=d;l.type=d;return b[d]=l};var b={},e=function(d){if(!g.isString(d))throw"_getClass requires a string argument.";
var e=b[d];e||(e=c.Object.extend(d),b[d]=e);return e};c.Object._getClass=e;c.Object._create=function(b,c,f){return(new (this.className?this:f?f:e(b.__type))(b)).copy(b,c)};var k=function(b,e,f){var g=[];b.forEach(function(b){b=c.Object._create(h(b,{__meta:f}),!0,e);g.push(b)});return g};c.Object._parseResult=k;c.Object.multiDelete=function(b,e){b=b||{};e=e||{};var f=[];this.className&&(b.type=this.className);g.isArray(b)&&0<b.length&&(b[0]instanceof c.Object?(f=b,b={type:f[0].className,ids:f.map(function(b){return b.id}).filter(function(b){return b})}):
b={type:this.className,ids:b});if(!b.type||!g.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if("user"===b.type.toLowerCase()||"device"===b.type.toLowerCase())throw Error("Cannot delete user and devices using multidelete");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var l=new c._Request({method:"POST",data:{idlist:b.ids},type:"object",op:"getMultiDeleteUrl",args:[b.type],options:e,onSuccess:function(b){e&&!e.silent&&f.forEach(function(b){b.trigger("destroy",
b,b.collection,e)});l.promise.fulfill()}});return l.send()};c.Object.multiGet=function(b,e){b=b||{};e=e||{};g.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Object?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type||!g.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var f=new c._Request({method:"GET",type:"object",op:"getMultiGetUrl",
args:[b.type,b.ids.join(","),b.fields],options:e,onSuccess:function(c){f.promise.fulfill(k(c.objects,b.entity,c.__meta))}});return f.send()};c.Object.get=function(b,e){b=b||{};g.isString(b)&&this.className&&(b={id:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type)throw Error("Specify type");if(!b.id)throw Error("Specify id to fetch");var f=c.Object._create({__type:b.type,__id:b.id});f.fields=b.fields;return f.fetch(e)};c.Object.prototype.getConnections=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");
b.objectId=this.get("__id");return new c.Queries.GetConnectionsQuery(b)};c.Object.prototype.getConnectedObjects=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");b=b||{};g.isString(b)&&(b={relation:b});b.type=this.get("__type");b.objectId=this.get("__id");b.object=this;return new c.Queries.ConnectedObjectsQuery(b)};c.Object.prototype.fetchConnectedObjects=c.Object.prototype.getConnectedObjects;c.Object.findAll=c.Object.findAllQuery=function(b){b=b||{};this.className&&
(b.type=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Object.saveAll=function(b,e){return c.BaseObject._saveAll(b,e,"Object")}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend,b=function(b,e,d){var k={label:b.label};b.objectid&&(k.objectid=b.objectid);if(b.object)b.object instanceof c.Object?b.object.id&&(b.objectid=k.objectid=b.object.id):g.isObject(b.object)&&(b.object.__id&&(b.objectid=k.objectid=b.object.__id),b.object=c.Object._create(b.object)),k.object=b.object.getObject();else if(!k.objectid&&!k.object)throw Error("Incorrectly configured endpoints provided to parseConnection");k.toJSON=function(){var c=
h({},this);if(c.object&&(c.object=b.object.toJSON(),b.object._aclFactory)){var e=b.object._aclFactory.toJSON();e&&(c.object.__acls=e)}delete c.toJSON;return c};d["endpoint"+e]=b;return k},e=function(b,e,d,k){b.object&&g.isObject(b.object)?(k||(d["endpoint"+e]?d["endpoint"+e]&&d["endpoint"+e].object&&d["endpoint"+e].object instanceof c.Object?d["endpoint"+e].object.copy(b.object,!0):d["endpoint"+e].object=c.Object._create(b.object,!0):(d["endpoint"+e]={},d["endpoint"+e].object=c.Object._create(b.object,
!0)),d["endpoint"+e]._aclFactory&&d["endpoint"+e]._aclFactory.merge(),k=d["endpoint"+e].object,k.trigger("change:__id",k,k.id,{})),d["endpoint"+e].objectid=b.objectid||b.object.__id,d["endpoint"+e].label=b.label,d["endpoint"+e].type=b.type):d["endpoint"+e]=b;b.toJSON=function(){var b=h({},this);if(b.object&&(b.object=d["endpoint"+e].object.toJSON(),d["endpoint"+e].object._aclFactory)){var c=d["endpoint"+e].object._aclFactory.toJSON();c&&(b.object.__acls=c)}delete b.toJSON;return b}};c.Connection=
function(b,d){b=b||{};d=d||{};this.className&&(b.__relationtype=this.className);g.isString(b)&&(b={__relationtype:b});if(!b.__relationtype&&!b.relation)throw Error("Cannot set connection without relation");b.relation&&(b.__relationtype=b.relation,delete b.relation);g.isBoolean(d)&&(d={setSnapShot:!0});b.endpoints&&2===b.endpoints.length&&(b.__endpointa=b.endpoints[0],b.__endpointb=b.endpoints[1],delete b.endpoints);c.BaseObject.call(this,b,d);this.type="connection";this.getConnection=this.getObject;
this.parseConnection=function(c){var d="A",l="B";b.__endpointa.label.toLowerCase()!==this.get("__endpointb").label.toLowerCase()||b.__endpointa.label.toLowerCase()==b.__endpointb.label.toLowerCase()||b.__endpointa.objectid!=this.get("__endpointb").objectid&&b.__endpointa.objectid||(d="B",l="A");e(this.get("__endpointa"),d,this,c);e(this.get("__endpointb"),l,this,c);this.endpoints=function(){if(1===arguments.length&&g.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;
if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b};return this};d.setSnapShot?this.parseConnection(b):b.__endpointa&&b.__endpointb&&this.setupConnection(this.get("__endpointa"),this.get("__endpointb"));this.relationName=b.__relationtype;g.isFunction(this.initialize)&&this.initialize.apply(this,[b]);return this};c.Connection.prototype=new c.BaseObject;c.Connection.prototype.constructor=
c.Connection;c.Connection.extend=function(b,e,d){g.isObject(b)&&(d=e,e=b,b=e.relationName);if(!g.isString(b))throw Error("Appacitive.Connection.extend's first argument should be the relationName.");var h=null;e=e||{};e.className=b;h=c.utils.classExtend(c.Connection,e,d);delete h.extend;h.className=b;h.relation=b;return k[b]=h};var k={},d=function(b){if(!g.isString(b))throw"_getClass requires a string argument.";var e=k[b];e||(e=c.Connection.extend(b),k[b]=e);return e};c.Connection._getClass=d;c.Connection._create=
function(b,c,e){return(new (this.className?this:e?e:d(b.__relationtype))(b)).copy(b,c)};var r=function(b,e,d){var g=[];b||(b=[]);b.forEach(function(b){g.push(c.Connection._create(h(b,{__meta:d}),!0,e))});return g};c.Connection._parseResult=r;c.Connection.prototype.setupConnection=function(c,e){if(!(c&&(c.objectid||c.object)&&c.label&&e&&(e.objectid||e.object)&&e.label))throw Error("Incorrect endpoints configuration passed.");this.set("__endpointa",b(c,"A",this),{silent:!0});this.set("__endpointb",
b(e,"B",this),{silent:!0});this.endpoints=function(){if(1===arguments.length&&g.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b}};c.Connection.prototype.get=c.Connection.get=function(b,e){b=b||{};g.isString(b)&&this.className&&(b={id:b});this.className&&
(b.relation=this.className,b.entity=this);if(!b.relation)throw Error("Specify relation");if(!b.id)throw Error("Specify id to fetch");var d=c.Connection._create({__relationtype:b.relation,__id:b.id});d.fields=b.fields;return d.fetch(e)};c.Connection.multiGet=function(b,e){b=b||{};e=e||{};g.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Connection?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.relation=this.className,b.entity=this);if(!b.relation||!g.isString(b.relation)||
0===b.relation.length)throw Error("Specify valid relation");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var d=new c._Request({method:"GET",type:"connection",op:"getMultiGetUrl",args:[b.relation,b.ids.join(","),b.fields],options:e,onSuccess:function(c){d.promise.fulfill(r(c.connections,b.entity,c.__meta))}});return d.send()};c.Connection.multiDelete=function(b,e){b=b||{};e=e||{};var d=[];this.className&&(b.relation=this.className);g.isArray(b)&&0<b.length&&(b[0]instanceof c.Connection?
(d=b,b={relation:d[0].className,ids:d.map(function(b){return b.id}).filter(function(b){return b})}):b={relation:this.className,ids:b});if(!b.relation||!g.isString(b.relation)||0===b.relation.length)throw Error("Specify valid relation");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var h=new c._Request({method:"POST",data:{idlist:b.ids},type:"connection",op:"getMultiDeleteUrl",args:[b.relation],options:e,onSuccess:function(b){e&&!e.silent&&d.forEach(function(b){b.trigger("destroy",
b,b.collection,e)});h.promise.fulfill()}});return h.send()};c.Connection.findAll=c.Connection.findAllQuery=function(b){b=b||{};this.className&&(b.relation=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Connection.interconnectsQuery=c.Connection.getInterconnects=function(b){return new c.Queries.InterconnectsQuery(b)};c.Connection.betweenObjectsQuery=c.Connection.getBetweenObjects=function(b){return new c.Queries.GetConnectionsBetweenObjectsQuery(b)};c.Connection.betweenObjectsForRelationQuery=
c.Connection.getBetweenObjectsForRelation=function(b){b=b||{};this.className&&(b.relation=this.className,b.entity=this);return new c.Queries.GetConnectionsBetweenObjectsForRelationQuery(b)};c.Connection.saveAll=function(b,e){return c.BaseObject._saveAll(b,e,"Connection")}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend,b=function(b,e){b=b||{};b.__type="user";c.Object.call(this,b,e);return this},e=null;b.currentUser=b.current=function(){return e};var k=function(b,e,d){var h=this.get("__id");if(!h||!g.isString(h)||0===h.length)throw Error("Please specify valid userid");if(!b||!g.isString(b)||0===b.length)throw Error("Please specify valid oldPassword");if(!e||!g.isString(e)||0===e.length)throw Error("Please specify valid newPassword");var k=this,t=new c._Request({method:"POST",
type:"user",op:"getUpdatePasswordUrl",args:[h],options:d,data:{oldpassword:b,newpassword:e},entity:this,onSuccess:function(b){t.promise.fulfill(k)}});return t.send()},d=function(b,e){var d=this.get("__id");if(!this.get("__id"))return this.set("__link",b),c.Promise.buildPromise(e).fulfill(this);var h=this,k=new c._Request({method:"POST",type:"user",op:"getLinkAccountUrl",args:[d],options:e,data:b,entity:this,onSuccess:function(c){c=h.get("__link");g.isArray(c)||(c=c?[c]:[]);c.push(b);h.copy({__link:c},
!0);k.promise.fulfill(h)}});return k.send()};b.setCurrentUser=function(b,d,g){if(!b)throw Error("Cannot set null object as user");var h=b;if(h instanceof c.User)if(h.get("__id")&&0!==h.get("__id").length)b=h.getObject();else throw Error("Specify user __id");else h=new c.User(b,!0);c.LocalStorage.set("Appacitive-User",b);g||(g=864E5);e=h;d&&c.Session.setUserAuthHeader(d,g);e.logout=function(b){return c.Users.logout(b)};e.updatePassword=function(b,c,e){return k.apply(this,[b,c,e])};e.logout=function(b){return c.Users.logout(b)};
c.eventManager.clearAndSubscribe("type.user."+h.get("__id")+".updated",function(b,e){c.LocalStorage.set("Appacitive-User",e.object.getObject())});return e};b.prototype.linkedAccounts=function(){var b=this.get("__link");b?g.isArray(b)||(b=[b]):b=[];return b};b.prototype.getAllLinkedAccounts=function(b){var e=this.get("__id");if(!e||!g.isString(e)||0===e.length)return c.Promise.buildPromise(b).fulfill(this.linkedAccounts(),this);var d=this,h=new c._Request({method:"GET",type:"user",op:"getGetAllLinkedAccountsUrl",
args:[e],options:b,entity:this,onSuccess:function(){var b=a.identities||[];0<b.length?d.set("__link",b):d.set("__link",null);h.promise.fulfill(b,d)}});return h.send()};b.prototype.checkin=function(b,e){var d=this.get("__id");d&&g.isString(d)&&0!==d.length||onSuccess&&g.isFunction(onSuccess)&&onSuccess();if(!(b&&b instanceof c.GeoCoord))throw Error("Invalid coordinates provided");var h=this,k=new c._Request({method:"POST",type:"user",op:"getCheckinUrl",args:[d,b.lat,b.lngerId],options:e,entity:this,
onSuccess:function(){k.promise.fulfill(h)}});return k.send()};b.prototype.linkFacebook=function(b,c){if(!b||!g.isString(b))throw Error("Please provide accessToken");return d.apply(this,[{authtype:"facebook",accesstoken:b,name:"facebook"},c])};b.prototype.linkTwitter=function(b,c){if(!g.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var e={authtype:"twitter",oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret};b.consumerKey&&
b.consumerSecret&&(e.consumersecret=b.consumerSecret,e.consumerkey=b.consumerKey);return d.apply(this,[e,c])};b.prototype.unlink=function(b,e){if(!_.isString(b))throw Error("Specify aouth account type for unlinking");var d=this.get("__id");if(!this.get("__id"))return this.set("__link",null),promise.fulfill(this),promise;var h=this,k=new c._Request({method:"POST",type:"user",op:"getDelinkAccountUrl",args:[d,b],options:e,entity:this,onSuccess:function(c){(c=h.get("__link"))?g.isArray(c)||(c=[c]):c=
[];if(0<=c.length){var e=null;c.forEach(function(c,d){c.name==b.toLowerCase()&&(e=d)});null!=e&&c.splice(e,1);h.copy({__link:c},!0)}else h.copy({__link:[]},!0);k.promise.fulfill(h)}});return k.send()};b.prototype.clone=function(){return new c.User(this.getObject())};c.User=c.Object.extend("user",b.prototype);delete c.User._create;delete c.User._parseResult;delete c.User.multiDelete;b.deleteUser=function(b,e){if(!b)throw Error("Specify userid for user delete");return(new c.Object({__type:"user",__id:b})).destroyWithConnections(e)};
b.deleteCurrentUser=function(b){var d=c.Promise.buildPromise(b);if(null===e)return c.Session.removeUserAuthHeader(),d.fulfill(),d;b=e.get("__id");this.deleteUser(b).then(function(){e=null;c.Session.removeUserAuthHeader();d.fulfill()},function(){d.reject.apply(d,arguments)});return d};b.createNewUser=function(b,e){b=b||{};b.__type="user";if(!b.username||!b.password||!b.firstname||0===b.username.length||0===b.password.length||0===b.firstname.length)throw Error("username, password and firstname are mandatory");
return(new c.User(b)).save(e)};b.createUser=b.createNewUser;b.signup=function(b,e){var d=this,g=c.Promise.buildPromise(e);this.createUser(b).then(function(){d.login(b.username,b.password).then(function(){g.fulfill.apply(g,arguments)},function(b){g.reject.apply(g,arguments)})},function(){g.reject.apply(g,arguments)});return g};b.authenticateUser=function(b,d,k){d=d||{};b.expiry||(b.expiry=864E5);var r=this,u;g.isString(k)&&g.isObject(d.user)&&(b.user=d.user instanceof m.Appacitive.User?d.user.toJSON():
d.user,delete b.user.__meta,u=d.user);var t=new c._Request({method:"POST",type:"user",op:"getAuthenticateUserUrl",options:d,data:b,onSuccess:function(d){d&&d.user?(k&&(d.user.__authType=k),h(d.user,{__meta:d.__meta}),u instanceof m.Appacitive.User&&(d.user=u.copy(d.user,!0)),r.setCurrentUser(d.user,d.token,b.expiry),c.User.trigger("login",e,e,d.token),t.promise.fulfill({user:e,token:d.token})):t.promise.reject(d.status)}});return t.send()};b.login=function(b,c,e){if(!b||!c||0==b.length||0==c.length)throw Error("Please specify username and password");
return this.authenticateUser({username:b,password:c,expiry:864E5},e,"BASIC")};b.loginWithFacebook=function(b,c){if(!b||!g.isString(b))throw Error("Please provide accessToken");c=c||{};var e=!0;0==c.create&&(e=!1);return this.authenticateUser({accesstoken:b,type:"facebook",expiry:864E5,createnew:e},c,"FB")};b.loginWithTwitter=function(b,c){if(!g.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var e=!0;0==c.create&&(e=!1);e={type:"twitter",
oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret,expiry:864E5,createnew:e};b.consumerKey&&b.consumerSecret&&(e.consumersecret=b.consumerSecret,e.consumerkey=b.consumerKey);return this.authenticateUser(e,c,"TWITTER")};b.validateCurrentUser=function(b,e){var d=c.Promise.buildPromise({success:e});e&&g.isBoolean(e)&&(b=e,e=function(){});var h=this,k=function(c){if(c)if(b)d.fulfill(!0);else try{h.getUserByToken(c).then(function(b){h.setCurrentUser(b,c);d.fulfill(!0)},function(){d.fulfill(!1)})}catch(e){d.fulfill(!1)}else d.fulfill(!1)};
c.runtime.isReactNative?c.LocalStorage.get("Appacitive-UserToken").then(function(b){k(b)}):k(c.LocalStorage.get("Appacitive-UserToken"));return d};var r=function(b,e,d){d=d||{};var g=new c._Request({method:"GET",type:"user",op:b,options:d,args:e,onSuccess:function(b){b&&b.user?g.promise.fulfill(new c.User(h(b.user,{__meta:b.__meta}),h(d,{setSnapShot:!0}))):g.promise.reject(b.status)}});return g.send()};b.getUserByToken=function(b,e){if(!b||!g.isString(b)||0===b.length)throw Error("Please specify valid token");
c.Session.setUserAuthHeader(b,0,!0);return r("getUserByTokenUrl",[b],e)};b.getUserByUsername=function(b,c){if(!b||!g.isString(b)||0===b.length)throw Error("Please specify valid username");return r("getUserByUsernameUrl",[b],c)};b.logout=function(b,d){e=null;return c.Session.removeUserAuthHeader(b,d)};b.sendResetPasswordEmail=function(b,e,d){if(!b||!g.isString(b)||0===b.length)throw Error("Please specify valid username");if(!e||!g.isString(e)||0===e.length)throw Error("Plase specify subject for email");
b={username:b,subject:e};d=d||{};g.isString(d.templateName)&&(b.templatename=d.templateName);g.isString(d.resetLink)&&(b.resetlink=d.resetLink);var h=new c._Request({method:"POST",type:"user",op:"getSendResetPasswordEmailUrl",options:d,data:b,onSuccess:function(){h.promise.fulfill()}});return h.send()};b.resetPassword=function(b,e,d){if(!b)throw Error("Please specify token");if(!e||0===e.length)throw Error("Please specify password");var g=new c._Request({method:"POST",type:"user",op:"getResetPasswordUrl",
options:d,data:{newpassword:e},args:[b],onSuccess:function(){g.promise.fulfill()}});return g.send()};b.validateResetPasswordToken=function(b,e){if(!b)throw Error("Please specify token");e=e||{};var d=new c._Request({method:"POST",type:"user",op:"getValidateResetPasswordUrl",options:e,data:{},args:[b],onSuccess:function(b){d.promise.fulfill(new c.User(h(b.user,{__meta:b.__meta}),h(e,{setSnapShot:!0})))}});return d.send()};c.Users=c.User;c.Events.mixin(c.User)})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend;c.Collection=function(b,c){c||(c={});c.model&&(this.model=c.model);if(!this.model)throw Error("Please specify model for collection");void 0!==c.comparator&&(this.comparator=c.comparator);c.query&&this.query(c.query);this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0})};c.Events.mixin(c.Collection.prototype);h(c.Collection.prototype,{models:[],initialize:function(){},_query:null,toJSON:function(b){return this.models.map(function(c){return c.toJSON(b)})},
getObject:function(b){return this.models.map(function(c){return c.getObject(b)})},add:function(b,c){c=c||{};var h,d,m,f,l,v={},q={},u=[],t=c.sort,B;b=g.isArray(b)?b.slice():[b];h=0;for(d=b.length;h<d;h++){b[h]=this._prepareModel(b[h]);m=b[h];if(!m)throw Error("Can't add an invalid model to a collection");f=m.cid;if(v[f]||this._byCid[f])throw Error("Duplicate cid: can't add the same model to a collection twice");(l=m.id)&&((B=q[l])||(B=this._byId[l]))?(B.copy(m.getObject(),c.setSnapShot),B.children=
m.children):(q[l]=m,v[f]=m,u.push(m),this._addReference(m,c))}this.models.splice.apply(this.models,[null!=c.at?c.at:this.models.length,0].concat(u));t&&this.comparator&&this.sort({silent:!0});this.length=this.models.length;if(c.silent)return this;h=0;for(d=u.length;h<d;h++)m=u[h],c.index=h,m.trigger("add",m,this,c);return this},remove:function(b,c){var h,d,m,f;c=c||{};b=g.isArray(b)?b.slice():[b];h=0;for(d=b.length;h<d;h++)if(f=this.getByCid(b[h])||this.get(b[h]))delete this._byId[f.id],delete this._byCid[f.cid],
m=this.models.indexOf(f),this.models.splice(m,1),this.length--,c.silent||(c.index=m,f.trigger("remove",f,this,c)),this._removeReference(f);return this},push:function(b,c){return this.add(b,h({at:this.length},c))},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,c){return this.add(b,h({at:0},c))},shift:function(b){var c=this.at(0);this.remove(c,b);return c},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(b){return b&&
this._byId[b instanceof c.BaseObject?b.id:b]},query:function(b){if(b)return this._query=b,this;this._query||(this._query=new c.Query(this.model));return this._query},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b,c){return Object.isEmpty(b)?c?void 0:[]:this.models[c?"find":"filter"](function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},findWhere:function(b){return this.where(b,!0)},sort:function(b){b=b||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");
1===this.comparator.length?this.models=this.models.sortBy(this.comparator):this.models.sort(this.comparator.bind(this.models));b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return this.models.map(function(c){return c.get(b)})},first:function(){return 0<this.length?this.models[0]:null},last:function(){return 0<this.length?this.models[this.length-1]:null},reset:function(b,c){c||(c={});for(var g=0,d=this.models.length;g<d;g++)this._removeReference(this.models[g],c);this._reset();
this.add(b,h({silent:!0},c));c.silent||this.trigger("reset",this,c);return this},fetch:function(b){b=c.utils._clone(b)||{};var e=this,g=this.query()||new c.Query(this.model),d=c.Promise.buildPromise(b);g.fetch(b).then(function(c){0==b.reset?e.add(c,h({setSnapShot:!0},b)):e.reset(c,b);d.fulfill(e)},function(){d.reject.apply(d,arguments)});return d},fetchNext:function(b){var c=this.query().pageNumber();this.query().pageNumber(++c);return this.fetch(b)},fetchPrev:function(b){var c=this.query().pageNumber();
--c;0>=c&&(c=1);this.query().pageNumber(c);return this.fetch(b)},mutiGet:function(b){b=c.utils._clone(b)||{};var e=this,h=c.Promise.buildPromise(b);b=b||{};g.isArray(b)&&(b[0]instanceof c.Object?(models=b,b={ids:models.map(function(b){return b.id}).filter(function(b){return b})}):b={ids:b});var d=b.ids||[];if(0==d.length)return h.fulfill(e);this.model.multiGet({ids:d,fields:b.fields}).then(function(c){b.add?e.add(c,b):e.reset(c,b);h.fulfill(e)},function(){h.reject.apply(h,arguments)});return h},saveAll:function(b){return this.model.saveAll(this.models,
h({},b))},save:function(b){return this.model.saveAll(this.models,h({},b))},create:function(b,e){var g=this;e=e?c.utils._clone(e):{};if(!(b=this._prepareModel(b,e)))return!1;e.wait||this.add(b,e);var d=e.success;e.success=function(){e.wait&&g.add(b,h({setSnapShot:!0},e));d&&d(b,g)};b.save(e);return b},_reset:function(b){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(b){b instanceof c.BaseObject||(b=new this.model(b));b.collection||(b.collection=this);return b},_addReference:function(b){this._byId[b.cid]=
b;null!=b.id&&(this._byId[b.id]=b);b.collection||(b.collection=this);b.on("all",this._onModelEvent,this)},_removeReference:function(b){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,g,d){if("add"!==b&&"remove"!==b||g===this)"destroy"===b&&this.remove(c,d),c&&"change:__id"===b&&(delete this._byId[c.previous(c.idAttribute)],null!=c.id&&(this._byId[c.id]=c)),this.trigger.apply(this,arguments)}});c.Collection.extend=function(b,e){b&&b.query&&
(b._query=b.query,delete b.query);var g=c.utils.classExtend(this,b,e);g.extend=this.extend;return g};"forEach each map find filter every some indexOf lastIndexOf isEmpty difference without reduce".split(" ").each(function(b){c.Collection.prototype[b]=function(){var c=Array.prototype.slice.call(arguments);return Array.prototype[b].apply(this.models,c)}})})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.utils._extend;c.Batch=function(){this.objects=[];this.connections=[];this.objectDeletions=[];this.edgeDeletions=[]};var b=function(b){-1==this.connections.indexOf(b)&&this.connections.push(b)},e=function(b){-1==this.objects.indexOf(b)&&this.objects.push(b)},k=function(b,d,e){var f;if(g.isString(b)){if(f=b,!g.isString(d)&&0<d.trim().length)throw Error("Specify typename as second argument to Batch.removeObjects");}else if(g.isObject(b)&&b instanceof
c.Object){if(b.isNew())return;f=b.id;e=d;d=b.typeName}else throw Error("Batch.removeObjects accepts only Appacitive.Object or ids with typeName");this.objectDeletions.find(function(b){return f==b.id})||this.objectDeletions.push({type:d,id:f,deleteconnections:e})},d=function(b,d){var e;if(g.isString(b)){if(e=b,!g.isString(d)&&0<d.trim().length)throw Error("Specify relationName as second argument to Batch.removeConnections");}else if(g.isObject(b)&&b instanceof c.Connection){if(b.isNew())return;e=b.id;
d=b.relationName}else throw Error("Batch.removeConnection accepts only Appacitive.Connection or ids with relationName");this.edgeDeletions.find(function(b){return e==b.id})||this.edgeDeletions.push({type:d,id:e})},r=function(d){if(g.isObject(d)){if(d instanceof c.Object)return e.apply(this,[d]);if(d instanceof c.Connection)return b.apply(this,[d])}throw Error("Batch accepts only Appacitive.Object and Appacitive.Connection instances");},f=function(){var b=[];this.objects.forEach(function(c,d){var e=
c._findUnsavedChanges();if(e.object){e.object.__type=c.className;var f=b.find(function(b){return c.id&&c.id==b.object.__id||c.cid==b.name});f&&(f.object=e.object,e=f);delete e.isNested;c.isNew()?e.name=""+c.cid:e.object.__id=c.id;f||b.push(e)}});return b},l=function(){var b=this,c=[];this.connections.forEach(function(d){var e=d._findUnsavedChanges().object;e&&(e.__relationtype=d.className,e.__endpointa&&delete e.__endpointa.object,e.__endpointb&&delete e.__endpointb.object);var f=d.endpointA.object;
g.isObject(f)&&(d.isNew()&&(f.isNew()?e.__endpointa.name=""+d.endpointA.object.cid:e.__endpointa.objectid=d.endpointA.object.id),r.apply(b,[f]));f=d.endpointB.object;g.isObject(f)&&(d.isNew()&&(f.isNew()?e.__endpointb.name=""+d.endpointB.object.cid:e.__endpointb.objectid=d.endpointB.object.id),r.apply(b,[f]));if(e){var f=c.find(function(b){return d.id&&d.id==b.connection.__id||d.cid==b.name}),h={connection:e};f&&(f.connection=e,h=f);d.isNew()?h.name=""+d.cid:h.connection.__id=d.id;f||c.push(h)}});
return c};c.Batch.prototype.add=function(){var b=this;g.isArray(arguments[0])?arguments[0].forEach(function(c){r.apply(b,[c])}):r.apply(this,arguments);return this};c.Batch.prototype.removeObjects=function(){var b=this,c=arguments;g.isArray(c[0])?arguments[0].forEach(function(d){k.apply(b,[d,c[1],c[2]])}):k.apply(this,c);return this};c.Batch.prototype.removeConnections=function(){var b=this,c=arguments;g.isArray(c[0])?arguments[0].forEach(function(e){d.apply(b,[e,c[1],c[2]])}):d.apply(this,c);return this};
c.Batch.prototype.toJSON=function(){var b={nodes:[],edges:[],edgedeletions:[],nodedeletions:[]};b.edges=l.apply(this,[]);b.nodes=f.apply(this,[]);b.nodedeletions=this.objectDeletions;b.edgedeletions=this.edgeDeletions;return b};var v=function(b,c,d){var e=this;b.forEach(function(b){var f=b.object;e.objects.forEach(function(e){if(e.cid==b.name||e.id==f.__id||e.get("__id")==f.__id){var g={__meta:c[e.className]};g[e.getType()]=f;e._parseOutput(d,g)}})})},q=function(b,c,d){var e=this;b.forEach(function(b){var f=
b.connection;e.connections.forEach(function(e){if(e.cid==b.name||e.id==f.__id||e.get("__id")==f.__id){var g={__meta:c[e.className]};g[e.getType()]=f;e._parseOutput(d,g)}})})},u=function(b,d){var e;b&&b.edges&&b.nodes&&0<=b.edges.length&&0<=b.nodes.length?(v.call(this,b.nodes,b.__meta.__type,d),q.call(this,b.edges,b.__meta.__rel,d),d.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},d)):(b=b||{},b.status=b.status||{},e=(e=b.status)||{},e.message=e.message||"Server error",
e.code=e.code||"500",this._triggerError(d,new c.Error(e)));return e};c.Batch.prototype._triggerError=function(b,c){b.silent||this.trigger("error",this,c,b)};c.Batch.prototype.execute=function(b){var d=this.toJSON();b=h({_batch:!0},b);if(0==d.nodes.length&&0==d.edges.length&&0==d.edgedeletions.length&&0==d.nodedeletions.length)return b.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},b),(new c.Promise).fulfill(this);var e=this,f=new c._Request({method:"PUT",type:"multi",
op:"getBatchUrl",data:d,options:b,entity:this,onSuccess:function(c){(c=u.apply(e,[c,b]))?f.promise.reject(c,e):f.promise.fulfill(e)}});return f.send()};c.Events.mixin(c.Batch.prototype)})(global);
(function(m){var c=m.Appacitive;c.Facebook=new function(){var g=null,h=!0;this.initialize=function(b){if(!FB)throw"Facebook SDK needs be loaded before calling initialize.";if(!b.appId)throw Error("Please provide appid");FB.init(b);h=!0};this.requestLogin=function(b){b=b||{};if(!h)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");var e=c.Promise.buildPromise(b);b.scope||(b.scope="email");FB.login(function(b){b&&"connected"===b.status&&b.authResponse?(g=b.authResponse.accessToken,
e.fulfill(b.authResponse)):e.reject()},b);return e};this.getCurrentUserInfo=function(b){if(!h)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");b=b||{};var e=c.Promise.buildPromise(b);FB.api("/me",function(b){b&&!b.error?(g=FB.getAuthResponse().accessToken,e.fulfill(b)):e.reject()});return e};this.accessToken=function(){return 1===arguments.length?(g=arguments[0],this):g};this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=
function(b){g=null;b=b||{};var e=c.Promise.buildPromise(b);try{FB.logout(function(){c.Users.logout();e.fulfill()})}catch(h){e.reject(h.message)}return e}}})(global);
(function(m){var c=m.Appacitive;c.Email=new function(){var g={smtp:{username:null,password:null,host:"smtp.gmail.com",port:465,enablessl:!0},from:null,replyto:null};this.getConfig=function(){return g};var h=function(b,e){var g=new c._Request({method:"POST",type:"email",op:"getSendEmailUrl",options:e,data:b,entity:b,onSuccess:function(b){g.promise.fulfill(b.email)}});return g.send()};this.setupEmail=function(b){b=b||{};g.smtp.username=b.username||g.smtp.username;g.from=b.from||g.from;g.smtp.password=
b.password||g.smtp.password;g.smtp.host=b.smtp.host||g.smtp.host;g.smtp.port=b.smtp.port||g.smtp.port;g.smtp.enablessl=b.enableSSL||g.smtp.enablessl;g.replyto=b.replyTo||g.replyto};this.sendTemplatedEmail=function(b,c){if(!b||!b.to||!b.to.length||0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&g.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");
if(!b.templateName)throw Error("template name is mandatory to send an email");var k={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{templatename:b.templateName||"",data:b.data||{},ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){k.smtp=g.smtp;if(!b.from&&!g.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");k.from=b.from||g.from;k.replyto=b.replyTo||g.replyto}return h(k,c)};this.sendRawEmail=function(b,c){if(!b||!b.to||!b.to.length||
0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&g.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");if(!b.body)throw Error("body is mandatory to send an email");var k={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{content:b.body||"",ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){k.smtp=
g.smtp;if(!b.from&&!g.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");k.from=b.from||g.from;k.replyto=b.replyTo||g.replyto}return h(k,c)}}})(global);
(function(m){var c=m.Appacitive;c.Push=new function(){this.send=function(g,h){if(!g)throw Error("Please specify push options");var b=new c._Request({method:"POST",type:"push",op:"getPushUrl",options:h,data:g,entity:g,onSuccess:function(c){b.promise.fulfill(c.id)}});return b.send()};this.getNotification=function(g,h){if(!g)throw Error("Please specify notification id");var b=new c._Request({method:"GET",type:"push",op:"getGetNotificationUrl",args:[g],options:h,onSuccess:function(c){b.promise.fulfill(c.pushnotification)}});
return b.send()};this.getAllNotifications=function(g,h){g?(g.pnum=g.pnum||1,g.psize=g.psize||20):g={pnum:1,psize:20};var b=new c._Request({method:"GET",type:"push",op:"getGetAllNotificationsUrl",args:[g],options:h,onSuccess:function(c){b.promise.fulfill(c.pushnotifications,c.paginginfo)}});return b.send()}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type;c.File=function(h){h=h||{};this.fileId=h.fileId;this.contentType=h.contentType;this.fileData=h.fileData;var b=this,e=function(d,e,g,h,k){var m=new c.HttpRequest;m.url=d;m.method="GET";m.description=h;m.onSuccess=e;m.promise=g;m.entity=b;m.options=k;c.http.send(m)},k=function(d,e,g,h,k){var m=new c.HttpRequest;m.url=d;m.method="PUT";m.log=!1;m.description="Upload file";m.data=e;m.headers.push({key:"Content-Type",value:g});m.send().then(h,function(c){k.reject(c,
b)})};this.save=function(b,c){"number"!==typeof b&&(c=b,b=-1);return this.fileId&&g.isString(this.fileId)&&0<this.fileId.length?m(b,c):d(b,c)};var d=function(d,h){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(m){}b.contentType&&g.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var q=c.Promise.buildPromise(h),r=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(b.contentType,b.fileId?b.fileId:
"");e(r,function(c){k(c.url,b.fileData,b.contentType,function(){b.fileId=c.id;b.getDownloadUrl(d,h).then(function(c){return q.fulfill(c,b)},function(b){return q.reject(b)})},q)},q," Get upload url for file ",h);return q},m=function(d,h){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(m){}b.contentType&&g.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var q=c.Promise.buildPromise(h),r=c.config.apiBaseUrl+
c.storage.urlFactory.file.getUpdateUrl(b.fileId,b.contentType);e(r,function(c){k(c.url,b.fileData,b.contentType,function(){b.getDownloadUrl(d,h).then(function(c){q.fulfill(c,b)},function(b){q.reject(b)})},q)},q," Get update url for file "+b.fileId,h);return q};this.destroy=function(d){if(!this.fileId)throw Error("Please specify fileId to delete");var e=c.Promise.buildPromise(d),g=new c.HttpRequest;g.url=c.config.apiBaseUrl+c.storage.urlFactory.file.getDeleteUrl(this.fileId);g.method="DELETE";g.description=
"Delete file with id "+this.fileId;g.onSuccess=function(b){e.fulfill()};g.promise=e;g.entity=b;g.options=d;return c.http.send(g)};this.getDownloadUrl=function(d,g){if(!this.fileId)throw Error("Please specify fileId to download");"number"!==typeof d&&(g=d,d=-1);var h=c.Promise.buildPromise(g),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getDownloadUrl(this.fileId,d);e(k,function(c){b.url=c.uri;h.fulfill(c.uri)},h," Get download url for file "+this.fileId,g);return h};this.getUploadUrl=function(d){b.contentType&&
g.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var h=c.Promise.buildPromise(d),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(this.contentType,this.fileId?this.fileId:"");e(k,function(c){b.url=c.url;h.fulfill(c.url,b)},h," Get upload url for file "+this.fileId,d);return h}}})(global);
(function(m){var c=m.Appacitive;c.Date={};var g=function(c){return 10>c?"0"+c:c};c.Date.parse=function(c){var b,e=0,g=[1,4,5,6,7,10,11];if(b=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}|\d{7}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(c)){c=0;for(var d;d=g[c];++c)b[d]=+b[d]||0;b[2]=(+b[2]||1)-1;b[3]=+b[3]||1;"Z"!==b[8]&&void 0!==b[9]?(e=60*b[10]+b[11],"+"===b[9]&&(e=0-e)):"Z"==b[8]&&(b[7]=b[7].toString().substring(0,3));b=Date.UTC(b[1],b[2],b[3],b[4],
b[5]+e,b[6],b[7])}else b=Date.parse?Date.parse(c):NaN;return b};c.Date.parseISODate=function(g){try{return new Date(c.Date.parse(g))}catch(b){return null}};c.Date.toISOString=function(c){try{return c=c.toISOString(),c=c.replace("Z","0000Z")}catch(b){return null}};c.Date.toISODate=function(c){if(c instanceof Date)return String.format("{0}-{1}-{2}",c.getFullYear(),g(c.getMonth()+1),g(c.getDate()));throw Error("Invalid date provided Appacitive.Date.toISODate method");};c.Date.toISOTime=function(c){var b=
function(b){return 10>b?b+"000000":100>b?b+"00000":1E3>b?b+"0000":1E4>b?b+"000":1E5>b?b+"00":1E6>b?b+"0":b};if(c instanceof Date)return String.format("{0}:{1}:{2}.{3}",g(c.getHours()),g(c.getMinutes()),g(c.getSeconds()),b(c.getMilliseconds()));throw Error("Invalid date provided Appacitive.Date.toISOTime method");};c.Date.parseISOTime=function(c){try{var b=new Date,e=c.split("T");1===e.length&&e.push(e[0]);if(!/^([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z?$/.exec(e[1]))return null;var g=e[1].split("Z")[0].split(":"),
d=g[2].split("."),m=Number(g[0]);1<e.length?(b.setUTCHours(Number(m)),b.setUTCMinutes(Number(g[1])),b.setUTCSeconds(Number(d[0])),d[1]&&b.setUTCMilliseconds(Number(d[1].substring(0,3)))):(b.setHours(Number(m)),b.setMinutes(Number(g[1])),b.setSeconds(Number(d[0])),d[1]&&b.setMilliseconds(Number(d[1].substring(0,3))));return b}catch(f){return null}}})(global);
(function(m){var c=m.Appacitive,g=c.utils._type,h=c.runtime.isBrowser&&"object"==typeof window.localStorage&&g.isFunction(window.localStorage.getItem);c.LocalStorage=new function(){var b=h?window.localStorage:{};this.set=function(e,h){h=h||"";if(!g.isString(e))return this;if(g.isObject(h)||g.isArray(h))try{h=JSON.stringify(h)}catch(d){}var m=c.getAppPrefix(e);b[m]=h;return this};this.get=function(e){if(!g.isString(e))return promise.fulfill(null,e);e=c.getAppPrefix(e);(e=h?b.getItem(e):b[e])||(e=null);
if(e&&"{"===e[0])try{e=JSON.parse(e)}catch(k){}return e};this.multiGet=function(){var b=this,c=Array.prototype.slice.call(arguments);if(1<arguments.length){var d={};c.forEach(function(c){Array.isArray(c)&&(c=c.join());c.replace(/\s/g,"").split(",").forEach(function(c){d[c]=b.get(c)})});return d}throw Error("Appacitive.LocalStorage.multiGet requires atleast one argument");};this.remove=function(e){if(!g.isString(e))return this;e=c.getAppPrefix(e);try{delete b[e]}catch(h){}}}})(global);
(function(m){var c=m.Appacitive;m=c.utils._type;"undefined"!=typeof document&&m.isString(document.cookie)&&(c.Cookie=new function(){this.setCookie=function(g,h,b,e){g=c.getAppPrefix(g);var k="";b&&(k=new Date,k.setTime(k.getTime()+6E4*b),k.toGMTString());k=e?"; expires=Thu, 01-Jan-1970 00:00:01 GMT":c.Session.persistUserToken?"; expires="+(new Date("2020-12-31")).toGMTString():"";b="domain="+window.location.hostname;"localhost"==window.location.hostname&&(b="");document.cookie=g+"="+h+k+"; path=/;"+
b};this.readCookie=function(g){g=c.getAppPrefix(g);g+="=";for(var h=document.cookie.split(";"),b=0;b<h.length;b++){for(var e=h[b];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(g))return e.substring(g.length,e.length)}return null};this.eraseCookie=function(c){this.setCookie(c,"",-1,!0)}})})(global);"object"===typeof module&&module.exports&&"function"===typeof require&&(module.exports=global.Appacitive);
