/*
 * AppacitiveSDK.js vappacitive-js-sdk-v1.0.4 - Javascript SDK to integrate applications using Appacitive
 * Copyright (c) 2015 Appacitive Software Pvt Ltd
 * MIT license  : http://www.apache.org/licenses/LICENSE-2.0.html
 * Project      : https://github.com/chiragsanghvi/JavascriptSDK
 * Contact      : support@appacitive.com | csanghvi@appacitive.com
 * Build time 	: Mon Oct 12 12:22:32 IST 2015
 */
var global={};
(function(){global.Appacitive||("undefined"!==typeof module&&module.exports?(global="undefined"!==typeof process?process:{},global.Appacitive={runtime:{isNode:!0,isBrowser:!1}}):(global="undefined"!==typeof window?window:{},global.Appacitive={runtime:{isNode:!1,isBrowser:!0}}));var l=global.Appacitive,c=function(d){if(d&&d.send&&"function"==typeof d.send)d.onResponse=this.onResponse;else throw Error("No applicable httpTransport class found");var b=[],h={},c=0,e={},g=0;this.addProcessor=function(d){d&&
(d.pre=d.pre||function(){},d.post=d.post||function(){},k(d.pre),f(d.post))};var k=function(d){c+=1;h[c]=d;return c},f=function(d){g+=1;e[g]=d;return g};this.enqueueRequest=function(d){b.push(d)};this.changeRequestForCors=function(d){var b={m:d.method.toUpperCase()};d.headers.forEach(function(d){b[d.key]=d.value});d.prevHeaders=d.headers;d.headers=[];d.headers.push({key:"Content-Type",value:"text/plain; charset=utf-8"});d.method="POST";d.data&&(b.b=d.data);delete d.data;l.config.debug&&(-1===d.url.indexOf("?")?
d.url+="?debug=true":d.url+="&debug=true");l.config.metadata&&(-1===d.url.indexOf("?")?d.url+="?metadata=true":d.url+="&metadata=true");try{d.data=JSON.stringify(b)}catch(h){}return d};this.notify=function(){if(0!==b.length){var c=[],m;for(m in e)e.hasOwnProperty(m)&&c.push(e[m]);for(;0<b.length;){var g=b.shift(),k=[];for(m in h)h.hasOwnProperty(m)&&k.push(h[m](g));this.changeRequestForCors(g);d.send(g,c,k)}}};this.onResponse=function(d){console.dir(d)}},f=function(){var d=function(){throw Error("Not Implemented Exception");
};this.inOnline=this.send=d;this.onResponse=function(b,h){d()};this.onError=function(b){d()}},g=null,g=l.runtime.isBrowser?XMLHttpRequest:require("xmlhttprequest-with-globalagent").XMLHttpRequest,b=function(d){var b=l.Promise.buildPromise({success:d.onSuccess,error:d.onError}),h=new XDomainRequest;h.onload=function(){var d=h.responseText,c=h.contentType||"";if("application/json"==c.toLowerCase()||"application/javascript"==c.toLowerCase()||"application/json; charset=utf-8"==c.toLowerCase()||"application/json; charset=utf-8;"==
c.toLowerCase())try{c=d,l.runtime.isBrowser||"{"!=c[0]&&(c=c.substr(1,c.length-1)),d=JSON.parse(c)}catch(e){return b.reject(h,new l.Error(l.Error.InvalidJson,"Error while parsing received json "+d))}b.fulfill(d,this)};h.onerror=h.ontimeout=function(){h.responseData="IE's XDomainRequest does not supply error info.";h.status=l.Error.XDomainRequest;b.reject(h,new l.Error(l.Error.XDomainRequest,h.responseData,"Unknown"))};h.onprogress=function(){};-1===d.url.indexOf("?")?d.url+="?ua=ie":d.url+="&ua=ie";
h.open(d.method,d.url,d.sync?!1:!0);h.send(d.data);return b},e=function(d){if(!d.url)throw Error("Please specify request url");d.method||(d.method="GET");d.headers||(d.headers=[]);var c={};d.onSuccess&&"function"==typeof d.onSuccess||(d.onSuccess=function(){});d.onError&&"function"==typeof d.onError||(d.onError=function(){});var h=l.Promise.buildPromise({success:d.onSuccess,error:d.onError}),e=!0;d.headers.forEach(function(d){"content-type"==d.key.toLowerCase()&&(e=!0,"application/json"==d.value.toLowerCase()||
"application/javascript"==d.value.toLowerCase()||"application/json; charset=utf-8"==d.value.toLowerCase()||"application/json; charset=utf-8;"==d.value.toLowerCase())&&(e=!1)});if(e)c=d.data;else if(d.data&&(c=d.data,"object"==typeof d.data))try{c=JSON.stringify(c)}catch(k){}var r=d.url.split("/")[2]||"";if(global.navigator&&-1!=global.navigator.userAgent.indexOf("MSIE 8")&&r!==window.location.host.toLowerCase())return d.data=c,new b(d);r=new g;r.onreadystatechange=function(){if(4==this.readyState)if(200<=
this.status&&300>this.status||304==this.status){var d=this.responseText,b=this.getResponseHeader("content-type")||this.getResponseHeader("Content-Type")||"";if("application/json"==b.toLowerCase()||"application/javascript"==b.toLowerCase()||"application/json; charset=utf-8"==b.toLowerCase()||"application/json; charset=utf-8;"==b.toLowerCase())try{b=d,l.runtime.isBrowser||"{"!=b[0]&&(b=b.substr(1,b.length-1)),d=JSON.parse(b)}catch(c){return h.reject(this,new l.Error(l.Error.InvalidJson,"Error while parsing received json "+
d))}h.fulfill(d,this)}else h.reject(this,new l.Error(l.Error.ConnectionFailed,this.responseText,"Unknown"))};r.open(d.method,d.url,d.sync?!1:!0);for(var f=0;f<d.headers.length;f+=1)r.setRequestHeader(d.headers[f].key,d.headers[f].value);l.runtime.isBrowser||r.setRequestHeader("User-Agent","Appacitive-NodeJSSDK");r.send(c);return h},k=function(){var d=new f;d.isOnline=function(){return!0};var b=function(b,c,g){b.options=b.options||{};new e({method:b.method,url:b.url,headers:b.headers,data:b.data,sync:b.options.sync,
onSuccess:function(e,k){if(e){try{e=JSON.parse(e)}catch(f){}var q=e;if(c.length!=g.length)throw Error("Callback length and state length mismatch!");for(var n=0;n<c.length;n+=1)c[n].apply({},[q,g[n]]);if(200<=e.code&&300>=e.code||e.status&&200<=e.status.code&&300>=e.status.code)d.onResponse(b,e);else e=e||{},e=e.status||e,e.message=e.message||"Bad Request",e.code=e.code||"400",d.onError(b,{responseText:e})}else d.onError(b,{responseText:{code:"400",message:"Invalid request"}})},onError:function(c,
e){var g={};e?g=l.Error.toJSON(e):(g.message=c.responseData||c.responseText||"Bad Request",g.code=c.status||"400");d.onError(b,{responseText:g})}})};d.send=function(d,c,e){if(!l.Session.initialized)throw Error("Initialize Appacitive SDK");"function"==typeof d.beforeSend&&d.beforeSend(d);b(d,c,e)};return d};l.http=new function(){var d=new k,b=new c(d),h=!1;this.pause=function(){h=!0};this.unpause=function(){h=!1};this.addProcessor=function(d){var h=Error('Must provide a processor object with either a "pre" function or a "post" function.');
if(!d)throw h;if(!d.pre&&!d.post)throw h;b.addProcessor(d)};this.send=function(c){c.promise=l.Promise.is(c.promise)?c.promise:new l.Promise.buildPromise({error:c.onError});b.enqueueRequest(c);d.isOnline()&&!1===h&&b.notify();return c.promise};this.flush=function(h){h?b.notify():d.isOnline()&&b.notify()};this.onError=function(d,b){var h=b.responseText;l.logs.logRequest(d,h,h,"error");d.entity&&d.entity._triggerError&&d.entity._triggerError(d.options,new l.Error(h));d.promise.reject(new l.Error(h),
d.entity)};d.onError=this.onError;this.onResponse=function(d,b){if(d.onSuccess)if(d.context)d.onSuccess.apply(d.context,[b]);else d.onSuccess(b);l.logs.logRequest(d,b,b?b.status:null,"successful")};d.onResponse=this.onResponse};l.HttpRequest=function(d){d=d||{};this.url=d.url||"";this.data=d.data||{};this.headers=d.headers||[];this.method=d.method||"GET";this.onSuccess=d.onSuccess||function(){};this.onError=d.onError||function(){};this.send=function(d){return new e(this,d)}};(function(d){var b=d.Appacitive;
b&&b.http&&(b.http.addProcessor({pre:function(d){return d},post:function(d,c){try{var e=b.Session.isSessionValid(d);e.status?d&&(d.status&&d.status.code&&("19036"==d.status.code||"421"==d.status.code)||d.code&&("19036"==d.code||"421"==d.code))?b.Users.logout():b.Session.incrementExpiry():e.isSession&&(null!==b.Session.get()&&b.Session.resetSession(),b.http.send(c))}catch(g){}}}),b.http.addProcessor({pre:function(d){return{start:(new Date).getTime(),request:d}},post:function(d,b){b.request.timeTakenInMilliseconds=
(new Date).getTime()-b.start}}))})(global)})(this);var _type=function(l){if(null===l)return"null";if("undefined"===typeof l||"undefined"===l)return"undefined";if(l&&(1===l.nodeType||9===l.nodeType))return"element";var c=Object.prototype.toString.call(l).match(/\[object (.*?)\]/)[1].toLowerCase();if("number"===c){if(isNaN(l))return"nan";if(!isFinite(l))return"infinity"}return c};
(function(l){"bind"in Function.prototype||(Function.prototype.bind=function(b){var d=this;if(1>=arguments.length)return function(){return d.apply(b,arguments)};var c=Array.prototype.slice.call(arguments,1);return function(){return d.apply(b,0===arguments.length?c:c.concat(Array.prototype.slice.call(arguments)))}});"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});"indexOf"in Array.prototype||(Array.prototype.indexOf=function(b,d){void 0===
d&&(d=0);0>d&&(d+=this.length);0>d&&(d=0);for(var c=this.length;d<c;d++)if(d in this&&this[d]===b)return d;return-1});"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(b,d){void 0===d&&(d=this.length-1);0>d&&(d+=this.length);d>this.length-1&&(d=this.length-1);for(d++;0<d--;)if(d in this&&this[d]===b)return d;return-1});"forEach"in Array.prototype||(Array.prototype.forEach=function(b,d){for(var c=0,h=this.length;c<h;c++)c in this&&b.call(d,this[c],c,this)});"map"in Array.prototype||
(Array.prototype.map=function(b,d){for(var c=Array(this.length),h=0,e=this.length;h<e;h++)h in this&&(c[h]=b.call(d,this[h],h,this));return c});"filter"in Array.prototype||(Array.prototype.filter=function(b,d){for(var c=[],h,e=0,g=this.length;e<g;e++)e in this&&b.call(d,h=this[e],e,this)&&c.push(h);return c});"every"in Array.prototype||(Array.prototype.every=function(b,d){for(var c=0,h=this.length;c<h;c++)if(c in this&&!b.call(d,this[c],c,this))return!1;return!0});"some"in Array.prototype||(Array.prototype.some=
function(b,d){for(var c=0,h=this.length;c<h;c++)if(c in this&&b.call(d,this[c],c,this))return!0;return!1});"find"in Array.prototype||(Array.prototype.find=function(b,d){var c=this.length;if(0!==c)for(var h=0,e;h<c&&h in this;h++)if(e=this[h],b.call(d,e,h,this))return e});"where"in Array.prototype||(Array.prototype.where=function(b,d){return 0===this.length?void 0:Object.isEmpty(b)?d?void 0:[]:this[d?"find":"filter"](function(d){for(var c in b)if(b[c]!==d[c])return!1;return!0})},Array.prototype.findWhere=
function(b){return this.where(b,!0)});"each"in Array.prototype||(Array.prototype.each=function(b,d){for(var c=0;c<this.length;c++)b.apply(d,[this[c]])});"difference"in Array.prototype||(Array.prototype.difference=function(b){return this.filter(function(d){return 0>b.indexOf(d)})});"without"in Array.prototype||(Array.prototype.without=function(){return this.difference(Array.prototype.slice.call(arguments,0))});"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(b){if(null===
this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof b)throw new TypeError(b+" is not a function");var d=Object(this),c=d.length>>>0,h=0,e;if(2<=arguments.length)e=arguments[1];else{for(;h<c&&!h in d;)h++;if(h>=c)throw new TypeError("Reduce of empty array with no initial value");e=d[h++]}for(;h<c;h++)h in d&&(e=b(e,d[h],h,d));return e});var c=function(b,d){return null==b?_.identity:_.isFunction(b)?d?function(){return b.apply(d,
arguments)}:b:function(d){return d[b]}};Array.prototype.pluck=function(b){var d=[];this.each(function(c){d.push(c[b])});return d};Array.prototype.sortBy=function(b,d){b=c(b,d);return this.map(function(c,h){return{value:c,criteria:b.call(d,c,h,this)}},this).sort(function(d,b){var c=d.criteria,e=b.criteria;return c<e?-1:c>e?1:0}).pluck("value")};Array.prototype.removeAll=function(b){for(var d=null,c=0;c<this.length;c++)for(;this[c]===b;)d=this.splice(c,1)[0];return d};Array.prototype.compare=function(b){if(!b||
this.length!=b.length)return!1;for(var d=0,c=this.length;d<c;d++)if(this[d]instanceof Array&&b[d]instanceof Array){if(!this[d].compare(b[d]))return!1}else if(this[d]!=b[d])return!1;return!0};Array.prototype.equals=function(b,d){if(!b)return!1;1==arguments.length&&(d=!1);if(this.length!=b.length)return!1;for(var c=0;c<this.length;c++)if(this[c]instanceof Array&&b[c]instanceof Array){if(!this[c].equals(b[c],d))return!1}else{if(d&&!_type.isEqual(this[c],b[c]))return!1;if(!d)return this.sort().equals(b.sort(),
!0)}return!0};Date.prototype.toISOString||function(){function b(d){d=String(d);1===d.length&&(d="0"+d);return d}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}();String.addSlashes=function(b){if(!b)return b;b=b.replace(/\\/g,"\\\\");b=b.replace(/\'/g,"\\'");b=b.replace(/\"/g,
'\\"');return b=b.replace(/\0/g,"\\0")};String.stripSlashes=function(b){if(!b)return b;b=b.replace(/\\'/g,"'");b=b.replace(/\\"/g,'"');b=b.replace(/\\0/g,"\x00");return b=b.replace(/\\\\/g,"\\")};if("undefined"===typeof console||null===console)console={log:function(){},dir:function(){}};for(var f="Null Undefined Object Array String Number Boolean Function RegExp Element NaN Infinite".split(" "),g=function(b){_type["is"+b]=function(d){return _type(d)===b.toLowerCase()}},b=0;b<f.length;b++)g(f[b]);
_type.isNullOrUndefined=function(b){return"null"==_type(b)||"undefined"==_type(b)};_type.isNumeric=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};_type.isDate=function(b){return b instanceof Date};var e=function(b,d,c,h){var g=Object.prototype.toString;if(b===d)return 0!==b||1/b==1/d;if(null==b||null==d)return b===d;var f=g.call(b);if(f!=g.call(d))return!1;switch(f){case "[object String]":return b==String(d);case "[object Number]":return b!=+b?d!=+d:0==b?1/b==1/d:b==+d;case "[object Date]":case "[object Boolean]":return+b==
+d}if("object"!=typeof b||"object"!=typeof d)return!1;if(b instanceof l.Appacitive.GeoCoord&&d instanceof l.Appacitive.GeoCoord)return b.toString()==d.toString();for(g=c.length;g--;)if(c[g]==b)return h[g]==d;var g=b.constructor,r=d.constructor;if(g!==r&&!(_types.isFunction(g)&&g instanceof g&&_types.isFunction(r)&&r instanceof r)&&"constructor"in b&&"constructor"in d)return!1;c.push(b);h.push(d);g=0;r=!0;if("[object Array]"==f){if(g=b.length,r=g==d.length)for(;g--&&(r=e(b[g],d[g],c,h)););}else{for(var u in b)if(Object.prototype.hasOwnProperty.call(b,
u)&&(g++,!(r=Object.prototype.hasOwnProperty.call(d,u)&&e(b[u],d[u],c,h))))break;if(r){for(u in d)if(Object.prototype.hasOwnProperty.call(d,u)&&!g--)break;r=!g}}c.pop();h.pop();return r};_type.isEqual=function(b,d){return e(b,d,[],[])};l.Appacitive.utils=l.Appacitive.utils||{};l.Appacitive.utils._type=_type})(global);
(function(l){var c=Array.prototype,f=Object.prototype,g=l.Appacitive;g.utils._each=function(b,g,d){if(null!=b)if(c.forEach&&b.forEach===c.forEach)b.forEach(g,d);else if(b.length===+b.length)for(var q=0,h=b.length;q<h&&g.call(d,b[q],q,b)!=={};q++);else for(q in b)if(f.hasOwnProperty.call(b,q)&&g.call(d,b[q],q,b)==={})break};g.utils._extend=function(b){g.utils._each(c.slice.call(arguments,1),function(c){if(c)for(var d in c)b[d]=c[d]});return b};g.utils._reject=function(b,c){return b.filter(function(b){return!c(b)})};
g.utils._deepExtend=function(b){g.utils._each(Array.prototype.slice.call(arguments,1),function(c){for(var d in c)g.utils._type.isArray(c[d])?(g.utils._type.isArray(b[d])||(b[d]=[]),b[d]=g.utils._reject(g.utils._extend(b[d],c[d]),function(b){return g.utils._type.isNull(b)})):!g.utils._type.isObject(c[d])||c[d]instanceof g.Object||c[d]instanceof g.Connection||c[d]instanceof g.GeoCoord?b[d]=c[d]:(g.utils._type.isObject(b[d])||(b[d]={}),b[d]=g.utils._extend(b[d],c[d]))});return b};var b=function(b,c){var d=
this,f;f=g.utils._type.isObject(b)&&b.hasOwnProperty("constructor")?b.constructor:function(){return d.apply(this,arguments)};g.utils._extend(f,d,c);var h=function(){this.constructor=f};h.prototype=d.prototype;f.prototype=new h;b&&g.utils._extend(f.prototype,b);f.__super__=d.prototype;return f};g.utils.classExtend=function(c,g,d){return b.apply(c,[g,d])};g.utils._result=function(b,c,d){c=null==b?void 0:b[c];void 0===c&&(c=d);return g.utils._type.isFunction(c)?c.call(b):c};g.clone=g.utils._clone=function(b){return g.utils.isObject(b)?
g.utils.isArray(b)?b.slice():g.utils._extend({},b):b}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;c.logs={};var g=function(b,c){setTimeout(function(){try{b.call({},c)}catch(g){}},0)};c.logs.logRequest=function(b,e,k,d){e=e||{};k=k||{};var q={};try{q=JSON.parse(b.data),f.isObject(q)||(q={})}catch(h){}var m={status:d,referenceId:k.referenceid,date:(new Date).toISOString(),method:q.m,url:decodeURIComponent(b.url),responseTime:b.timeTakenInMilliseconds,headers:{},request:null,response:e,description:b.description};b.headers&&b.headers.forEach(function(b){m.headers[b.key]=
b.value});b.prevHeaders&&b.prevHeaders.forEach(function(b){m.headers[b.key]=b.value});"GET"!==m.method&&(m.request=q.b);"error"==d&&(c.runtime.isBrowser&&console.dir(m),f.isFunction(c.logs.apiErrorLog)&&g(c.logs.apiErrorLog,m));f.isFunction(c.logs.apiLog)&&g(c.logs.apiLog,m)};c.logs.logException=function(b){f.isFunction(c.logs.exceptionLog)&&g(c.logs.exceptionLog,b)}})(global);
(function(l){var c=l.Appacitive;String.format=function(c,g){if(1>=arguments.length)return c;for(var b=arguments.length-2,e=0;e<=b;e++)c=c.replace(new RegExp("\\{"+e+"\\}","gi"),arguments[e+1]);return c};String.prototype.toPascalCase=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trimChar=function(c){var g=new RegExp("^"+c),b=this;g.test(b)&&(b=b.slice(1,b.length));g=new RegExp(c+"$");g.test(b)&&(b=b.slice(0,-1));return b};String.toSearchString=function(c){"undefined"===
typeof c&&(c="");for(var g="",b=0;b<c.length;b+=1)-1===" .,;#".indexOf(c[b])&&(g+=c[b]);return g=g.toLowerCase()};String.contains=function(c,g){return-1!==c.indexOf(g)};String.startsWith=function(c,g){return 0===c.indexOf(g)};Array.distinct=function(c){var g=[],b=c.length,e,k,d;for(k=0;k<b;k++){e=void 0;for(d=0;d<g.length;d++)if(c[k].toLowerCase()===g[d].toLowerCase()){e=!0;break}e||g.push(c[k])}return g};Object.isEmpty=function(c){if(!c)return!0;var g=!0,b;for(b in c){g=!1;break}return g};l.dateFromWcf=
function(c,g){var b=/Date\(([^)]+)\)/.exec(c);if(2!=b.length){if(!g)return s;throw Error(s+" is not .net json date.");}return new Date(parseFloat(b[1]))};c.storage=c.storage||{};c.storage.urlFactory=new function(){c.bag=c.bag||{};var f=function(c){"object"===typeof c&&0<c.length&&("string"===typeof c[0]||"number"===typeof c[0])&&(c=c.join(","));c||(c="");return c};this.application={applicationServiceUrl:"application",getSessionCreateUrl:function(){return String.format("{0}/session",this.applicationServiceUrl)}};
this.email={emailServiceUrl:"email",getSendEmailUrl:function(){return String.format("{0}/send",this.emailServiceUrl)}};this.user={userServiceUrl:"user",getCreateUrl:function(c,b){return String.format("{0}/create?fields={1}",this.userServiceUrl,f(b))},getAuthenticateUserUrl:function(){return String.format("{0}/authenticate",this.userServiceUrl)},getGetUrl:function(c,b,e){return String.format("{0}/{1}?fields={2}",c,b,f(e))},getUserByTokenUrl:function(c){return String.format("{0}/me?useridtype=token&token={1}",
this.userServiceUrl,c)},getUserByUsernameUrl:function(c){return String.format("{0}/{1}?useridtype=username",this.userServiceUrl,c)},getUpdateUrl:function(c,b,e){return e?String.format("{0}/{1}?fields={2}&revision={3}",this.userServiceUrl,c,f(b),e):String.format("{0}/{1}?fields={2}",this.userServiceUrl,c,f(b))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}?deleteconnections=true",this.userServiceUrl,b):String.format("{0}/{1}",this.userServiceUrl,b)},getGetAllLinkedAccountsUrl:function(c){return String.format("{0}/{1}/linkedaccounts",
this.userServiceUrl,c)},getValidateTokenUrl:function(c){return String.format("{0}/validate?userToken={1}",this.userServiceUrl,c)},getInvalidateTokenUrl:function(c){return String.format("{0}/invalidate?userToken={1}",this.userServiceUrl,c)},getSendResetPasswordEmailUrl:function(){return String.format("{0}/sendresetpasswordemail",this.userServiceUrl)},getUpdatePasswordUrl:function(c){return String.format("{0}/{1}/changepassword",this.userServiceUrl,c)},getLinkAccountUrl:function(c){return String.format("{0}/{1}/link",
this.userServiceUrl,c)},getDelinkAccountUrl:function(c,b){return String.format("{0}/{1}/{2}/delink",this.userServiceUrl,c,b)},getCheckinUrl:function(c,b,e){return String.format("{0}/{1}/chekin?lat={2}&lng={3}",this.userServiceUrl,c,b,e)},getResetPasswordUrl:function(c){return String.format("{0}/resetpassword?token={1}",this.userServiceUrl,c)},getValidateResetPasswordUrl:function(c){return String.format("{0}/validateresetpasswordtoken?token={1}",this.userServiceUrl,c)}};this.device={deviceServiceUrl:"device",
getCreateUrl:function(c,b){return String.format("{0}/register?fields={1}",this.deviceServiceUrl,f(b))},getGetUrl:function(c,b,e){return String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,b,f(e))},getUpdateUrl:function(c,b,e){return e?String.format("{0}/{1}?fields={2}&revision={3}",this.deviceServiceUrl,c,f(b),e):String.format("{0}/{1}?fields={2}",this.deviceServiceUrl,c,f(b))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}?deleteconnections=true",this.deviceServiceUrl,b):String.format("{0}/{1}",
this.deviceServiceUrl,b)}};this.object={objectServiceUrl:"object",getSearchAllUrl:function(c,b,e){var f="",f=String.format("{0}/search/{1}/all",this.objectServiceUrl,c),f=e?f+"?psize="+e:f+"?psize=10";if("undefined"!==typeof b&&0<b.length)for(c=0;c<b.length;c+=1)0!==b[c].trim().length&&(f=f+"&"+b[c]);return f},getProjectionQueryUrl:function(){return String.format("{0}/search/project",this.objectServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/search/{1}/all?properties={2}",
this.objectServiceUrl,c,b)},getMultiGetUrl:function(c,b,e){return String.format("{0}/{1}/multiGet/{2}?fields={3}",this.objectServiceUrl,c,b,f(e))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.objectServiceUrl,c,f(b))},getGetUrl:function(c,b,e){return String.format("{0}/{1}/{2}?fields={3}",this.objectServiceUrl,c,b,f(e))},getUpdateUrl:function(c,b,e,k){return k?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.objectServiceUrl,c,b,f(e),k):String.format("{0}/{1}/{2}?fields={3}",
this.objectServiceUrl,c,b,f(e))},getDeleteUrl:function(c,b,e){return!0===e?String.format("{0}/{1}/{2}?deleteconnections=true",this.objectServiceUrl,c,b):String.format("{0}/{1}/{2}",this.objectServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",this.objectServiceUrl,c)}};this.connection={connectionServiceUrl:"connection",getGetUrl:function(c,b,e){return String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,f(e))},getMultiGetUrl:function(c,b,e){return String.format("{0}/{1}/multiGet/{2}?fields={3}",
this.connectionServiceUrl,c,b,f(e))},getCreateUrl:function(c,b){return String.format("{0}/{1}?fields={2}",this.connectionServiceUrl,c,f(b))},getUpdateUrl:function(c,b,e,k){return k?String.format("{0}/{1}/{2}?fields={3}&revision={4}",this.connectionServiceUrl,c,b,f(e),k):String.format("{0}/{1}/{2}?fields={3}",this.connectionServiceUrl,c,b,f(e))},getDeleteUrl:function(c,b){return String.format("{0}/{1}/{2}",this.connectionServiceUrl,c,b)},getMultiDeleteUrl:function(c){return String.format("{0}/{1}/bulkdelete",
this.connectionServiceUrl,c)},getSearchByArticleUrl:function(c,b,e,f){var d="",d=String.format("{0}/{1}/find/all?label={2}&objectid={3}",this.connectionServiceUrl,c,e,b);if("undefined"!==typeof f&&0<f.length)for(c=0;c<f.length;c+=1)d=d+"&"+f[c];return d},getConnectedArticles:function(c,b,e){var f="",f=String.format("{0}/{1}/{2}/find",this.connectionServiceUrl,c,b);if(e&&e.length&&0<e.length)for(c=0;c<e.length;c+=1)f=0===c?f+("?"+e[c]):f+("&"+e[c]);return f},getInterconnectsUrl:function(){return String.format("{0}/interconnects",
this.connectionServiceUrl)},getPropertiesSearchUrl:function(c,b){return String.format("{0}/{1}/find/all?properties=",this.connectionServiceUrl,c,b)}};this.cannedList={cannedListServiceUrl:"list",getGetListItemsUrl:function(c){return String.format("{0}/list/{1}/contents",this.cannedListServiceUrl,c)}};this.push={pushServiceUrl:"push",getPushUrl:function(){return String.format("{0}/",this.pushServiceUrl)},getGetNotificationUrl:function(c){return String.format("{0}/notification/{1}",this.pushServiceUrl,
c)},getGetAllNotificationsUrl:function(c){return String.format("{0}/getAll?psize={1}&pnum={2}",this.pushServiceUrl,c.psize,c.pnum)}};this.file={fileServiceUrl:"file",getUploadUrl:function(c,b){return b&&0<b.length?String.format("{0}/uploadurl?contenttype={1}&expires=20&filename={2}",this.fileServiceUrl,escape(c),escape(b)):String.format("{0}/uploadurl?contenttype={1}&expires=20",this.fileServiceUrl,escape(c))},getUpdateUrl:function(c,b){return String.format("{0}/updateurl/{1}?contenttype={2}&expires=20",
this.fileServiceUrl,c,escape(b))},getDownloadUrl:function(c,b){return String.format("{0}/download/{1}?expires={2}",this.fileServiceUrl,c,b)},getDeleteUrl:function(c){return String.format("{0}/delete/{1}",this.fileServiceUrl,c)}};this.query={params:function(c){var b=[];return""===location.search||-1===location.search.indexOf("?")?b:c?(c=c.toLowerCase(),location.search.split("?")[1].split("&").forEach(function(e,f){var d=f.split("="),q=d[1];2<d.length&&d.forEach(function(b,c){0!==b&&1!==b&&(q=q+"="+
d[b])});d[0].toLowerCase()===c&&(b=[d[0],q])}),b):location.search.split("?")[1].split("=")}};this.usergroup={usergroupServiceUrl:"usergroup",getUpdateUrl:function(c){return String.format("{0}/{1}/members",this.usergroupServiceUrl,c)}};this.ping={pingServiceUrl:"ping",getPingUrl:function(){return String.format("{0}/",this.pingServiceUrl)}};this.multi={multiServiceUrl:"multi",getBatchUrl:function(){return String.format("{0}/",this.multiServiceUrl)}}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g;g=c.runtime.isNode?process.nextTick:setTimeout;var b=function(){if(!(this instanceof b))return new b;this.calls=[]};b.prototype.isResolved=function(){return 1===this.state?!0:!1};b.prototype.isRejected=function(){return 2===this.state?!0:!1};b.prototype.isFulfilled=function(){return 1===this.state||2===this.state?!0:!1};b.prototype.done=function(){var e,f,d=this.state,g=this.value;if(!d)return this;for(;e=this.calls.shift();)if(f=e[0],"function"===
typeof e[d]){try{g=2===d?e[d].call(f,this.value):e[d].apply(f,this.value)}catch(h){c.logs.logException({name:h.name,message:h.message,stack:h.stack});if(0==f.calls.length)throw h;f.reject(h)}g instanceof b||g&&"function"===typeof g.then?g.then(function(b){f.fulfill(b)},function(b){f.reject(b)}):1===d?f.fulfill(g):f.reject(g)}else 1===d?f.fulfill(g):f.reject(g)};b.prototype.fulfill=function(b){if(this.state)return this;this.state=1;this.reason=this.value=[].slice.call(arguments);this.done();return this};
b.prototype.resolve=b.prototype.fulfill;b.prototype.reject=function(b){if(this.state)return this;this.state=2;this.reason=this.value=b;this.done();return this};b.prototype.then=function(c,f){var d=this,q=new b;this.calls[this.calls.length]=[q,c,f];this.state&&g(function(){d.done()});return q};b.when=function(c){var k=[],d=[],q,h=0,m=new b;if(!c||f.isArray(c)&&0==c.length)return m.fulfill(k),m;var v=function(){h+=1;h==q&&(m.state||(0<d.length?m.reject(d,k?k:[]):m.fulfill(k?k:[])))},r=function(h){var f=
c[h];f instanceof b||f&&"function"===typeof f.then?g(function(){f.then(function(b){k[h]=b;v()},function(b){d[h]=b;v()})}):g(function(){try{k[h]=f.call()}catch(b){d[h]=b}v()})};f.isArray(c)||(c=[c]);q=c.length;for(var u=0;u<q;u+=1)r(u);return m};b.is=function(c){return c instanceof b?!0:!1};b.buildPromise=function(c){var g=new b;f.isObject(c)&&g.then(c.success,c.error);return g};b._continueUntil=function(c,g){return f.isFunction(c)&&c()?g().then(function(){return b._continueUntil(c,g)}):(new b).fulfill()};
c.Promise=b})(global);
(function(l){l.Appacitive.eventManager=new function(){function c(){var c=function(){return Math.floor(65536*Math.random()).toString(16)};return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}var f={};this.subscribe=function(g,b){if("string"!=typeof g||"function"!=typeof b)throw Error("Incorrect subscription call");"undefined"==typeof f[g]&&(f[g]=[]);var e=c();f[g].push({callback:b,id:e});return e};this.unsubscribe=function(c){if(!c)return!1;var b=-1,e=null,k;for(k in f)for(var d=0;d<f[k].length;d+=
1)if(f[k][d].id==c){b=d;e=k;break}return-1!=b?(f[e].splice(b,1),!0):!1};this.fire=function(c,b,e){if("string"!=typeof c)throw Error("Incorrect fire call");if("undefined"==typeof e||null===e)e={};e.eventName=c;if("undefined"!=typeof f.all)for(var k=0;k<f.all.length;k+=1)f.all[k].callback(b,e);k=function(b,c,d){setTimeout(function(){b(c,d)},0)};if("undefined"!=typeof f[c])for(var d=0;d<f[c].length;d+=1)k(f[c][d].callback,b,e)};this.clearSubscriptions=function(c){if("string"!=typeof c)throw Error("Event Name must be string in EventManager.clearSubscriptions");
f[c]&&(f[c].length=0);return this};this.clearAndSubscribe=function(c,b){this.clearSubscriptions(c);this.subscribe(c,b)};this.dump=function(){console.dir(f)}}})(global);
(function(l){var c={},f=Array.prototype.forEach,g=Object.prototype.hasOwnProperty,b=Array.prototype.slice,e=0,k=function(){return{keys:Object.keys,uniqueId:function(b){var c=++e+"";return b?b+c:c},has:function(b,c){return g.call(b,c)},each:function(b,d,h){if(null!=b)if(f&&b.forEach===f)b.forEach(d,h);else if(b.length===+b.length)for(var e=0,m=b.length;e<m&&d.call(h,b[e],e,b)!==c;e++);else for(e in b)if(this.has(b,e)&&d.call(h,b[e],e,b)===c)break},once:function(b){var c=!1,d;return function(){if(c)return d;
c=!0;d=b.apply(this,arguments);b=null;return d}}}}(),d;d={on:function(b,c,d){if(!h(this,"on",b,[c,d])||!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:d,ctx:d||this});return this},once:function(b,c,d){if(!h(this,"once",b,[c,d])||!c)return this;var e=this,f=k.once(function(){e.off(b,f);c.apply(this,arguments)});f._callback=c;return this.on(b,f,d)},off:function(b,c,d){var e,f,m,g,q,w,l,z;if(!this._events||!h(this,"off",b,[c,d]))return this;
if(!b&&!c&&!d)return this._events={},this;g=b?[b]:k.keys(this._events);q=0;for(w=g.length;q<w;q++)if(b=g[q],m=this._events[b]){this._events[b]=e=[];if(c||d)for(l=0,z=m.length;l<z;l++)f=m[l],(c&&c!==f.callback&&c!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[b]}return this},trigger:function(c){if(!this._events)return this;var d=b.call(arguments,1);if(!h(this,"trigger",c,d))return this;var e=this._events[c],f=this._events.all;e&&m(e,d);f&&m(f,arguments);return this},
stopListening:function(b,c,d){var h=this._listeners;if(!h)return this;var e=!c&&!d;"object"===typeof c&&(d=this);b&&((h={})[b._listenerId]=b);for(var f in h)h[f].off(c,d,this),e&&delete this._listeners[f];return this}};var q=/\s+/,h=function(b,c,d,h){if(!d)return!0;if("object"===typeof d){for(var e in d)b[c].apply(b,[e,d[e]].concat(h));return!1}if(q.test(d)){d=d.split(q);e=0;for(var f=d.length;e<f;e++)b[c].apply(b,[d[e]].concat(h));return!1}return!0},m=function(b,c){var d,h=-1,e=b.length,f=c[0],m=
c[1],g=c[2];switch(c.length){case 0:for(;++h<e;)(d=b[h]).callback.call(d.ctx);break;case 1:for(;++h<e;)(d=b[h]).callback.call(d.ctx,f);break;case 2:for(;++h<e;)(d=b[h]).callback.call(d.ctx,f,m);break;case 3:for(;++h<e;)(d=b[h]).callback.call(d.ctx,f,m,g);break;default:for(;++h<e;)(d=b[h]).callback.apply(d.ctx,c)}};k.each({listenTo:"on",listenToOnce:"once"},function(b,c){d[c]=function(c,d,h){var e=this._listeners||(this._listeners={}),f=c._listenerId||(c._listenerId=k.uniqueId("l"));e[f]=c;"object"===
typeof d&&(h=this);c[b](d,h,this);return this}});d.bind=d.on;d.unbind=d.off;d.mixin=function(b){k.each("on once off trigger stopListening listenTo listenToOnce bind unbind".split(" "),function(c){b[c]=this[c]},this);return b};l.Appacitive.Events=d})(global);
(function(l){l.Appacitive.config={apiBaseUrl:"https://apis.appacitive.com/v1.0/",metadata:!0};!l.navigator||-1==l.navigator.userAgent.indexOf("MSIE 8")&&-1==l.navigator.userAgent.indexOf("MSIE 9")||(l.Appacitive.config.apiBaseUrl=window.location.protocol+"//apis.appacitive.com/v1.0/")})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;l=function(g){var b;if(!g||!f.isObject(g))throw Error("Please specify request options");this.promise=c.Promise.buildPromise(g.options);var e=this.request=new c.HttpRequest;b=c.storage.urlFactory[g.type];var k=g.op.replace("get","").replace("Url","")+" "+g.type;b=c.config.apiBaseUrl+b[g.op].apply(b,g.args||[]);e.url=b;e.description=k;e.method=g.method||"get";e.data=g.data||{};e.onSuccess=g.onSuccess;e.onError=g.onError;e.promise=this.promise;e.options=
g.options;g.entity&&(e.entity=g.entity);return this};l.prototype.send=function(){return c.http.send(this.request)};c._Request=l})(global);
(function(l){l=l.Appacitive;var c=l.utils._type,f=l.utils._extend;l.Error=function(f,b,e,k){if(c.isString(f)||c.isNumber(f))f={code:f,message:b,referenceId:e,additionalMessages:k};this.code=f.code||"400";this.message=f.message||"Unknown Error";f.referenceId&&(this.referenceId=f.referenceid||f.referenceId);f.additionalmessages&&(this.additionalMessages=f.additionalmessages||additionalMessages)};l.Error.toJSON=function(c){return{code:c.code,message:c.message,referenceId:c.referenceId,additionalmessages:c.additionalMessages}};
f(l.Error,{BadRequest:"400",AccessControl:"401",PaymentRequired:"402",UsageLimitReached:"403",NotFound:"404",Duplicate:"435",MvccFailure:"409",PreconditionFailed:"412",ApiAuthenticationError:"420",IdentityFailures:"421",IncorrectConfiguration:"436",InternalServerError:"500",DataAccessFailure:"512",UnknownCause:100,InvalidParameters:"400",ConnectionFailed:1001,MissingId:"404",InvalidJson:1007,DuplicateUsername:"435",DuplicateValue:"435",XDomainRequest:5E3})})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;c.Session=new function(){this.initialized=!1;var g=function(){this.apikey="";this.isnonsliding=!1;this.usagecount=-1;this.windowtime=240},b=null,e=null,k=null,d=!1,q;this.useApiKey=!0;this.useMasterKey=!1;this.onSessionCreated=function(){};this.recreate=function(b){return c.Session.create(b)};this.create=function(d){if(!this.initialized)throw Error("Initialize Appacitive SDK");var h=new g;h.apikey=e;var f=new c._Request({method:"PUT",type:"application",
op:"getSessionCreateUrl",options:d,data:h,onSuccess:function(d){b=d.session.sessionkey;c.Session.useApiKey=!1;f.promise.fulfill(d);c.Session.onSessionCreated()}});return f.send()};c.http.addProcessor({pre:function(h){h.options=h.options||{};if(c.Session.useApiKey){var g=e;(h.options.useMasterKey||c.useMasterKey&&!h.options.useMasterKey)&&f.isString(q)&&0<q.length?g=q:f.isString(h.options.apikey)&&(g=h.options.apikey);h.headers.push({key:"ak",value:g})}else h.headers.push({key:"as",value:b});g=f.isString(h.options.userToken)&&
0<h.options.userToken.length?h.options.userToken:!1;if(!0===d||g){var r=-1,u=h.headers.filter(function(b,c){return"ut"==b.key?(r=c,!0):!1});if(h.options.ignoreUserToken)-1!=r&&h.headers.splice(r,1);else{var t=g||k;1==u.length?h.headers.forEach(function(b){"ut"==b.key&&(b.value=t)}):h.headers.push({key:"ut",value:t})}}}});this.setUserAuthHeader=function(b,h,e){try{b&&(d=!0,k=b,e||(h||(h=-1),-1==h&&(h=null),c.localStorage.set("Appacitive-UserToken",b),c.localStorage.set("Appacitive-UserTokenExpiry",
h),c.localStorage.set("Appacitive-UserTokenDate",(new Date).getTime())))}catch(f){}};this.incrementExpiry=function(){try{c.runtime.isBrowser&&d&&c.localStorage.set("Appacitive-UserTokenDate",(new Date).getTime())}catch(b){}};this.removeUserAuthHeader=function(b,h){var e=c.Promise.buildPromise(h);b||c.User.trigger("logout",{});c.localStorage.remove("Appacitive-User");if(k&&b)try{var f=new c.HttpRequest(h);f.url=c.config.apiBaseUrl+c.storage.urlFactory.user.getInvalidateTokenUrl(k);f.method="POST";
f.data={};f.type="user";f.options=h;f.description="InvalidateToken user";f.onSuccess=f.onError=function(){d=!1;k=null;c.User.trigger("logout",{});c.localStorage.remove("Appacitive-UserToken");c.localStorage.remove("Appacitive-UserTokenExpiry");c.localStorage.remove("Appacitive-UserTokenDate");e.fulfill()};c.http.send(f);return e}catch(g){}else return d=!1,k=null,c.localStorage.remove("Appacitive-UserToken"),c.localStorage.remove("Appacitive-UserTokenExpiry"),c.localStorage.remove("Appacitive-UserTokenDate"),
e.fulfill()};this.isSessionValid=function(b){if(b.status){if(b.status.code&&("420"==b.status.code||"19027"==b.status.code||"19002"==b.status.code))return{status:!1,isSession:"19027"==b.status.code||"420"==b.status.code?!0:!1}}else if(b.code&&("420"==b.code||"19027"==b.code||"19002"==b.code))return{status:!1,isSession:"19027"==b.code||"420"==b.code?!0:!1};return{status:!0}};this.resetSession=function(){b=null;this.useApiKey=!0};this.get=function(){return b};this.setSession=function(c){c&&(b=c,this.useApiKey=
!1)};this.setApiKey=function(b){b&&(e=b,this.useApiKey=!0)};this.setMasterKey=function(b){q=b};this.reset=function(){this.removeUserAuthHeader();k=e=b=null;d=!1;q=null;this.useMasterKey=this.useApiKey=this.initialized=!1};var h="sandbox";this.environment=function(){if(1==arguments.length){var b=arguments[0];"sandbox"!=b&&"live"!=b&&(b="sandbox");h=b}return h}};c.getAppPrefix=function(f){return c.Session.environment()+"/"+c.appId+"/"+f};c.ping=function(f){if(!c.Session.initialized)throw Error("Initialize Appacitive SDK");
var b=new c._Request({method:"GET",type:"ping",op:"getPingUrl",options:f,onSuccess:function(c){return b.promise.fulfill(c.status)}});return b.send()};c.initialize=function(g){g=g||{};if(!c.Session.initialized){g.masterKey&&0<g.masterKey.length&&c.Session.setMasterKey(g.masterKey);if(!g.apikey||0===g.apikey.length)if(g.masterKey)g.apikey=g.masterKey;else throw Error("apikey is mandatory");if(!g.appId||0===g.appId.length)throw Error("appId is mandatory");c.Session.setApiKey(g.apikey);c.Session.environment(g.env||
"sandbox");c.useApiKey=!0;c.appId=g.appId;c.Session.initialized=!0;c.Session.persistUserToken=g.persistUserToken;g.debug&&(c.config.debug=!0);f.isFunction(g.apiLog)&&(c.logs.apiLog=g.apiLog);f.isFunction(g.apiErrorLog)&&(c.logs.apiErrorLog=g.apiErrorLog);f.isFunction(g.exceptionLog)&&(c.logs.exceptionLog=g.exceptionLog);if(g.userToken)if(-1==g.expiry?g.expiry=null:g.expiry||(g.expiry=845E4),c.Session.setUserAuthHeader(g.userToken,g.expiry),g.user)c.Users.setCurrentUser(g.user);else{var b=c.localStorage.get("Appacitive-User");
b&&c.Users.setCurrentUser(b)}else if(c.runtime.isBrowser&&(g=c.localStorage.get("Appacitive-UserToken"))){var e=c.localStorage.get("Appacitive-UserTokenExpiry"),b=c.localStorage.get("Appacitive-UserTokenDate");e||(e=-1);b&&0<e&&new Date(b+1E3*e)<new Date||(-1==e&&(e=null),(b=c.localStorage.get("Appacitive-User"))&&c.Users.setCurrentUser(b,g,e))}}};c.reset=function(){c.Session.reset()}})(global);
(function(l){var c=l.Appacitive;c&&c.http&&(c.http.addProcessor({pre:function(f){var g=c.Session.environment();f.options=f.options||{};_type.isString(f.options.env)&&(g=f.options.env);f.headers.push({key:"e",value:g})}}),c.Events.mixin(c))})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;c.GeoCoord=function(b,d){var h=function(b,c){if(isNaN(b)||isNaN(c))throw Error("Invalid Latitiude or longitiude provided");if(-90>b||90<b)throw Error("Latitude "+b+" should be in range of  -90.0 to 90.");if(-180>c||180<c)throw Error("Latitude "+c+" should be in range of  -180.0 to 180.");},e=function(b){if("string"!==typeof b||0==b.length)return!1;b=b.split(",");if(2!==b.length)return!1;try{return new c.GeoCoord(b[0],b[1])}catch(d){return!1}};if(f.isString(b)&&
!d&&(e=e(b)))return e;b&&d?(h(b,d),this.lat=b,this.lng=d):this.lng=this.lat=0;this.toJSON=function(){return{latitude:this.lat,longitude:this.lng}};this.getValue=function(){return String.format("{0},{1}",b,d)};this.toString=function(){return this.getValue()}};var g=function(){this.toString=function(){};this.Or=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new r(u.or,b)};this.And=function(){var b=Array.prototype.slice.call(arguments,0);b.splice(0,0,this);return new r(u.and,
b)}},b=function(b){g.call(this);b=b||{};this.fieldType=b.fieldType;this.field=b.field||"";this.value=b.value;this.operator=b.operator;this.getFieldType=function(){switch(this.fieldType){case "property":return"*";case "attribute":return"@";case "aggregate":return"$";default:return"*"}};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue())}};b.prototype=new g;b.prototype.constructor=b;var e=function(d){d=d||"";
if(!f.isArray(d.value)||!d.value.length)throw Error("Specify field value as array");b.call(this,d);var h=function(b){return f.isString(b)?"'"+b+"'":f.isNumber(b)?b:f.isDate(b)?"datetime('"+c.Date.toISOString(b)+"')":"'"+b.toString()+"'"};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,h(this.value[c])));return"("+b.join(" or ")+")"}};e.prototype=new b;e.prototype.constructor=e;var k=
function(c){c=c||"";if(!f.isArray(c.value)||!c.value.length)throw Error("Specify field value as array");b.call(this,c);var d=function(b){return f.isString(b)?"'"+b+"'":f.isNumber(b)?b:b.toString()};this.toString=function(){for(var b=[],c=0;c<this.value.length;c+=1)b.push(d(this.value[c]));return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,b.join(","))}};k.prototype=new b;k.prototype.constructor=k;var d=function(c){b.call(this,c||"");this.toString=function(){return String.format("{0}{1} {2}",
this.getFieldType(),this.field.toLowerCase(),this.operator)}};d.prototype=new b;d.prototype.constructor=d;var q=function(c){c=c||"";if(!c.val1)throw Error("Specify field value1 ");if(!c.val2)throw Error("Specify field value2 ");this.val1=c.val1;this.val2=c.val2;b.call(this,c);delete this.value;this.toString=function(){return String.format("{0}{1} {2} ({3},{4})",this.getFieldType(),this.field.toLowerCase(),this.operator,this.val1.getValue(),this.val2.getValue())}};q.prototype=new b;q.prototype.constructor=
q;var h=function(d){d=d||"";if(!(d.geoCoord&&d.geoCoord instanceof c.GeoCoord))throw Error("withinCircle filter needs Appacitive.GeoCoord object as argument");b.call(this,d);this.value=d.geoCoord;this.unit=d.unit||"mi";this.distance=d.distance||5;this.toString=function(){return String.format("{0}{1} {2} {3},{4} {5}",this.getFieldType(),this.field.toLowerCase(),this.operator,this.value.getValue(),this.distance,this.unit)}};h.prototype=new b;h.prototype.constructor=q;var m=function(c){c=c||"";if(!c.geoCoords||
0===c.geoCoords.length)throw Error("polygon filter needs array of Appacitive.GeoCoord objects as argument");if(3>c.geoCoords.length)throw Error("polygon filter needs atleast 3 Appacitive.GeoCoord objects as arguments");b.call(this,c);this.value=c.geoCoords;var d=function(b){var c="";b.forEach(function(b){c=0===c.length?b.toString():c+(" | "+b.toString())});return c};this.toString=function(){return String.format("{0}{1} {2} {3}",this.getFieldType(),this.field.toLowerCase(),this.operator,d(this.value))}};
m.prototype=new b;m.prototype.constructor=q;var v=function(b){g.call(this);b=b||{};if(!b.tags||!f.isArray(b.tags)||0===b.tags.length)throw Error("Specify valid tags");this.tags=b.tags;this.operator=b.operator;this.toString=function(){return String.format("{0}('{1}')",this.operator,this.tags.join(","))}};v.prototype=new g;v.prototype.constructor=v;var r=function(b,c){if(!c||!c.length||2>c.length)throw Error("Provide valid or atleast 2 filters");this.operator=b;this.innerFilters=[];for(var d=0;d<c.length;d+=
1){if(!(c[d]instanceof g))throw Error("Invalid filter provided");this.innerFilters.push(c[d])}this.toString=function(){var b=this.operator,c="(";this.innerFilters.forEach(function(d){c=1===c.length?c+(" "+d.toString()):c+String.format(" {0} {1} ",b,d.toString())});return c+=")"}};r.prototype=new g;r.prototype.constructor=r;var u={isEqualTo:"==",notEqualTo:"<>",isGreaterThan:">",isGreaterThanEqualTo:">=",isLessThan:"<",isLessThanEqualTo:"<=",like:"like",match:"match",between:"between",withinCircle:"within_circle",
withinPolygon:"within_polygon",or:"or",and:"and",taggedWithAll:"tagged_with_all",taggedWithOneOrMore:"tagged_with_one_or_more",isNull:"is null",containedIn:"in",isNotNull:"is not null",notIn:"not in"},t=function(b,d){if(null===b||void 0===b||0===b.length)throw Error("Specify value");this.value=b;this.type=d?d:typeof this.value;if("number"===this.type&&!f.isNumeric(this.value))throw Error("Value should be numeric for filter expression");this.getValue=function(){return"number"===this.type||f.isBoolean(this.value)||
f.isNumber(this.value)?this.value:"object"===this.type&&f.isDate(this.value)?"datetime('"+c.Date.toISOString(this.value)+"')":"object"==this.type&&this.value instanceof c.GeoCoord?this.value.toString():"'"+this.value.toString()+"'"}},B=function(c,f,g){g||(g=this);g.type=c;g.name=f;g.equalTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isEqualTo})};g.notEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.notEqualTo})};
g.greaterThan=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isGreaterThan})};g.greaterThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isGreaterThanEqualTo})};g.lessThan=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isLessThan})};g.lessThanEqualTo=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c),operator:u.isLessThanEqualTo})};g.like=function(c){return new b({field:this.name,
fieldType:this.type,value:new t("*"+c+"*"),operator:u.like})};g.match=function(c){return new b({field:this.name,fieldType:this.type,value:new t("*"+c+"*"),operator:u.match})};g.startsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new t(c+"*"),operator:u.like})};g.endsWith=function(c){return new b({field:this.name,fieldType:this.type,value:new t("*"+c),operator:u.like})};g.contains=function(b){return new e({field:this.name,fieldType:this.type,value:b,operator:u.isEqualTo})};
g.containedIn=function(b){return new k({field:this.name,fieldType:this.type,value:b,operator:u.containedIn})};g.isNull=function(){return new d({field:this.name,fieldType:this.type,operator:u.isNull})};g.notIn=function(b){return new k({field:this.name,fieldType:this.type,value:b,operator:u.notIn})};g.isNotNull=function(){return new d({field:this.name,fieldType:this.type,operator:u.isNotNull})};g.between=function(b,c){return new q({field:this.name,fieldType:this.type,val1:new t(b),val2:new t(c),operator:u.between})};
g.withinCircle=function(b,c,d){return new h({field:this.name,fieldType:this.type,geoCoord:b,distance:c,unit:d,operator:u.withinCircle})};g.withinPolygon=function(b){return new m({field:this.name,fieldType:this.type,geoCoords:b,operator:u.withinPolygon})}},n=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;B("property",b,this);return this},P=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new B("aggregate",b);this.equalTo=function(b){return c.equalTo(b)};
this.notEqualTo=function(b){return c.notEqualTo(b)};this.greaterThan=function(b){return c.greaterThan(b)};this.greaterThanEqualTo=function(b){return c.greaterThanEqualTo(b)};this.lessThan=function(b){return c.lessThan(b)};this.lessThanEqualTo=function(b){return c.lessThanEqualTo(b)};this.between=function(b,d){return c.between(b,d)};this.contains=function(b){return c.contains(b)};return this},O=function(b){if(!b||0===b.length)throw Error("Specify field name");this.field=b;var c=new B("attribute",b);
this.like=function(b){return c.like(b)};this.match=function(b){return c.match(b)};this.startsWith=function(b){return c.startsWith(b)};this.endsWith=function(b){return c.endsWith(b)};this.equalTo=function(b){return c.equalTo(b)};this.notEqualTo=function(b){return c.notEqualTo(b)};this.contains=function(b){return c.contains(b)};this.containedIn=function(b){return c.containedIn(b)};this.notIn=function(b){return c.notIn(b)};this.isNull=function(){return c.isNull()};this.isNotNull=function(){return c.isNull()};
return this};c.Filter={Property:function(b){return new n(b)},Aggregate:function(b){return new P(b)},Attribute:function(b){return new O(b)},Or:function(){return new r(u.or,arguments)},And:function(){return new r(u.and,arguments)},taggedWithOneOrMore:function(b){return new v({tags:b,operator:u.taggedWithOneOrMore})},taggedWithAll:function(b){return new v({tags:b,operator:u.taggedWithAll})}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend;c.Queries={};var b=function(b){b=b||{};this._pageNumber=1;this._pageSize=null;this.isPageDefault=!0;this.pageNumber(b.pageNumber);this.pageSize(b.pageSize)};b.prototype.pageNumber=function(){return 1!=arguments.length||f.isNullOrUndefined(arguments[0])?this._pageNumber:(this._pageNumber=arguments[0]||1,this.isPageDefault=!1,this)};b.prototype.pageSize=function(){return 1!=arguments.length||f.isNullOrUndefined(arguments[0])?this._pageSize:
(this._pageSize=arguments[0],this.isPageDefault=!1,this)};b.prototype.resetPaging=function(){this._pageSize=null;this._pageNumber=1;this.isPageDefault=!0;return this};b.prototype.pageString=function(){return"pnum="+this._pageNumber+(this._pageSize?"&psize="+this._pageSize:"")};var e=function(b){b=b||{};this._isAscending=!1;this._order=[];this.isSortSet=!1;f.isNullOrUndefined(b.isAscending)||this.isAscending(b.isAscending);this.orderBy(b.orderBy);b.ascending&&this.ascending(b.ascending);b.descending&&
this.descending(b.descending)};e.prototype.orderBy=function(){return 1===arguments.length&&f.isString(arguments[0])?(this._order=[{orderBy:arguments[0],isAscending:this._isAscending}],this.isSortSet=!0,this):this._order[0]?this._order[0].orderBy:null};e.prototype.isAscending=function(){if(1===arguments.length){var b=void 0===arguments[0]||null==arguments[0]?!1:arguments[0];this._order.forEach(function(c){c.isAscending=b});this._isAscending=b;this.isSortSet=!0;return this}return 0<this._order.length?
order[0].isAscending:this._isAscending};e.prototype.resetSorting=function(){this._order=[];this.isSortSet=this._isAscending=!1;return this};e.prototype._setSorting=function(b,c){if(1<arguments.length){var h=this;b.forEach(function(b){Array.isArray(b)&&(b=b.join());b.replace(/\s/g,"").split(",").forEach(function(b){var d=h._order.findWhere({orderBy:b.toLowerCase()});d?d.isAscending=c:h._order.push({orderBy:b.toLowerCase(),isAscending:c})})});this.isSortSet=!0}return this};e.prototype.ascending=function(){return this._setSorting(Array.prototype.slice.call(arguments),
!0)};e.prototype.descending=function(){return this._setSorting(Array.prototype.slice.call(arguments),!1)};e.prototype.sortString=function(){return this._order&&0<this._order.length?"orderBy="+this._order.map(function(b){return b.orderBy+" "+(b.isAscending?"asc":"desc")}).join(","):""};l=function(){};l.prototype._setPaging=function(b){b&&(this.pageNumber(b.pagenumber),this.pageSize(b.pagesize),this.results=this.results||[],this.results.isLastPage=!1,this.results.total=b.totalrecords,this.results.pageNumber=
b.pagenumber,this.results.pageSize=b.pagesize,b.pagenumber*b.pagesize>=b.totalrecords&&(this.results.isLastPage=!0))};l.prototype.fields=function(){if(1===arguments.length){var b=arguments[0];f.isString(b)?this._fields=[b]:f.isArray(b)&&b.length&&(this._fields=b);return this}return this._fields};l.prototype._parse=function(b,e,h){b||(b=[]);var f="object"===this.type()?"Object":"Connection";return c[f]._parseResult(b,h.entity,e)};l.prototype.collection=function(b,e){e=e||{};f.isObject(b)&&(e=b,b=null);
b||(b=this.results?this.results:[]);var h=options.entity;!h&&0<b.length&&b[0]instanceof c.BaseObject&&(h="object"==b[0].type?"Object":"Connection",h=c[h]._getClass(b[0].className));h||(h="object"===_etype?"Object":"Connection",h=c[h]._getClass(this[h]));return new c.Collection(b,g(e,{model:h,query:this}))};l.prototype.fetchNext=function(b){var c=this.pageNumber();if(!c||0>=c)c=1;this.pageNumber(++c);return this.fetch(b)};l.prototype.fetchPrev=function(b){var c=this.pageNumber();--c;if(!c||0>=c)c=
1;this.pageNumber(c);return this.fetch(b)};l.prototype.count=function(b){var e=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){b=b||{};b=b.paginginfo;var c=0,c=b?b.totalrecords:0;e.fulfill(c)};b.promise=e;b.entity=this;return c.http.send(b)};var k=function(d){var g=d||{};b.call(this,d);e.call(this,d);var h="",m="",k=g.queryType||"BasicQuery",r=g.type||g.relation,u=g.relation?"connection":"object",t=this;this._fields=[];g.entity&&(this.entity=g.entity);this.type=function(){return u};
this.entityType=function(){return r};this.queryType=function(){return k};this.filter=function(){return 1===arguments.length?(h=arguments[0],this):h};this.freeText=function(){if(1===arguments.length){var b=arguments[0];f.isString(b)?m=arguments[0]:f.isArray(b)&&b.length&&(m=arguments[0].join(" "));return this}return m};this.filter(g.filter||"");this.freeText(g.freeText||"");this.fields(g.fields||[]);this.setFilter=function(b){this.filter(b)};this.setFreeText=function(b){this.freeText(b)};this.setFields=
function(b){this.fields(b)};this.extendOptions=function(c){for(var d in c)g[d]=c[d];b.call(this,g);e.call(this,g);return this};this.getQueryString=function(){var b=this.pageString(),c=this.sortString();c&&(b+="&"+c);this.filter()&&(c=encodeURIComponent(this.filter().toString()),0<c.trim().length&&(b+="&query="+c));this.freeText()&&0<this.freeText().trim().length&&(b+="&freetext="+encodeURIComponent(this.freeText())+"&language=en");this._fields&&0<this._fields.length&&(b+="&fields="+this._fields.join(","));
return b};this.toUrl=function(){return{url:c.config.apiBaseUrl+u+"/"+r+"/find/all?"+this.getQueryString(),description:"FindAll "+r+" "+u+"s"}};this.toRequest=function(b){var d=new c.HttpRequest,h=this.toUrl();d.url=h.url;d.options=b;d.description=h.description;d.method="get";return d};this.getOptions=function(){var b={},c;for(c in this)this.hasOwnProperty(c)&&!f.isFunction(this[c])&&(b[c]=this[c]);return b};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){t.results=
t._parse(b[u+"s"],b.__meta,g);t._setPaging(b.paginginfo);d.fulfill(t.results,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){t.results=t._parse(b[u+"s"],b.__meta,g);t._setPaging(b.paginginfo);d.fulfill(t.results,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)}};g(k.prototype,l.prototype,e.prototype,b.prototype);c.Queries.FindAllQuery=function(b){b=b||{};if(!b.type&&!b.relation)throw Error("Specify either type or relation for basic filter query");
b.queryType="FindAllQuery";k.call(this,b);return this};c.Queries.FindAllQuery.prototype=new k;c.Queries.FindAllQuery.prototype.constructor=c.Queries.FindAllQuery;c.Query=c.Queries.FindAllQuery;c.Queries.ConnectedObjectsQuery=function(b){b=b||{};if(!b.relation)throw Error("Specify relation for connected objects query");if(!b.objectId)throw Error("Specify objectId for connected objects query");if(!b.type)throw Error("Specify type of object id for connected objects query");var e=b.type;delete b.type;
b.queryType="ConnectedObjectsQuery";k.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.type=e;b.object instanceof c.Object&&(this.object=b.object);this.returnEdge=!0;void 0===b.returnEdge||null===b.returnEdge||b.returnEdge||(this.returnEdge=!1);this.label="";var h=this;f.isString(b.label)&&0<b.label.length&&(this.label="&label="+b.label);this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/"+this.type+"/"+this.objectId+"/find?"+this.getQueryString()+
this.label+"&returnEdge="+this.returnEdge,description:"GetConnectedObjects for relation "+this.relation+" of type "+this.type+" for object "+this.objectId}};var m=function(b,d,e,f){var m=[];b.forEach(function(b){var h=b.__edge;delete b.__edge;var k=c.Object._create(g({__meta:e},b),!0);h&&(h.__endpointa=d,h.__endpointb={objectid:b.__id,label:h.__label,type:b.__type},delete h.label,k.connection=c.Connection._create(g({__meta:f},h),!0));m.push(k)});h.object&&(h.object.children[h.relation]=m);return m};
this.fetch=function(f){var g=c.Promise.buildPromise(f);f=this.toRequest(f);f.onSuccess=function(c){h.results=m(c.nodes?c.nodes:[],{objectid:b.objectId,type:e,label:c.parent},c.__nodemeta,c.__edgemeta);h._setPaging(c.paginginfo);g.fulfill(h.results,c.paginginfo)};f.promise=g;f.entity=this;return c.http.send(f)};return this};c.Queries.ConnectedObjectsQuery.prototype=new k;c.Queries.ConnectedObjectsQuery.prototype.constructor=c.Queries.ConnectedObjectsQuery;c.Queries.GetConnectionsQuery=function(b){b=
b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsQuery query");if(!b.objectId)throw Error("Specify objectId for GetConnectionsQuery query");if(!b.label||0===b.label.trim().length)throw Error("Specify label for GetConnectionsQuery query");b.type&&delete b.type;b.queryType="GetConnectionsQuery";k.call(this,b);this.objectId=b.objectId;this.relation=b.relation;this.label=b.label;this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"/find/all?"+this.getQueryString()+
"&objectid="+this.objectId+"&label="+this.label,description:"FindAllConnections for relation "+this.relation+" from object id "+this.objectId}};return this};c.Queries.GetConnectionsQuery.prototype=new k;c.Queries.GetConnectionsQuery.prototype.constructor=c.Queries.GetConnectionsQuery;c.Queries.GetConnectionsBetweenObjectsQuery=function(b,e){b=b||{};delete b.entity;if(!b.objectAId||!f.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for GetConnectionsBetweenObjectsQuery query");
if(!b.objectBId||!f.isString(b.objectBId)||0===b.objectBId.length)throw Error("Specify objectBId for GetConnectionsBetweenObjectsQuery query");b.type&&delete b.type;b.queryType=e||"GetConnectionsBetweenObjectsQuery";k.call(this,b);this.objectAId=b.objectAId;this.objectBId=b.objectBId;this.label="GetConnectionsBetweenObjectsForRelationQuery"===this.queryType()&&b.label&&f.isString(b.label)&&0<b.label.length?"&label="+b.label:"";this.relation=b.relation&&f.isString(b.relation)&&0<b.relation.length?
b.relation+"/":"";this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/"+this.relation+"find/"+this.objectAId+"/"+this.objectBId+"?"+this.getQueryString()+this.label,description:"FindConnectionBetween for relation "+this.relation+" between object ids "+this.objectAId+" and "+this.objectBId}};return this};c.Queries.GetConnectionsBetweenObjectsQuery.prototype=new k;c.Queries.GetConnectionsBetweenObjectsQuery.prototype.constructor=c.Queries.GetConnectionsBetweenObjectsQuery;c.Queries.GetConnectionsBetweenObjectsForRelationQuery=
function(b){b=b||{};if(!b.relation)throw Error("Specify relation for GetConnectionsBetweenObjectsForRelationQuery query");var e=new c.Queries.GetConnectionsBetweenObjectsQuery(b,"GetConnectionsBetweenObjectsForRelationQuery");e.fetch=function(h){var f=c.Promise.buildPromise(h);h=this.toRequest(h);h.onSuccess=function(h){e.results=h.connection?[c.Connection._create(g({__meta:h.__meta},h.connection),!0,b.entity)]:null;f.fulfill(e.results?e.results[0]:null)};h.promise=f;h.entity=this;return c.http.send(h)};
return e};c.Queries.InterconnectsQuery=function(b){b=b||{};delete b.entity;if(!b.objectAId||!f.isString(b.objectAId)||0===b.objectAId.length)throw Error("Specify valid objectAId for InterconnectsQuery query");if(!(b.objectBIds&&f.isArray(b.objectBIds)&&0<b.objectBIds.length))throw Error("Specify list of objectBIds for InterconnectsQuery query");b.type&&delete b.type;b.queryType="InterconnectsQuery";k.call(this,b);this.objectAId=b.objectAId;this.objectBIds=b.objectBIds;this.toRequest=function(b){var d=
new c.HttpRequest,e=this.toUrl();d.url=e.url;d.options=b;d.description=e.description;d.method="post";d.data={object1id:this.objectAId,object2ids:this.objectBIds};return d};this.toUrl=function(){return{url:c.config.apiBaseUrl+"connection/interconnects?"+this.getQueryString(),description:"GetInterConnections between objects"}};return this};c.Queries.InterconnectsQuery.prototype=new k;c.Queries.InterconnectsQuery.prototype.constructor=c.Queries.InterconnectsQuery;c.Queries.GraphQuery=function(d,g,h){f.isObject(d)&&
(h=d,h.returnObjects=d.returnObjects||h.returnObjects,g=d.placeholders||{},d=h.name);if(!d||0===d.length)throw Error("Specify name of filter query");h=h||{};this.returnObjects=h.returnObjects;b.call(this,h);e.call(this,h);this.name=d;this.data={};this.queryType="GraphQuery";this.fields(h.fields||[]);var m=this;if(g){this.data.placeholders=g;for(var k in this.data.placeholders)this.data.placeholders[k]=this.data.placeholders[k]}this.type=function(){return"object"};this.toRequest=function(b){var d=
new c.HttpRequest,h=this.toUrl();d.url=h.url;d.options=b;d.description=h.description;d.method="post";d.data=this.data;return d};this.getQueryString=function(){var b=[];this.isPageDefault||b.push(this.pageString());this.isSortSet&&b.push(this.sortString());this._fields&&0<this._fields.length&&b.push("fields="+this._fields.join(","));return b.join("&")};this.toUrl=function(){return{url:c.config.apiBaseUrl+"search/"+this.name+"/"+(this.returnObjects?"graphquery":"filter")+"?"+this.getQueryString(),description:"Filter Query with name "+
this.name}};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){var c;m.returnObjects?(m.results=m._parse(b.objects,b.__meta,h),c=m.results):this.results=c=b.ids?b.ids:[];b.paginginfo&&m._setPaging(b.paginginfo);d.fulfill(c,b.paginginfo)};b.promise=d;b.entity=this;return c.http.send(b)}};g(c.Queries.GraphQuery.prototype,l.prototype,e.prototype,b.prototype);c.Queries.GraphAPI=function(b,e,h){if(!b||0===b.length)throw Error("Specify name of project query");
if(!e||!e.length)throw Error("Specify ids to project");this.name=b;this.data={ids:e};this.queryType="GraphApi";var m=this;if(h){this.data.placeholders=h;for(var k in this.data.placeholders)this.data.placeholders[k]=this.data.placeholders[k]}this.toRequest=function(b){var d=new c.HttpRequest,h=this.toUrl();d.url=h.url;d.description=h.description;d.method="post";d.data=this.data;d.options=b;return d};this.toUrl=function(){return{url:c.config.apiBaseUrl+"search/"+this.name+"/project",description:"Project Query with name "+
this.name}};var r=function(b){var d,h;for(h in b)if("status"!==h){d=b[h];break}var e=function(b,d,h,f,m){var r=[];b.forEach(function(b){var t=b.__children;delete b.__children;var k=b.__edge;delete b.__edge;b=c.Object._create(g({__meta:f},b),!0);b.children={};for(var u in t)b.children[u]=[],b.children[u]=e(t[u].values,t[u].parent,b.id,t[u].__nodemeta,t[u].__edgemeta);k&&(k.__endpointa={objectid:h,label:d},k.__endpointb={objectid:b.id,label:k.__label},delete k.__label,b.connection=c.Connection._create(g({__meta:m},
k),!0));r.push(b)});return r};return e(d.values,null,null,d.__nodemeta)};this.collection=function(b,d){d=d||{};f.isObject(b)&&(d=b,b=null);b||(b=this.results?ths.results:[]);var h;0<b.length&&b[0]instanceof c.BaseObject&&(h=c.Object._getClass(b[0].className));return new c.Collection(b,g(d,{model:h,query:this}))};this.fetch=function(b){var d=c.Promise.buildPromise(b);b=this.toRequest(b);b.onSuccess=function(b){m.results=r(b);d.fulfill(m.results)};b.promise=d;b.entity=this;return c.http.send(b)}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend,b=c.utils._deepExtend,e=["__link","__endpointa","__endpointb"],k={__utcdatecreated:"datetime",__utclastupdateddate:"datetime"},d=function(b){return f.isString(b)||f.isNumber(b)||f.isBoolean(b)},q=function(b){return d(b)||f.isDate(b)||b instanceof c.GeoCoord},h=function(b){b=b||{};var c={},d;for(d in b.__meta)b.__meta[d].forEach(function(b){c[b]=d});return c},m={integer:function(b){if(b){var c=parseInt(b);if(!isNaN(c))return c}return b},
decimal:function(b){if(b){var c=parseFloat(b);if(!isNaN(c))return c}return b},"boolean":function(b){return f.isBoolean(b)?b:void 0!==b&&null!==b&&("true"===b.toString().toLowerCase()||!0===b||0<b)?!0:!1},date:function(b){if(f.isDate(b))return b;if(b){var d=c.Date.parseISODate(b);if(d)return d}return b},datetime:function(b){if(f.isDate(b))return b;if(b){var d=c.Date.parseISODate(b);if(d)return d}return b},time:function(b){if(f.isDate(b))return b;if(b){var d=c.Date.parseISOTime(b);if(d)return d}return b},
string:function(b){return b?b.toString():b},geocode:function(b){if(b instanceof c.GeoCoord)return b;if(!f.isString(b)||0==b.trim().length)return!1;b=b.split(",");return 2!==b.length?!1:new c.GeoCoord(b[0],b[1])}};m["long"]=m.integer;m.geography=m.geocode;m.text=m.string;m.bool=m["boolean"];c.cast=m;var v=function(b){return f.isNullOrUndefined(b)?null:d(b)?b+"":f.isDate(b)?c.Date.toISOString(b):f.isObject(b)?b instanceof c.GeoCoord?b.toString():b.getObject?b.getObject():b:b};c._encode=function(b){var c=
{},d;for(d in b){var h=b[d];f.isArray(h)?(c[d]=[],h.forEach(function(b){(b=v(b))&&c[d].push(b)})):c[d]=v(b[d])}return c};c._decode=function(b){var c={},d=g({},k,h(b));delete b.__meta;for(var e in b)f.isArray(b[e])?(c[e]=[],b[e].forEach(function(b){b=d[e]?m[d[e]](b):b;c[e].push(b)})):f.isString(b[e])?c[e]=d[e]?m[d[e]](b[e]):b[e]:c[e]=b[e];return c};l=function(d,h){var t={};h=h||{};d=d||{};d=b({},d);this.meta={};d.__meta=g(this.meta,d.__meta);h&&h.parse&&(d=this.parse(d));var k=c.utils._result(this,
"defaults");f.isObject(this.defaults)&&!h.setSnapShot&&(d=b({},k,d));h&&h.collection&&(this.collection=h.collection);d=c._decode(d);var n=this,v=function(d,h){d.__meta=g(n.meta,d.__meta);n.meta=d.__meta;l(d);var e=c._decode(d),m;for(m in e)m==n.idAttribute&&(n.id=e[m]),w[m]&&delete w[m],A[m]&&delete A[m],z[m]&&delete z[m],q(e[m])?h[m]=e[m]:f.isObject(e[m])?h[m]=b({},h[m],e[m]):f.isArray(e[m])?(h[m]=[],e[m].forEach(function(b){if(q(b)||"__link"==m)h[m].push(b);else throw Error("Multivalued property cannot add object or array as property of object");
})):h[m]=e[m]},l=function(b,d){var h={id:"id",__id:"id",__utclastupdateddate:"lastUpdatedAt",__utcdatecreated:"createdAt",__createdby:"createdBy",__updatedby:"lastUpdatedBy"};"id __id __utclastupdateddate __utcdatecreated __createdby __updatedby".split(" ").forEach(function(e){b[e]&&("__utcdatecreated"!==e&&"__utclastupdateddate"!==e||f.isDate(b[e])?n[h[e]]=b[e]:n[h[e]]=c.Date.parseISODate(b[e]),d&&delete b[e])})};this.base=c.Object.prototype;this.cid=parseInt(1E8*Math.random(),10);this.idAttribute=
"__id";var w={},A={},z={},x={};v(d,x);var p=x;h.setSnapShot&&v(p,t);!t[this.idAttribute]&&x[this.idAttribute]&&(t[this.idAttribute]=x[this.idAttribute]);this.id=t[this.idAttribute];x.__type?(x.__type=x.__type.toLowerCase(),this.entityType="type",this.type="object",this.className=x.__type):x.__relationtype&&(x.__relationtype=x.__relationtype.toLowerCase(),this.entityType="relation",this.type="connection",this.className=x.__relationtype);p.__attributes||(p.__attributes={});t.__attributes||(t.__attributes=
{});var y=[];p.__tags||(p.__tags=[]);t.__tags||(t.__tags=[]);this.attributes=p;var D="";l(this.attributes);var G="__id __revision __endpointa __endpointb __createdby __lastmodifiedby __type __relationtype __typeid __relationid __utcdatecreated __utclastupdateddate __tags __authType __link __acls __meta".split(" "),H=function(b){b=b||{};b.message=b.message||"Server error";b.code=b.code||"500";return b};this.getObject=function(){var d=c._encode(b({__meta:this.meta},p));"connection"==n.type&&(d.__endpointa=
p.__endpointa.toJSON(),d.__endpointb=p.__endpointb.toJSON());Object.prototype.hasOwnProperty("id")&&(d.__id=this.id);return d};var Q=function(){var c=b({__meta:this.meta},p);"connection"==n.type&&(p.__endpointa=p.__endpointa.toJSON(),p.__endpointb=p.__endpointb.toJSON());this.hasOwnProperty("id")&&this.id&&(c.__id=this.id);return c};this.toJSON=function(b){if(b&&"object"==this.type){var c=function(b){var d=[];b.forEach(function(b){var h=b.toJSON();if(b.children&&!Object.isEmpty(b.children)){h.children=
{};for(var e in b.children)f.isArray(b.children[e])?h[e]=c(b.children[e]):h[e]=c([b.children[e]])[0],h.children[e]=h[e]}b.connection&&(h.__connection=b.connection.toJSON());d.push(h)});return d};return c([this])[0]}return Q.apply(this)};this.properties=function(){var c=b({},this.attributes);delete c.__attributes;delete c.__tags;return c};this.attr=function(){if(0===arguments.length)return p.__attributes||(p.__attributes={}),p.__attributes;if(1===arguments.length)return p.__attributes||(p.__attributes=
{}),p.__attributes[arguments[0]];if(2===arguments.length){if(!f.isString(arguments[1])&&null!==arguments[1])throw Error("only string values can be stored in attributes.");p.__attributes||(p.__attributes={});p.__attributes[arguments[0]]=arguments[1]}else throw Error(".attr() called with an incorrect number of arguments. 0, 1, 2 are supported.");C("__attributes");return p.__attributes};var I=function(){if(p.__attributes){if(!t.__attributes)return p.__attributes;var b=!1,c=JSON.parse(JSON.stringify(t.__attributes)),
d;for(d in p.__attributes)null==p.__attributes[d]||void 0==p.__attributes[d]?(c[d]=null,b=!0):p.__attributes[d]!=t.__attributes[d]?(c[d]=p.__attributes[d],b=!0):p.__attributes[d]==t.__attributes[d]&&delete c[d];return b?c:void 0}};this.getChangedAttributes=I;this.aggregate=function(){var b={},c;for(c in p){if(!p.hasOwnProperty(c))return;"$"==c[0]&&(b[c.substring(1)]=p[c])}if(0===arguments.length)return b;if(1==arguments.length)return b[arguments[0]];throw Error(".aggregates() called with an incorrect number of arguments. 0, and 1 are supported.");
};this.tags=function(){return p.__tags?p.__tags:[]};this.addTag=function(b){if(!b||!f.isString(b)||!b.length)return this;p.__tags||(p.__tags=[]);p.__tags.push(b);p.__tags=Array.distinct(p.__tags);if(!y||!y.length)return C("__tags"),this;b=y.indexOf(b);-1!=b&&y.splice(b,1);C("__tags");return this};this.removeTag=function(b){if(!b||!f.isString(b)||!b.length)return this;y.push(b);y=Array.distinct(y);if(!p.__tags||!p.__tags.length)return C("__tags"),this;b=p.__tags.indexOf(b);-1!=b&&p.__tags.splice(b,
1);C("__tags");return this};var J=function(){if(p.__tags){if(!t.__tags)return p.__tags;var b=[];p.__tags.forEach(function(c){-1==t.__tags.indexOf(c)&&b.push(c)});return 0<b.length?b:void 0}};this.getChangedTags=J;this.getRemovedTags=function(){return _removetags};var K=function(b,c,d,h){if(!b||!f.isString(b)||0===b.length||0==b.trim().indexOf("__")||0===b.trim().indexOf("$")||void 0==c||null==c)return this;b=b.toLowerCase();try{var e=function(c){if(!q(c))throw Error("Multivalued property cannot have values of property as an object");
if(p[b]&&f.isArray(p[b]))if("additems"==d)p[b].push(c);else if("adduniqueitems"==d){var h=-1;p[b].find(function(b,d){return f.isEqual(b,c)?(h=d,!0):!1});-1==h&&p[b].push(c)}else"removeitems"==d&&p[b].removeAll(c);else p[b]="removeitems"==d?[]:[c];A[b]||(A[b]={additems:[],adduniqueitems:[],removeitems:[]});A[b][d].push(c)};f.isArray(c)?c.forEach(function(b){e(b)}):e(c);C(b,h)}catch(g){throw Error("Unable to add item to "+b);}return n};this.add=function(b,c,d){return K.apply(this,[b,c,"additems",d])};
this.addUnique=function(b,c,d){return K.apply(this,[b,c,"adduniqueitems",d])};this.remove=function(b,c,d){return K.apply(this,[b,c,"removeitems",d])};var E=function(b,c,d,h){var e=void 0;f.isEqual(d,c)||("__tags"==b?(b=J())&&0<b.length&&(e=b):"__attributes"==b?(b=I(),Object.isEmpty(b)||(e=b)):f.isArray(d)?A[b]&&!z[b]?e=h?A[b]:d:d.equals(c)||(e=d):e=w[b]&&!z[b]?h?{incrementby:w[b].value}:d:d);return e},F=function(d){var h=!1,e=b({},t),f;for(f in e)"$"==f[0]&&delete e[f];for(var g in p)f=E(g,e[g],p[g],
d),void 0===f?delete e[g]:(h=!0,e[g]=f);try{G.forEach(function(b){e[b]&&delete e[b]})}catch(m){}d&&(e=c._encode(e));g=J();d?(g&&0<g.length&&(e.__addtags=g,h=!0),y&&0<y.length&&(e.__removetags=y,h=!0)):g&&0<g.length&&(e.__tags=g,h=!0);(d=I())&&!Object.isEmpty(d)?(e.__attributes=d,h=!0):delete e.__attributes;"object"==n.type&&n._aclFactory&&(d=n._aclFactory.getChanged())&&(h=!0,e.__acls=d);return h&&!Object.isEmpty(e)?e:!1};this.changed=function(){return this.isNew()?this.toJSON():F()};this.hasChanged=
function(){return this.isNew()?!0:0===arguments.length?Object.isEmpty(F(!0))?!1:!0:1==arguments.length&&f.isString(arguments[0])&&0<arguments[0].length?void 0==E(arguments[0],t[arguments[0]],p[arguments[0]])?!1:!0:!1};this.changedAttributes=function(){if(this.isNew())return this.toJSON();if(0===arguments.length)return F();if(1==arguments.length&&f.isArray(arguments[0])&&arguments[0].length){var b={};arguments[0].forEach(function(c){c=E(c,t[c],p[c]);void 0!=c&&b.push(c)});return b}return!1};this.previous=
function(){return this.isNew()?null:1==arguments.length&&f.isString(arguments[0])&&arguments[0].length?t[arguments[0]]:null};this.previousAttributes=function(){return this.isNew()?null:g({},t)};this.fields=function(){if(1==arguments.length){var b=arguments[0];f.isString(b)?D=b:f.isArray(b)&&(D=b.join(","));return this}return D};this.get=function(b,c){if(b){if(c&&m[c.toLowerCase()]){if(m[c.toLowerCase()])return m[c.toLowerCase()](p[b]);throw Error('Invalid cast-type "'+c+'"" provided for get "'+b+
'"');}return p[b]}};this.tryGet=function(b,c,d){b=this.get(b,d);return void 0!==b?b:c};var C=function(b,c){if(c&&!c.silent){var d=E(b,t[b],p[b]);if(void 0!=d[b]||-1!=G.indexOf(b))n.trigger("change:"+b,n,d[b]||p[b],{}),c.ignoreChange||n.trigger("change",n,c)}},L=function(b){b&&!b.silent&&n.trigger("destroy",n,n.collection,b)};this._triggerError=function(b,c){b.silent||n.trigger("error",n,c,b)};var R=function(b,c,d){if(!b||!f.isString(b)||0===b.length||0===b.trim().indexOf("$"))return this;b=b.toLowerCase();
try{if(f.isNullOrUndefined(c))p[b]=null;else if(q(c))p[b]=c;else if(f.isObject(c))if(-1!==e.indexOf(b))p[b]=c;else throw Error("Property cannot have value as an object");else f.isArray(c)&&(p[b]=[],c.forEach(function(c){if(q(c))p[b].push(c);else throw Error("Multivalued property cannot have values of property as an object");}));delete w[b];delete A[b];delete z[b];f.isEqual(p[b],t[b])||(z[b]=!0);b==n.idAttribute&&(n.id=c);return this}catch(h){throw Error("Unable to set "+b);}};this.set=function(b,
c,d){var h,e;if(null==b)return this;null==b||"object"===typeof b?(e=b,d=c):(e={})[b]=c;d||(d={});if(!this._validate(e,d))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);l(e);var f=!1;for(h in e)c=e[h],R.apply(this,[h,c,g({},d,{ignoreChange:!0})]);if(d&&!d.silent)for(h in e)if(void 0!=E(h,t[h],p[h])||-1!=G.indexOf(h))f=!0,n.trigger("change:"+b,n,p[b],{});f&&this.trigger("change",this,d);return this};this.unset=function(b,c){if(!b||!f.isString(b)||0===b.length||0===b.indexOf("__"))return this;
b=b.toLowerCase();delete p[b];C(b,c);return this};this._validate=function(b,c){if(!c.validate||!this.validate||!f.isFunction(this.validate))return!0;b=g({},this.attributes,b);var d=this.validationError=this.validate(b,c)||null;if(!d)return!0;this.trigger("invalid",this,d,g(c,{validationError:d}));return!1};this.isValid=function(b){return this._validate({},g(b||{},{validate:!0}))};this.has=function(b){return b&&f.isString(b)&&0!==b.length?p[b]&&!f.isUndefined(p[b])?!0:!1:!1};this.isNew=function(){return!(!f.isNullOrUndefined(this.id)||
this.has(this.idAttribute))};this.clone=function(){return"object"==this.type?c.Object._create(b({__meta:this.meta},this.getObject())):new c.connection._create(b({__meta:this.meta},this.getObject()))};this.copy=function(b,c){b&&(v(b,p),c&&v(b,t));return this};this.mergeWithPrevious=function(){v(p,t);n._aclFactory&&n._aclFactory.merge();l(t);y=[];w={};A={};z={};return this};var M=function(){v(t,p);n._aclFactory&&n._aclFactory.merge();l(p);y=[];w={};A={};z={}};this.rollback=function(){p=x={};M();return this};
var N=function(b,c,d,h){if(!b||!f.isString(b)||0===b.length||0===b.indexOf("__"))return this;b=b.toLowerCase();if(f.isObject(p[b])||f.isArray(p[b]))throw Error("Cannot increment/decrement array/object");try{f.isObject(c)?(h=c,c=d):c=!c||isNaN(Number(c))?d:Number(c)*d,p[b]=isNaN(Number(p[b]))?c:Number(p[b])+c,n.isNew()||(w[b]={value:(w[b]?w[b].value:0)+c})}catch(e){throw Error("Cannot perform increment/decrement operation");}C(b,h);return n};this.increment=function(b,c,d){return N(b,c,1,d)};this.decrement=
function(b,c,d){return N(b,c,-1,d)};this._findUnsavedChanges=function(){var b={object:null,isNested:!1};if(this.id)b.object=F(!0);else{var c=n.getObject();delete c.__meta;for(var d in c)"$"==d[0]&&delete c[d];c.__revision&&delete c.__revision;"object"==n.type&&n._aclFactory&&(d=n._aclFactory.getChanged())&&(c.__acls=d);c.__tags&&0==c.__tags.length&&delete c.__tags;Object.isEmpty(c.__attributes)&&delete c.__attributes;"connection"==n.type&&(c.__endpointa.objectid&&delete c.__endpointa.object,c.__endpointb.objectid&&
delete c.__endpointb.object);b.object=c}return b};this.getType=function(){var b=n.type;!p.__type||"user"!=p.__type.toLowerCase()&&"device"!=p.__type.toLowerCase()||(b=p.__type.toLowerCase());return b};this._parseOutput=function(b,d){var h=n.getType(),e;b=b||{};if(d&&d[h]){b&&b.parse&&(d[h]=this.parse(d[h]));var f=this.isNew(),m=!1;"connection"==n.type&&p.__endpointa&&d[h].__endpointa.label!=p.__endpointa.label&&(m=d[h].__endpointa,d[h].__endpointa=d[h].__endpointb,d[h].__endpointb=m,m=!0);t=c._decode(g({__meta:g(n.meta,
d.__meta)},d[h]));n.id=p[n.idAttribute]=d[h][n.idAttribute];M();f?("connection"==n.type&&(b._batch||(m?(p.__endpointa.object&&d.__bmeta&&(p.__endpointa.object.__meta=d.__bmeta),p.__endpointb.object&&d.__ameta&&(p.__endpointb.object.__meta=d.__ameta)):(p.__endpointa.object&&d.__ameta&&(p.__endpointa.object.__meta=d.__ameta),p.__endpointb.object&&d.__bmeta&&(p.__endpointb.object.__meta=d.__bmeta))),n.parseConnection(b._batch)),n.trigger("change:__id",n,n.id,{}),c.eventManager.fire(n.entityType+"."+
h+".created",n,{object:n}),n.created=!0):c.eventManager.fire(n.entityType+"."+h+"."+n.id+".updated",n,{object:n});b.silent||n.trigger("sync",n,d[h],b)}else d=d||{},d.status=d.status||{},e=H(d.status),n._triggerError(b,new c.Error(e)),n.isNew()?c.eventManager.fire(n.entityType+"."+h+".createFailed",n,{error:e}):c.eventManager.fire(n.entityType+"."+h+"."+n.id+".updateFailed",n,{object:e});return e};this._save=function(){return this.id?S.apply(this,arguments):T.apply(this,arguments)};var T=function(b){b=
b||{};var d=n.getType(),h=n._findUnsavedChanges(),e=new c._Request({method:"PUT",type:d,op:"getCreateUrl",args:[this.className,D],data:h.object,options:b,entity:n,onSuccess:function(c){(c=n._parseOutput(b,c))?e.promise.reject(c,n):e.promise.fulfill(n)}});return e.send()},S=function(b,d){c.Promise.is(d)||(d=c.Promise.buildPromise(b));var h=n._findUnsavedChanges();b=b||{};if(Object.isEmpty(h.object))d.fulfill(n);else{var e=n.type,f=[n.className,n.id,D];p&&p.__type&&("user"==p.__type.toLowerCase()||
"device"==p.__type.toLowerCase())&&(e=p.__type.toLowerCase(),f.splice(0,1));var g=new c._Request({method:"POST",type:e,op:"getUpdateUrl",args:f,data:h.object,options:b,entity:n,onSuccess:function(c){(c=n._parseOutput(b,c))?g.promise.reject(c,n):g.promise.fulfill(n)}});return g.send()}return d},U=function(b){if(!n.id)throw Error("Please specify id for get operation");b=b||{};var d=n.getType(),h=new c._Request({method:"GET",type:d,op:"getGetUrl",args:[this.className,n.id,D],options:b,entity:n,onSuccess:function(e){e&&
e[d]?(b&&b.parse&&(e[d]=n.parse(e[d])),t=c._decode(g({__meta:g(n.meta,e.__meta)},e[d])),v(t,p),l(p),n._aclFactory&&n._aclFactory._rollback(),e.connection&&(n.endpoints||n.endpointA&&n.endpointB||n.setupConnection(p.__endpointa,p.__endpointb)),b.silent||n.trigger("sync",n,e[d],b),c.eventManager.fire(n.entityType+"."+d+"."+n.id+".fetched",n,{object:n}),h.promise.fulfill(n)):(e=e||{},e.status=e.status||{},e.status=H(e.status),n._triggerError(b,new c.Error(e.status)),h.promise.reject(e.status,n))}});
return h.send()};this._fetch=function(b){return U.apply(this,[b])};this.del=this._destroy=function(b){b=b||{};var d=b.deleteConnections;f.isBoolean(b)&&(d=b,b={});b.wait||L(b);if(!n.id)return(new c.Promise.buildPromise(b)).fulfill();var h=n.getType(),e=new c._Request({method:"DELETE",type:h,op:"getDeleteUrl",args:[this.className,n.id,d],options:b,entity:this,onSuccess:function(d){d&&d.status?(p={},t={},b.wait&&L(b),e.promise.fulfill(d.status)):(d=d||{},d.status=d.status||{},d.status=H(d.status),n._triggerError(b,
new c.Error(d.status)),e.promise.reject(d.status,n))}});return e.send()};"object"==this.type&&(this._destroyWithConnections=function(b){return this.destroy(g({deleteConnections:!0},b))})};l.prototype.save=function(){return this._save.apply(this,arguments)};l.prototype.fetch=function(){return this._fetch.apply(this,arguments)};l.prototype.destroy=function(){return this._destroy.apply(this,arguments)};l.prototype.destroyWithConnections=function(){return this._destroyWithConnections.apply(this,arguments)};
c.BaseObject=l;c.BaseObject._saveAll=function(b,d,h){var e=new c.Batch;d=d||{};if(!f.isArray(b))throw Error("Provide an array of objects for Object.saveAll");b.forEach(function(b){b instanceof c.BaseObject||!f.isObject(b)||(b=new c[this.className||h](b));e.add(b)});return e.execute(d)};c.BaseObject.prototype.toString=function(){return JSON.stringify(this.getObject())};c.BaseObject.prototype.parse=function(b,c){return b};c.BaseObject.prototype.escape=function(b){return _.escape(this.get(b))};c.Events.mixin(c.BaseObject.prototype)})(global);
(function(l){var c=function(){return Math.floor(65536*Math.random()).toString(16)};l.Appacitive.GUID=function(){var f=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c(),g="",b,e,k,d,q,h,m=0,f=f.replace(/\r\n/g,"\n");e="";for(k=0;k<f.length;k++)d=f.charCodeAt(k),128>d?e+=String.fromCharCode(d):(127<d&&2048>d?e+=String.fromCharCode(d>>6|192):(e+=String.fromCharCode(d>>12|224),e+=String.fromCharCode(d>>6&63|128)),e+=String.fromCharCode(d&63|128));for(f=e;m<f.length;)b=f.charCodeAt(m++),e=f.charCodeAt(m++),
k=f.charCodeAt(m++),d=b>>2,b=(b&3)<<4|e>>4,q=(e&15)<<2|k>>6,h=k&63,isNaN(e)?q=h=64:isNaN(k)&&(h=64),g=g+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);return g.toString()}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=["allow","deny"],b=["create","read","update","delete","manageaccess"],e=function(c){var d=[];c.forEach(function(c){f.isString(c)&&-1!=b.indexOf(c.toLowerCase())&&d.push(c.toLowerCase())});return d};c._Acl=function(k,d){var q=k||[];f.isArray(q)||(q=[]);var h={};d&&(h=JSON.parse(JSON.stringify(q)));this.acls=q=JSON.parse(JSON.stringify(q));var m=[],v=function(b,d,h,f){if(!h)throw Error("Specify valid user or usergroup");h instanceof c.Object&&"user"==
h.typeName&&!h.isNew()&&(h=h.id);var k=q.filter(function(b){return b.sid==h&&b.type==d});k&&0!=k.length?k=k[0]:(k={sid:h,type:d,deny:[],allow:[]},q.push(k));k.allow||(k.allow=[]);k.deny||(k.deny=[]);f=e(f);var r=m.filter(function(b){return b.sid==h&&b.type==d});r&&0!=r.length?r=r[0]:(r={sid:h,type:d},m.push(r));f.forEach(function(c){for(var d=0;d<g.length;d+=1){var h=k[g[d]].indexOf(c);if(-1!=h){k[g[d]].splice(h,1);break}}"dontcare"!=b&&k[b].push(c);r[c]=b});return this},r=function(b,c,d,h){if(!d)throw Error("Please provide valid id or name for setting acls");
if(!h)throw Error("Please provide valid access permissions for setting acls");f.isArray(h)||(h=[h]);f.isArray(d)?d.forEach(function(d){v(b,c,d,h)}):v(b,c,d,h);return this},l=function(){q.allowUser=function(b,c){return r.apply(this,["allow","user",b,c])};q.allowGroup=function(b,c){return r.apply(this,["allow","usergroup",b,c])};q.denyUser=function(b,c){return r.apply(this,["deny","user",b,c])};q.denyGroup=function(b,c){return r.apply(this,["deny","usergroup",b,c])};q.resetUser=function(b,c){return r.apply(this,
["dontcare","user",b,c])};q.resetGroup=function(b,c){return r.apply(this,["dontcare","usergroup",b,c])};q.allowAnonymous=function(b){return r.apply(this,["allow","usergroup",["anonymous"],b])};q.denyAnonymous=function(b){return r.apply(this,["deny","usergroup",["anonymous"],b])};q.resetAnonymous=function(b){return r.apply(this,["dontcare","usergroup",["anonymous"],b])};q.allowLoggedIn=function(b){return r.apply(this,["allow","usergroup",["anonymous"],b])};q.denyLoggedIn=function(b){return r.apply(this,
["deny","usergroup",["anonymous"],b])};q.resetLoggedIn=function(b){return r.apply(this,["dontcare","usergroup",["anonymous"],b])}};this._rollback=function(){m=[];q=JSON.parse(JSON.stringify(h));l();return this};this.toJSON=this.getChanged=function(){var c=[];m.forEach(function(d){var h={sid:d.sid,type:d.type,allow:[],deny:[],dontcare:[]};b.forEach(function(b){d[b]&&h[d[b]].push(b)});g.forEach(function(b){0==h[b].length&&delete h[b]});0==h.dontcare.length&&delete h.dontcare;c.push(h)});return 0==c.length?
null:c};this.merge=function(){m=[];return this};l();return this};c.Group=new function(){var b=function(b,e,h,g){if(!e||!f.isString(e)||0===e.length)throw Error("Please specify valid groupname");f.isArray(h)||(h=[h]);var k={};k[b]=[];h.forEach(function(h){h&&(h instanceof c.Object&&"user"==h.typeName&&!h.isNew()?k[b].push(h.id):f.isString(h)&&k[b].push(h))});if(0==k[b].length)throw Error("Please specify valid members as second argument");var r=new c._Request({method:"POST",type:"usergroup",op:"getUpdateUrl",
args:[e],data:k,entity:this,options:g,onSuccess:function(b){r.promise.fulfill(b)}});return r.send()};this.addMembers=function(c,e,h){return b("add",c,e)};this.removeMembers=function(c,e,h){return b("remove",c,e)}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend;c.Object=function(b,e){b=b||{};e=e||{};this.className&&(b.__type=this.className);f.isString(b)&&(b={__type:b});if(!b.__type)throw Error("Cannot set object without __type");f.isBoolean(e)&&(e={setSnapShot:!0});c.BaseObject.call(this,b,e);this.type="object";this.getObject=this.getObject;this.children={};this.typeName=b.__type;this._aclFactory=new c._Acl(e.__acls,e.setSnapShot);this.acls=this._aclFactory.acls;f.isFunction(this.initialize)&&
this.initialize.apply(this,[b]);return this};c.Object.prototype=new c.BaseObject;c.Object.prototype.constructor=c.Object;c.Object.extend=function(d,e,h){f.isObject(d)&&(h=e,e=d,d=e.typeName);if(!f.isString(d)||0==d.length)throw Error("Appacitive.Object.extend's first argument should be the type-name.");var g=null;e=e||{};e.className=d;g=c.utils.classExtend(c.Object,e,h);delete g.extend;g.className=d;g.type=d;return b[d]=g};var b={},e=function(d){if(!f.isString(d))throw"_getClass requires a string argument.";
var e=b[d];e||(e=c.Object.extend(d),b[d]=e);return e};c.Object._getClass=e;c.Object._create=function(b,c,h){return(new (this.className?this:h?h:e(b.__type))(b)).copy(b,c)};var k=function(b,e,h){var f=[];b.forEach(function(b){b=c.Object._create(g(b,{__meta:h}),!0,e);f.push(b)});return f};c.Object._parseResult=k;c.Object.multiDelete=function(b,e){b=b||{};e=e||{};var h=[];this.className&&(b.type=this.className);f.isArray(b)&&0<b.length&&(b[0]instanceof c.Object?(h=b,b={type:h[0].className,ids:h.map(function(b){return b.id}).filter(function(b){return b})}):
b={type:this.className,ids:b});if(!b.type||!f.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if("user"===b.type.toLowerCase()||"device"===b.type.toLowerCase())throw Error("Cannot delete user and devices using multidelete");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var g=new c._Request({method:"POST",data:{idlist:b.ids},type:"object",op:"getMultiDeleteUrl",args:[b.type],options:e,onSuccess:function(b){e&&!e.silent&&h.forEach(function(b){b.trigger("destroy",
b,b.collection,e)});g.promise.fulfill()}});return g.send()};c.Object.multiGet=function(b,e){b=b||{};e=e||{};f.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Object?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type||!f.isString(b.type)||0===b.type.length)throw Error("Specify valid type");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var h=new c._Request({method:"GET",type:"object",op:"getMultiGetUrl",
args:[b.type,b.ids.join(","),b.fields],options:e,onSuccess:function(c){h.promise.fulfill(k(c.objects,b.entity,c.__meta))}});return h.send()};c.Object.get=function(b,e){b=b||{};f.isString(b)&&this.className&&(b={id:b});this.className&&(b.type=this.className,b.entity=this);if(!b.type)throw Error("Specify type");if(!b.id)throw Error("Specify id to fetch");var h=c.Object._create({__type:b.type,__id:b.id});h.fields=b.fields;return h.fetch(e)};c.Object.prototype.getConnections=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");
b.objectId=this.get("__id");return new c.Queries.GetConnectionsQuery(b)};c.Object.prototype.getConnectedObjects=function(b){if(this.isNew())throw Error("Cannot fetch connections for new object");b=b||{};f.isString(b)&&(b={relation:b});b.type=this.get("__type");b.objectId=this.get("__id");b.object=this;return new c.Queries.ConnectedObjectsQuery(b)};c.Object.prototype.fetchConnectedObjects=c.Object.prototype.getConnectedObjects;c.Object.findAll=c.Object.findAllQuery=function(b){b=b||{};this.className&&
(b.type=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Object.saveAll=function(b,e){return c.BaseObject._saveAll(b,e,"Object")}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend,b=function(b,d,e){var k={label:b.label};b.objectid&&(k.objectid=b.objectid);if(b.object)b.object instanceof c.Object?b.object.id&&(b.objectid=k.objectid=b.object.id):f.isObject(b.object)&&(b.object.__id&&(b.objectid=k.objectid=b.object.__id),b.object=c.Object._create(b.object)),k.object=b.object.getObject();else if(!k.objectid&&!k.object)throw Error("Incorrectly configured endpoints provided to parseConnection");k.toJSON=function(){var c=
g({},this);if(c.object&&(c.object=b.object.toJSON(),b.object._aclFactory)){var d=b.object._aclFactory.toJSON();d&&(c.object.__acls=d)}delete c.toJSON;return c};e["endpoint"+d]=b;return k},e=function(b,d,e,k){b.object&&f.isObject(b.object)?(k||(e["endpoint"+d]?e["endpoint"+d]&&e["endpoint"+d].object&&e["endpoint"+d].object instanceof c.Object?e["endpoint"+d].object.copy(b.object,!0):e["endpoint"+d].object=c.Object._create(b.object,!0):(e["endpoint"+d]={},e["endpoint"+d].object=c.Object._create(b.object,
!0)),e["endpoint"+d]._aclFactory&&e["endpoint"+d]._aclFactory.merge(),k=e["endpoint"+d].object,k.trigger("change:__id",k,k.id,{})),e["endpoint"+d].objectid=b.objectid||b.object.__id,e["endpoint"+d].label=b.label,e["endpoint"+d].type=b.type):e["endpoint"+d]=b;b.toJSON=function(){var b=g({},this);if(b.object&&(b.object=e["endpoint"+d].object.toJSON(),e["endpoint"+d].object._aclFactory)){var c=e["endpoint"+d].object._aclFactory.toJSON();c&&(b.object.__acls=c)}delete b.toJSON;return b}};c.Connection=
function(b,d){b=b||{};d=d||{};this.className&&(b.__relationtype=this.className);f.isString(b)&&(b={__relationtype:b});if(!b.__relationtype&&!b.relation)throw Error("Cannot set connection without relation");b.relation&&(b.__relationtype=b.relation,delete b.relation);f.isBoolean(d)&&(d={setSnapShot:!0});b.endpoints&&2===b.endpoints.length&&(b.__endpointa=b.endpoints[0],b.__endpointb=b.endpoints[1],delete b.endpoints);c.BaseObject.call(this,b,d);this.type="connection";this.getConnection=this.getObject;
this.parseConnection=function(c){var d="A",g="B";b.__endpointa.label.toLowerCase()!==this.get("__endpointb").label.toLowerCase()||b.__endpointa.label.toLowerCase()==b.__endpointb.label.toLowerCase()||b.__endpointa.objectid!=this.get("__endpointb").objectid&&b.__endpointa.objectid||(d="B",g="A");e(this.get("__endpointa"),d,this,c);e(this.get("__endpointb"),g,this,c);this.endpoints=function(){if(1===arguments.length&&f.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;
if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b};return this};d.setSnapShot?this.parseConnection(b):b.__endpointa&&b.__endpointb&&this.setupConnection(this.get("__endpointa"),this.get("__endpointb"));this.relationName=b.__relationtype;f.isFunction(this.initialize)&&this.initialize.apply(this,[b]);return this};c.Connection.prototype=new c.BaseObject;c.Connection.prototype.constructor=
c.Connection;c.Connection.extend=function(b,d,e){f.isObject(b)&&(e=d,d=b,b=d.relationName);if(!f.isString(b))throw Error("Appacitive.Connection.extend's first argument should be the relationName.");var g=null;d=d||{};d.className=b;g=c.utils.classExtend(c.Connection,d,e);delete g.extend;g.className=b;g.relation=b;return k[b]=g};var k={},d=function(b){if(!f.isString(b))throw"_getClass requires a string argument.";var d=k[b];d||(d=c.Connection.extend(b),k[b]=d);return d};c.Connection._getClass=d;c.Connection._create=
function(b,c,e){return(new (this.className?this:e?e:d(b.__relationtype))(b)).copy(b,c)};var q=function(b,d,e){var f=[];b||(b=[]);b.forEach(function(b){f.push(c.Connection._create(g(b,{__meta:e}),!0,d))});return f};c.Connection._parseResult=q;c.Connection.prototype.setupConnection=function(c,d){if(!(c&&(c.objectid||c.object)&&c.label&&d&&(d.objectid||d.object)&&d.label))throw Error("Incorrect endpoints configuration passed.");this.set("__endpointa",b(c,"A",this),{silent:!0});this.set("__endpointb",
b(d,"B",this),{silent:!0});this.endpoints=function(){if(1===arguments.length&&f.isString(arguments[0])){if(this.endpointA.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointA;if(this.endpointB.label.toLowerCase()===arguments[0].toLowerCase())return this.endpointB;throw Error("Invalid label provided");}var b=[];b.push(this.endpointA);b.push(this.endpointB);return b}};c.Connection.prototype.get=c.Connection.get=function(b,d){b=b||{};f.isString(b)&&this.className&&(b={id:b});this.className&&
(b.relation=this.className,b.entity=this);if(!b.relation)throw Error("Specify relation");if(!b.id)throw Error("Specify id to fetch");var e=c.Connection._create({__relationtype:b.relation,__id:b.id});e.fields=b.fields;return e.fetch(d)};c.Connection.multiGet=function(b,d){b=b||{};d=d||{};f.isArray(b)&&0<b.length&&(b=b[0]instanceof c.Connection?{ids:b.map(function(b){return b.id}).filter(function(b){return b})}:{ids:b});this.className&&(b.relation=this.className,b.entity=this);if(!b.relation||!f.isString(b.relation)||
0===b.relation.length)throw Error("Specify valid relation");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var e=new c._Request({method:"GET",type:"connection",op:"getMultiGetUrl",args:[b.relation,b.ids.join(","),b.fields],options:d,onSuccess:function(c){e.promise.fulfill(q(c.connections,b.entity,c.__meta))}});return e.send()};c.Connection.multiDelete=function(b,d){b=b||{};d=d||{};var e=[];this.className&&(b.relation=this.className);f.isArray(b)&&0<b.length&&(b[0]instanceof c.Connection?
(e=b,b={relation:e[0].className,ids:e.map(function(b){return b.id}).filter(function(b){return b})}):b={relation:this.className,ids:b});if(!b.relation||!f.isString(b.relation)||0===b.relation.length)throw Error("Specify valid relation");if(!b.ids||0===b.ids.length)throw Error("Specify ids to delete");var g=new c._Request({method:"POST",data:{idlist:b.ids},type:"connection",op:"getMultiDeleteUrl",args:[b.relation],options:d,onSuccess:function(b){d&&!d.silent&&e.forEach(function(b){b.trigger("destroy",
b,b.collection,d)});g.promise.fulfill()}});return g.send()};c.Connection.findAll=c.Connection.findAllQuery=function(b){b=b||{};this.className&&(b.relation=this.className,b.entity=this);return new c.Queries.FindAllQuery(b)};c.Connection.interconnectsQuery=c.Connection.getInterconnects=function(b){return new c.Queries.InterconnectsQuery(b)};c.Connection.betweenObjectsQuery=c.Connection.getBetweenObjects=function(b){return new c.Queries.GetConnectionsBetweenObjectsQuery(b)};c.Connection.betweenObjectsForRelationQuery=
c.Connection.getBetweenObjectsForRelation=function(b){b=b||{};this.className&&(b.relation=this.className,b.entity=this);return new c.Queries.GetConnectionsBetweenObjectsForRelationQuery(b)};c.Connection.saveAll=function(b,d){return c.BaseObject._saveAll(b,d,"Connection")}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend,b=function(b,d){b=b||{};b.__type="user";c.Object.call(this,b,d);return this},e=null;b.currentUser=b.current=function(){return e};var k=function(b,d,e){var g=this.get("__id");if(!g||!f.isString(g)||0===g.length)throw Error("Please specify valid userid");if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid oldPassword");if(!d||!f.isString(d)||0===d.length)throw Error("Please specify valid newPassword");var k=this,t=new c._Request({method:"POST",
type:"user",op:"getUpdatePasswordUrl",args:[g],options:e,data:{oldpassword:b,newpassword:d},entity:this,onSuccess:function(b){t.promise.fulfill(k)}});return t.send()},d=function(b,d){var e=this.get("__id");if(!this.get("__id"))return this.set("__link",b),c.Promise.buildPromise(d).fulfill(this);var g=this,k=new c._Request({method:"POST",type:"user",op:"getLinkAccountUrl",args:[e],options:d,data:b,entity:this,onSuccess:function(c){c=g.get("__link");f.isArray(c)||(c=c?[c]:[]);c.push(b);g.copy({__link:c},
!0);k.promise.fulfill(g)}});return k.send()};b.setCurrentUser=function(b,d,f){if(!b)throw Error("Cannot set null object as user");var g=b;if(g instanceof c.User)if(g.get("__id")&&0!==g.get("__id").length)b=g.getObject();else throw Error("Specify user __id");else g=new c.User(b,!0);c.localStorage.set("Appacitive-User",b);f||(f=864E5);e=g;d&&c.Session.setUserAuthHeader(d,f);e.logout=function(b){return c.Users.logout(b)};e.updatePassword=function(b,c,d){return k.apply(this,[b,c,d])};e.logout=function(b){return c.Users.logout(b)};
c.eventManager.clearAndSubscribe("type.user."+g.get("__id")+".updated",function(b,d){c.localStorage.set("Appacitive-User",d.object.getObject())});return e};b.prototype.linkedAccounts=function(){var b=this.get("__link");b?f.isArray(b)||(b=[b]):b=[];return b};b.prototype.getAllLinkedAccounts=function(b){var d=this.get("__id");if(!d||!f.isString(d)||0===d.length)return c.Promise.buildPromise(b).fulfill(this.linkedAccounts(),this);var e=this,g=new c._Request({method:"GET",type:"user",op:"getGetAllLinkedAccountsUrl",
args:[d],options:b,entity:this,onSuccess:function(){var b=a.identities||[];0<b.length?e.set("__link",b):e.set("__link",null);g.promise.fulfill(b,e)}});return g.send()};b.prototype.checkin=function(b,d){var e=this.get("__id");e&&f.isString(e)&&0!==e.length||onSuccess&&f.isFunction(onSuccess)&&onSuccess();if(!(b&&b instanceof c.GeoCoord))throw Error("Invalid coordinates provided");var g=this,k=new c._Request({method:"POST",type:"user",op:"getCheckinUrl",args:[e,b.lat,b.lngerId],options:d,entity:this,
onSuccess:function(){k.promise.fulfill(g)}});return k.send()};b.prototype.linkFacebook=function(b,c){if(!b||!f.isString(b))throw Error("Please provide accessToken");return d.apply(this,[{authtype:"facebook",accesstoken:b,name:"facebook"},c])};b.prototype.linkTwitter=function(b,c){if(!f.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var e={authtype:"twitter",oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret};b.consumerKey&&
b.consumerSecret&&(e.consumersecret=b.consumerSecret,e.consumerkey=b.consumerKey);return d.apply(this,[e,c])};b.prototype.unlink=function(b,d){if(!_.isString(b))throw Error("Specify aouth account type for unlinking");var e=this.get("__id");if(!this.get("__id"))return this.set("__link",null),promise.fulfill(this),promise;var g=this,k=new c._Request({method:"POST",type:"user",op:"getDelinkAccountUrl",args:[e,b],options:d,entity:this,onSuccess:function(c){(c=g.get("__link"))?f.isArray(c)||(c=[c]):c=
[];if(0<=c.length){var d=null;c.forEach(function(c,e){c.name==b.toLowerCase()&&(d=e)});null!=d&&c.splice(d,1);g.copy({__link:c},!0)}else g.copy({__link:[]},!0);k.promise.fulfill(g)}});return k.send()};b.prototype.clone=function(){return new c.User(this.getObject())};c.User=c.Object.extend("user",b.prototype);delete c.User._create;delete c.User._parseResult;delete c.User.multiDelete;b.deleteUser=function(b,d){if(!b)throw Error("Specify userid for user delete");return(new c.Object({__type:"user",__id:b})).destroyWithConnections(d)};
b.deleteCurrentUser=function(b){var d=c.Promise.buildPromise(b);if(null===e)return c.Session.removeUserAuthHeader(),d.fulfill(),d;b=e.get("__id");this.deleteUser(b).then(function(){e=null;c.Session.removeUserAuthHeader();d.fulfill()},function(){d.reject.apply(d,arguments)});return d};b.createNewUser=function(b,d){b=b||{};b.__type="user";if(!b.username||!b.password||!b.firstname||0===b.username.length||0===b.password.length||0===b.firstname.length)throw Error("username, password and firstname are mandatory");
return(new c.User(b)).save(d)};b.createUser=b.createNewUser;b.signup=function(b,d){var e=this,f=c.Promise.buildPromise(d);this.createUser(b).then(function(){e.login(b.username,b.password).then(function(){f.fulfill.apply(f,arguments)},function(b){f.reject.apply(f,arguments)})},function(){f.reject.apply(f,arguments)});return f};b.authenticateUser=function(b,d,k){d=d||{};b.expiry||(b.expiry=864E5);var q=this,u;f.isString(k)&&f.isObject(d.user)&&(b.user=d.user instanceof l.Appacitive.User?d.user.toJSON():
d.user,delete b.user.__meta,u=d.user);var t=new c._Request({method:"POST",type:"user",op:"getAuthenticateUserUrl",options:d,data:b,onSuccess:function(d){d&&d.user?(k&&(d.user.__authType=k),g(d.user,{__meta:d.__meta}),u instanceof l.Appacitive.User&&(d.user=u.copy(d.user,!0)),q.setCurrentUser(d.user,d.token,b.expiry),c.User.trigger("login",e,e,d.token),t.promise.fulfill({user:e,token:d.token})):t.promise.reject(d.status)}});return t.send()};b.login=function(b,c,d){if(!b||!c||0==b.length||0==c.length)throw Error("Please specify username and password");
return this.authenticateUser({username:b,password:c,expiry:864E5},d,"BASIC")};b.loginWithFacebook=function(b,c){if(!b||!f.isString(b))throw Error("Please provide accessToken");c=c||{};var d=!0;0==c.create&&(d=!1);return this.authenticateUser({accesstoken:b,type:"facebook",expiry:864E5,createnew:d},c,"FB")};b.loginWithTwitter=function(b,c){if(!f.isObject(b)||!b.oAuthToken||!b.oAuthTokenSecret)throw Error("Twitter Token and Token Secret required for linking");var d=!0;0==c.create&&(d=!1);d={type:"twitter",
oauthtoken:b.oAuthToken,oauthtokensecret:b.oAuthTokenSecret,expiry:864E5,createnew:d};b.consumerKey&&b.consumerSecret&&(d.consumersecret=b.consumerSecret,d.consumerkey=b.consumerKey);return this.authenticateUser(d,c,"TWITTER")};b.validateCurrentUser=function(b,d){var e=c.Promise.buildPromise({success:d});d&&f.isBoolean(d)&&(b=d,d=function(){});var g=c.localStorage.get("Appacitive-UserToken");if(!g)return e.fulfill(!1),e;if(b)e.fulfill(!0);else try{var k=this;this.getUserByToken(g).then(function(b){k.setCurrentUser(b,
g);e.fulfill(!0)},function(){e.fulfill(!1)})}catch(t){e.fulfill(!1)}return e};var q=function(b,d,e){e=e||{};var f=new c._Request({method:"GET",type:"user",op:b,options:e,args:d,onSuccess:function(b){b&&b.user?f.promise.fulfill(new c.User(g(b.user,{__meta:b.__meta}),g(e,{setSnapShot:!0}))):f.promise.reject(b.status)}});return f.send()};b.getUserByToken=function(b,d){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid token");c.Session.setUserAuthHeader(b,0,!0);return q("getUserByTokenUrl",
[b],d)};b.getUserByUsername=function(b,c){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid username");return q("getUserByUsernameUrl",[b],c)};b.logout=function(b,d){e=null;return c.Session.removeUserAuthHeader(b,d)};b.sendResetPasswordEmail=function(b,d,e){if(!b||!f.isString(b)||0===b.length)throw Error("Please specify valid username");if(!d||!f.isString(d)||0===d.length)throw Error("Plase specify subject for email");b={username:b,subject:d};e=e||{};f.isString(e.templateName)&&
(b.templatename=e.templateName);f.isString(e.resetLink)&&(b.resetlink=e.resetLink);var g=new c._Request({method:"POST",type:"user",op:"getSendResetPasswordEmailUrl",options:e,data:b,onSuccess:function(){g.promise.fulfill()}});return g.send()};b.resetPassword=function(b,d,e){if(!b)throw Error("Please specify token");if(!d||0===d.length)throw Error("Please specify password");var f=new c._Request({method:"POST",type:"user",op:"getResetPasswordUrl",options:e,data:{newpassword:d},args:[b],onSuccess:function(){f.promise.fulfill()}});
return f.send()};b.validateResetPasswordToken=function(b,d){if(!b)throw Error("Please specify token");d=d||{};var e=new c._Request({method:"POST",type:"user",op:"getValidateResetPasswordUrl",options:d,data:{},args:[b],onSuccess:function(b){e.promise.fulfill(new c.User(g(b.user,{__meta:b.__meta}),g(d,{setSnapShot:!0})))}});return e.send()};c.Users=c.User;c.Events.mixin(c.User)})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend;c.Collection=function(b,c){c||(c={});c.model&&(this.model=c.model);if(!this.model)throw Error("Please specify model for collection");void 0!==c.comparator&&(this.comparator=c.comparator);c.query&&this.query(c.query);this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0})};c.Events.mixin(c.Collection.prototype);g(c.Collection.prototype,{models:[],initialize:function(){},_query:null,toJSON:function(b){return this.models.map(function(c){return c.toJSON(b)})},
getObject:function(b){return this.models.map(function(c){return c.getObject(b)})},add:function(b,c){c=c||{};var g,d,l,h,m,v={},r={},u=[],t=c.sort,B;b=f.isArray(b)?b.slice():[b];g=0;for(d=b.length;g<d;g++){b[g]=this._prepareModel(b[g]);l=b[g];if(!l)throw Error("Can't add an invalid model to a collection");h=l.cid;if(v[h]||this._byCid[h])throw Error("Duplicate cid: can't add the same model to a collection twice");(m=l.id)&&((B=r[m])||(B=this._byId[m]))?(B.copy(l.getObject(),c.setSnapShot),B.children=
l.children):(r[m]=l,v[h]=l,u.push(l),this._addReference(l,c))}this.models.splice.apply(this.models,[null!=c.at?c.at:this.models.length,0].concat(u));t&&this.comparator&&this.sort({silent:!0});this.length=this.models.length;if(c.silent)return this;g=0;for(d=u.length;g<d;g++)l=u[g],c.index=g,l.trigger("add",l,this,c);return this},remove:function(b,c){var g,d,l,h;c=c||{};b=f.isArray(b)?b.slice():[b];g=0;for(d=b.length;g<d;g++)if(h=this.getByCid(b[g])||this.get(b[g]))delete this._byId[h.id],delete this._byCid[h.cid],
l=this.models.indexOf(h),this.models.splice(l,1),this.length--,c.silent||(c.index=l,h.trigger("remove",h,this,c)),this._removeReference(h);return this},push:function(b,c){return this.add(b,g({at:this.length},c))},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,c){return this.add(b,g({at:0},c))},shift:function(b){var c=this.at(0);this.remove(c,b);return c},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(b){return b&&
this._byId[b instanceof c.BaseObject?b.id:b]},query:function(b){if(b)return this._query=b,this;this._query||(this._query=new c.Query(this.model));return this._query},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b,c){return Object.isEmpty(b)?c?void 0:[]:this.models[c?"find":"filter"](function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},findWhere:function(b){return this.where(b,!0)},sort:function(b){b=b||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");
1===this.comparator.length?this.models=this.models.sortBy(this.comparator):this.models.sort(this.comparator.bind(this.models));b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return this.models.map(function(c){return c.get(b)})},first:function(){return 0<this.length?this.models[0]:null},last:function(){return 0<this.length?this.models[this.length-1]:null},reset:function(b,c){c||(c={});for(var f=0,d=this.models.length;f<d;f++)this._removeReference(this.models[f],c);this._reset();
this.add(b,g({silent:!0},c));c.silent||this.trigger("reset",this,c);return this},fetch:function(b){b=c.utils._clone(b)||{};var e=this,f=this.query()||new c.Query(this.model),d=c.Promise.buildPromise(b);f.fetch(b).then(function(c){0==b.reset?e.add(c,g({setSnapShot:!0},b)):e.reset(c,b);d.fulfill(e)},function(){d.reject.apply(d,arguments)});return d},fetchNext:function(b){var c=this.query().pageNumber();this.query().pageNumber(++c);return this.fetch(b)},fetchPrev:function(b){var c=this.query().pageNumber();
--c;0>=c&&(c=1);this.query().pageNumber(c);return this.fetch(b)},mutiGet:function(b){b=c.utils._clone(b)||{};var e=this,g=c.Promise.buildPromise(b);b=b||{};f.isArray(b)&&(b[0]instanceof c.Object?(models=b,b={ids:models.map(function(b){return b.id}).filter(function(b){return b})}):b={ids:b});var d=b.ids||[];if(0==d.length)return g.fulfill(e);this.model.multiGet({ids:d,fields:b.fields}).then(function(c){b.add?e.add(c,b):e.reset(c,b);g.fulfill(e)},function(){g.reject.apply(g,arguments)});return g},saveAll:function(b){return this.model.saveAll(this.models,
g({},b))},save:function(b){return this.model.saveAll(this.models,g({},b))},create:function(b,e){var f=this;e=e?c.utils._clone(e):{};if(!(b=this._prepareModel(b,e)))return!1;e.wait||this.add(b,e);var d=e.success;e.success=function(){e.wait&&f.add(b,g({setSnapShot:!0},e));d&&d(b,f)};b.save(e);return b},_reset:function(b){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(b){b instanceof c.BaseObject||(b=new this.model(b));b.collection||(b.collection=this);return b},_addReference:function(b){this._byId[b.cid]=
b;null!=b.id&&(this._byId[b.id]=b);b.collection||(b.collection=this);b.on("all",this._onModelEvent,this)},_removeReference:function(b){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,f,d){if("add"!==b&&"remove"!==b||f===this)"destroy"===b&&this.remove(c,d),c&&"change:__id"===b&&(delete this._byId[c.previous(c.idAttribute)],null!=c.id&&(this._byId[c.id]=c)),this.trigger.apply(this,arguments)}});c.Collection.extend=function(b,e){b&&b.query&&
(b._query=b.query,delete b.query);var f=c.utils.classExtend(this,b,e);f.extend=this.extend;return f};"forEach each map find filter every some indexOf lastIndexOf isEmpty difference without reduce".split(" ").each(function(b){c.Collection.prototype[b]=function(){var c=Array.prototype.slice.call(arguments);return Array.prototype[b].apply(this.models,c)}})})(global);
(function(l){var c=l.Appacitive,f=c.utils._type,g=c.utils._extend;c.Batch=function(){this.objects=[];this.connections=[];this.objectDeletions=[];this.edgeDeletions=[]};var b=function(b){-1==this.connections.indexOf(b)&&this.connections.push(b)},e=function(b){-1==this.objects.indexOf(b)&&this.objects.push(b)},k=function(b,d,e){var g;if(f.isString(b)){if(g=b,!f.isString(d)&&0<d.trim().length)throw Error("Specify typename as second argument to Batch.removeObjects");}else if(f.isObject(b)&&b instanceof
c.Object){if(b.isNew())return;g=b.id;e=d;d=b.typeName}else throw Error("Batch.removeObjects accepts only Appacitive.Object or ids with typeName");this.objectDeletions.find(function(b){return g==b.id})||this.objectDeletions.push({type:d,id:g,deleteconnections:e})},d=function(b,d){var e;if(f.isString(b)){if(e=b,!f.isString(d)&&0<d.trim().length)throw Error("Specify relationName as second argument to Batch.removeConnections");}else if(f.isObject(b)&&b instanceof c.Connection){if(b.isNew())return;e=b.id;
d=b.relationName}else throw Error("Batch.removeConnection accepts only Appacitive.Connection or ids with relationName");this.edgeDeletions.find(function(b){return e==b.id})||this.edgeDeletions.push({type:d,id:e})},q=function(d){if(f.isObject(d)){if(d instanceof c.Object)return e.apply(this,[d]);if(d instanceof c.Connection)return b.apply(this,[d])}throw Error("Batch accepts only Appacitive.Object and Appacitive.Connection instances");},h=function(){var b=[];this.objects.forEach(function(c,d){var e=
c._findUnsavedChanges();if(e.object){e.object.__type=c.className;var f=b.find(function(b){return c.id&&c.id==b.object.__id||c.cid==b.name});f&&(f.object=e.object,e=f);delete e.isNested;c.isNew()?e.name=""+c.cid:e.object.__id=c.id;f||b.push(e)}});return b},m=function(){var b=this,c=[];this.connections.forEach(function(d){var e=d._findUnsavedChanges().object;e&&(e.__relationtype=d.className,e.__endpointa&&delete e.__endpointa.object,e.__endpointb&&delete e.__endpointb.object);var g=d.endpointA.object;
f.isObject(g)&&(d.isNew()&&(g.isNew()?e.__endpointa.name=""+d.endpointA.object.cid:e.__endpointa.objectid=d.endpointA.object.id),q.apply(b,[g]));g=d.endpointB.object;f.isObject(g)&&(d.isNew()&&(g.isNew()?e.__endpointb.name=""+d.endpointB.object.cid:e.__endpointb.objectid=d.endpointB.object.id),q.apply(b,[g]));if(e){var g=c.find(function(b){return d.id&&d.id==b.connection.__id||d.cid==b.name}),h={connection:e};g&&(g.connection=e,h=g);d.isNew()?h.name=""+d.cid:h.connection.__id=d.id;g||c.push(h)}});
return c};c.Batch.prototype.add=function(){var b=this;f.isArray(arguments[0])?arguments[0].forEach(function(c){q.apply(b,[c])}):q.apply(this,arguments);return this};c.Batch.prototype.removeObjects=function(){var b=this,c=arguments;f.isArray(c[0])?arguments[0].forEach(function(d){k.apply(b,[d,c[1],c[2]])}):k.apply(this,c);return this};c.Batch.prototype.removeConnections=function(){var b=this,c=arguments;f.isArray(c[0])?arguments[0].forEach(function(e){d.apply(b,[e,c[1],c[2]])}):d.apply(this,c);return this};
c.Batch.prototype.toJSON=function(){var b={nodes:[],edges:[],edgedeletions:[],nodedeletions:[]};b.edges=m.apply(this,[]);b.nodes=h.apply(this,[]);b.nodedeletions=this.objectDeletions;b.edgedeletions=this.edgeDeletions;return b};var v=function(b,c,d){var e=this;b.forEach(function(b){var f=b.object;e.objects.forEach(function(e){if(e.cid==b.name||e.id==f.__id||e.get("__id")==f.__id){var g={__meta:c[e.className]};g[e.getType()]=f;e._parseOutput(d,g)}})})},r=function(b,c,d){var e=this;b.forEach(function(b){var f=
b.connection;e.connections.forEach(function(e){if(e.cid==b.name||e.id==f.__id||e.get("__id")==f.__id){var g={__meta:c[e.className]};g[e.getType()]=f;e._parseOutput(d,g)}})})},u=function(b,d){var e;b&&b.edges&&b.nodes&&0<=b.edges.length&&0<=b.nodes.length?(v.call(this,b.nodes,b.__meta.__type,d),r.call(this,b.edges,b.__meta.__rel,d),d.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},d)):(b=b||{},b.status=b.status||{},e=(e=b.status)||{},e.message=e.message||"Server error",
e.code=e.code||"500",this._triggerError(d,new c.Error(e)));return e};c.Batch.prototype._triggerError=function(b,c){b.silent||this.trigger("error",this,c,b)};c.Batch.prototype.execute=function(b){var d=this.toJSON();b=g({_batch:!0},b);if(0==d.nodes.length&&0==d.edges.length&&0==d.edgedeletions.length&&0==d.nodedeletions.length)return b.silent||this.trigger("sync",this,{objects:this.objects,connections:this.connections},b),(new c.Promise).fulfill(this);var e=this,f=new c._Request({method:"PUT",type:"multi",
op:"getBatchUrl",data:d,options:b,entity:this,onSuccess:function(c){(c=u.apply(e,[c,b]))?f.promise.reject(c,e):f.promise.fulfill(e)}});return f.send()};c.Events.mixin(c.Batch.prototype)})(global);
(function(l){var c=l.Appacitive;l=function(){var f=null,g=this.FB=null,b=!1;this.initialize=function(c){if(!Facebook)throw Error("node-facebook SDK needs be loaded before calling initialize.");if(!c.appId)throw Error("Please provide appid");if(!c.appSecret)throw Error("Please provide app secret");g=c.appSecret;this.FB=new (require("facebook-node-sdk"))({appId:_appId,secret:g});b=!0};this.requestLogin=function(b){b&&(f=b);return(new c.Promise).fulfill()};this.getCurrentUserInfo=function(e){if(!b)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");
e=e||{};var g=c.Promise.buildPromise(e);this.FB&&f?this.FB.api("/me",function(b,c){c?g.fulfill(c):g.reject("Access token is invalid")}):g.reject("Either intialize facebook with your appid and appsecret or set accesstoken");return g};this.accessToken=function(){return 1===arguments.length?(f=arguments[0],this):f};this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=function(){c.Facebook.accessToken="";return(new c.Promise).fulfill()}};c.Facebook=c.runtime.isBrowser?
new function(){var f=null,g=!0;this.initialize=function(b){if(!FB)throw"Facebook SDK needs be loaded before calling initialize.";if(!b.appId)throw Error("Please provide appid");FB.init(b);g=!0};this.requestLogin=function(b){b=b||{};if(!g)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");var e=c.Promise.buildPromise(b);b.scope||(b.scope="email");FB.login(function(b){b&&"connected"===b.status&&b.authResponse?(f=b.authResponse.accessToken,e.fulfill(b.authResponse)):
e.reject()},b);return e};this.getCurrentUserInfo=function(b){if(!g)throw Error("Either facebook sdk has not yet been initialized, or not yet loaded.");b=b||{};var e=c.Promise.buildPromise(b);FB.api("/me",function(b){b&&!b.error?(f=FB.getAuthResponse().accessToken,e.fulfill(b)):e.reject()});return e};this.accessToken=function(){return 1===arguments.length?(f=arguments[0],this):f};this.getProfilePictureUrl=function(b){return"https://graph.facebook.com/"+b+"/picture"};this.logout=function(b){f=null;
b=b||{};var e=c.Promise.buildPromise(b);try{FB.logout(function(){c.Users.logout();e.fulfill()})}catch(g){e.reject(g.message)}return e}}:new l})(global);
(function(l){var c=l.Appacitive;c.Email=new function(){var f={smtp:{username:null,password:null,host:"smtp.gmail.com",port:465,enablessl:!0},from:null,replyto:null};this.getConfig=function(){return f};var g=function(b,e){var f=new c._Request({method:"POST",type:"email",op:"getSendEmailUrl",options:e,data:b,entity:b,onSuccess:function(b){f.promise.fulfill(b.email)}});return f.send()};this.setupEmail=function(b){b=b||{};f.smtp.username=b.username||f.smtp.username;f.from=b.from||f.from;f.smtp.password=
b.password||f.smtp.password;f.smtp.host=b.smtp.host||f.smtp.host;f.smtp.port=b.smtp.port||f.smtp.port;f.smtp.enablessl=b.enableSSL||f.smtp.enablessl;f.replyto=b.replyTo||f.replyto};this.sendTemplatedEmail=function(b,c){if(!b||!b.to||!b.to.length||0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");
if(!b.templateName)throw Error("template name is mandatory to send an email");var k={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{templatename:b.templateName||"",data:b.data||{},ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){k.smtp=f.smtp;if(!b.from&&!f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");k.from=b.from||f.from;k.replyto=b.replyTo||f.replyto}return g(k,c)};this.sendRawEmail=function(b,c){if(!b||!b.to||!b.to.length||
0===b.to.length)throw Error("Atleast one receipient is mandatory to send an email");if(!b.subject||0===b.subject.trim().length)throw Error("Subject is mandatory to send an email");if(!b.from&&f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options on the portal");if(!b.body)throw Error("body is mandatory to send an email");var k={to:b.to||[],cc:b.cc||[],bcc:b.bcc||[],subject:b.subject,from:b.from,body:{content:b.body||"",ishtml:!1===b.isHtml?!1:!0}};if(b.useConfig){k.smtp=
f.smtp;if(!b.from&&!f.from)throw Error("from is mandatory to send an email. Set it in config or send it in options");k.from=b.from||f.from;k.replyto=b.replyTo||f.replyto}return g(k,c)}}})(global);
(function(l){var c=l.Appacitive;c.Push=new function(){this.send=function(f,g){if(!f)throw Error("Please specify push options");var b=new c._Request({method:"POST",type:"push",op:"getPushUrl",options:g,data:f,entity:f,onSuccess:function(c){b.promise.fulfill(c.id)}});return b.send()};this.getNotification=function(f,g){if(!f)throw Error("Please specify notification id");var b=new c._Request({method:"GET",type:"push",op:"getGetNotificationUrl",args:[f],options:g,onSuccess:function(c){b.promise.fulfill(c.pushnotification)}});
return b.send()};this.getAllNotifications=function(f,g){f?(f.pnum=f.pnum||1,f.psize=f.psize||20):f={pnum:1,psize:20};var b=new c._Request({method:"GET",type:"push",op:"getGetAllNotificationsUrl",args:[f],options:g,onSuccess:function(c){b.promise.fulfill(c.pushnotifications,c.paginginfo)}});return b.send()}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;c.File=function(g){g=g||{};this.fileId=g.fileId;this.contentType=g.contentType;this.fileData=g.fileData;var b=this,e=function(d,e,f,g,k){var l=new c.HttpRequest;l.url=d;l.method="GET";l.description=g;l.onSuccess=e;l.promise=f;l.entity=b;l.options=k;c.http.send(l)},k=function(d,e,f,g,k){var l=new c.HttpRequest;l.url=d;l.method="PUT";l.log=!1;l.description="Upload file";l.data=e;l.headers.push({key:"Content-Type",value:f});l.send().then(g,function(c){k.reject(c,
b)})};this.save=function(b,c){"number"!==typeof b&&(c=b,b=-1);return this.fileId&&f.isString(this.fileId)&&0<this.fileId.length?l(b,c):d(b,c)};var d=function(d,g){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(l){}b.contentType&&f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var q=c.Promise.buildPromise(g),u=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(b.contentType,b.fileId?b.fileId:
"");e(u,function(c){k(c.url,b.fileData,b.contentType,function(){b.fileId=c.id;b.getDownloadUrl(d,g).then(function(c){return q.fulfill(c,b)},function(b){return q.reject(b)})},q)},q," Get upload url for file ",g);return q},l=function(d,g){if(!b.fileData)throw Error("Please specify filedata");if(!b.contentType)try{b.contentType=b.fileData.type}catch(l){}b.contentType&&f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var q=c.Promise.buildPromise(g),u=c.config.apiBaseUrl+
c.storage.urlFactory.file.getUpdateUrl(b.fileId,b.contentType);e(u,function(c){k(c.url,b.fileData,b.contentType,function(){b.getDownloadUrl(d,g).then(function(c){q.fulfill(c,b)},function(b){q.reject(b)})},q)},q," Get update url for file "+b.fileId,g);return q};this.destroy=function(d){if(!this.fileId)throw Error("Please specify fileId to delete");var e=c.Promise.buildPromise(d),f=new c.HttpRequest;f.url=c.config.apiBaseUrl+c.storage.urlFactory.file.getDeleteUrl(this.fileId);f.method="DELETE";f.description=
"Delete file with id "+this.fileId;f.onSuccess=function(b){e.fulfill()};f.promise=e;f.entity=b;f.options=d;return c.http.send(f)};this.getDownloadUrl=function(d,f){if(!this.fileId)throw Error("Please specify fileId to download");"number"!==typeof d&&(f=d,d=-1);var g=c.Promise.buildPromise(f),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getDownloadUrl(this.fileId,d);e(k,function(c){b.url=c.uri;g.fulfill(c.uri)},g," Get download url for file "+this.fileId,f);return g};this.getUploadUrl=function(d){b.contentType&&
f.isString(b.contentType)&&0!==b.contentType.length||(b.contentType="text/plain");var g=c.Promise.buildPromise(d),k=c.config.apiBaseUrl+c.storage.urlFactory.file.getUploadUrl(this.contentType,this.fileId?this.fileId:"");e(k,function(c){b.url=c.url;g.fulfill(c.url,b)},g," Get upload url for file "+this.fileId,d);return g}}})(global);
(function(l){var c=l.Appacitive;c.Date={};var f=function(c){return 10>c?"0"+c:c};c.Date.parse=function(c){var b,e=0,f=[1,4,5,6,7,10,11];if(b=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}|\d{7}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(c)){c=0;for(var d;d=f[c];++c)b[d]=+b[d]||0;b[2]=(+b[2]||1)-1;b[3]=+b[3]||1;"Z"!==b[8]&&void 0!==b[9]?(e=60*b[10]+b[11],"+"===b[9]&&(e=0-e)):"Z"==b[8]&&(b[7]=b[7].toString().substring(0,3));b=Date.UTC(b[1],b[2],b[3],b[4],
b[5]+e,b[6],b[7])}else b=Date.parse?Date.parse(c):NaN;return b};c.Date.parseISODate=function(f){try{return new Date(c.Date.parse(f))}catch(b){return null}};c.Date.toISOString=function(c){try{return c=c.toISOString(),c=c.replace("Z","0000Z")}catch(b){return null}};c.Date.toISODate=function(c){if(c instanceof Date)return String.format("{0}-{1}-{2}",c.getFullYear(),f(c.getMonth()+1),f(c.getDate()));throw Error("Invalid date provided Appacitive.Date.toISODate method");};c.Date.toISOTime=function(c){var b=
function(b){return 10>b?b+"000000":100>b?b+"00000":1E3>b?b+"0000":1E4>b?b+"000":1E5>b?b+"00":1E6>b?b+"0":b};if(c instanceof Date)return String.format("{0}:{1}:{2}.{3}",f(c.getHours()),f(c.getMinutes()),f(c.getSeconds()),b(c.getMilliseconds()));throw Error("Invalid date provided Appacitive.Date.toISOTime method");};c.Date.parseISOTime=function(c){try{var b=new Date,e=c.split("T");1===e.length&&e.push(e[0]);if(!/^([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z?$/.exec(e[1]))return null;var f=e[1].split("Z")[0].split(":"),
d=f[2].split("."),l=Number(f[0]);1<e.length?(b.setUTCHours(Number(l)),b.setUTCMinutes(Number(f[1])),b.setUTCSeconds(Number(d[0])),d[1]&&b.setUTCMilliseconds(Number(d[1].substring(0,3)))):(b.setHours(Number(l)),b.setMinutes(Number(f[1])),b.setSeconds(Number(d[0])),d[1]&&b.setMilliseconds(Number(d[1].substring(0,3))));return b}catch(h){return null}}})(global);
(function(l){var c=l.Appacitive,f=c.utils._type;c.localStorage=new (c.runtime.isBrowser?function(){var g=c.runtime.isBrowser?window.localStorage:{getItem:function(){return null}},b=function(){try{return g.setItem("test","1"),g.removeItem("test"),!0}catch(b){return!1}};this.set=function(e,k){k=k||"";if(!e)return!1;if(f.isObject(k)||f.isArray(k))try{k=JSON.stringify(k)}catch(d){}b()?(e=c.getAppPrefix(e),g[e]=k):c.Cookie.setCookie(e,k);return this};this.get=function(e){if(!e)return null;b()?(e=c.getAppPrefix(e),
e=g.getItem(e)):e=c.Cookie.readCookie(e);if(!e)return null;if("{"===e[0])try{e=JSON.parse(e)}catch(f){}return e};this.remove=function(e){if(e)if(b()){e=c.getAppPrefix(e);try{delete g[e]}catch(f){}}else c.Cookie.eraseCookie(e)}}:function(){var g=[];this.set=function(b,e){e=e||"";if(!b||f.isString(b))return!1;b=c.getAppPrefix(b);g[b]=e;return this};this.get=function(b){if(!b||f.isString(b))return null;b=c.getAppPrefix(b);return(b=g[b])?b:null};this.remove=function(b){if(b&&!f.isString(b)){b=c.getAppPrefix(b);
try{delete g[b]}catch(e){}}}})})(global);
(function(l){var c=l.Appacitive;c.Cookie=new (c.runtime.isBrowser?function(){this.setCookie=function(f,g,b,e){f=c.getAppPrefix(f);var k="";b&&(k=new Date,k.setTime(k.getTime()+6E4*b),k.toGMTString());k=e?"; expires=Thu, 01-Jan-1970 00:00:01 GMT":c.Session.persistUserToken?"; expires="+(new Date("2020-12-31")).toGMTString():"";b="domain="+window.location.hostname;"localhost"==window.location.hostname&&(b="");document.cookie=f+"="+g+k+"; path=/;"+b};this.readCookie=function(f){f=c.getAppPrefix(f);f+=
"=";for(var g=document.cookie.split(";"),b=0;b<g.length;b++){for(var e=g[b];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(f))return e.substring(f.length,e.length)}return null};this.eraseCookie=function(c){this.setCookie(c,"",-1,!0)}}:function(){this.setCookie=function(f,g){c.localStorage.set("cookie/"+f,g)};this.readCookie=function(f){return c.localStorage.get("cookie/"+f)};this.eraseCookie=function(f){c.localStorage.remove("cookie/"+f)}})})(global);
"undefined"===typeof module||global.Appacitive.runtime.isBrowser||(module.exports=global.Appacitive);
